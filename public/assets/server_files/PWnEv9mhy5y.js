if (self.CavalryLogger) { CavalryLogger.start_js(["1VbvH"]); }

__d("XRefererFrameController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/common\/referer_frame.php",{v:{type:"Int"}});},null);
__d('ControlledReferer',['URI','UserAgent','XRefererFrameController','isMessengerDotComURI','lowerFacebookDomain'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={useFacebookReferer:function(i,j,k){var l=false;function m(){if(l)return;var o=i.contentWindow.location.pathname;if(o!=='/intern/common/referer_frame.php'&&o!=='/common/referer_frame.php')return;l=true;i.contentWindow.document.body.style.margin=0;j();}var n;if(c('isMessengerDotComURI')(c('URI').getRequestURI())){n=c('XRefererFrameController').getURIBuilder().getURI().toString();}else if(!c('lowerFacebookDomain').isValidDocumentDomain()){n='/intern/common/referer_frame.php';}else if(c('UserAgent').isBrowser('Opera')){n=c('XRefererFrameController').getURIBuilder().getURI().toString();}else n=c('XRefererFrameController').getURIBuilder().getURI().qualify().setProtocol('https').setSubdomain('staticxx').toString();if(k)n+='?fb_source='+k;i.onload=m;i.src=n;},useFacebookRefererHtml:function(i,j,k){h.useFacebookReferer(i,function(){i.contentWindow.document.body.innerHTML=j;},k);}};f.exports=h;},null);
__d('TrackingPixel',['Arbiter','ControlledReferer','NonBlockingIFrame','WebSpeedExperiments'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={_iframe:undefined,loadWithNoReferrer:function(i){if(!h._iframe)if(c('WebSpeedExperiments').non_blocking_logger){h._iframe=true;c('NonBlockingIFrame').loadIFrame().then(function(k){h._iframe=k;c('ControlledReferer').useFacebookReferer(k,function(){c('Arbiter').inform('TrackingPixel/iframeIsLoaded',null,c('Arbiter').BEHAVIOR_PERSISTENT);},null);}).done();}else{var j=document.createElement('iframe');j.frameborder=0;j.width=j.height=1;j.style.position='absolute';j.style.top='-10px';c('ControlledReferer').useFacebookReferer(j,function(){c('Arbiter').inform('TrackingPixel/iframeIsLoaded',null,c('Arbiter').BEHAVIOR_PERSISTENT);},null);document.body.appendChild(j);h._iframe=j;}c('Arbiter').subscribe('TrackingPixel/iframeIsLoaded',function(){var k=h._iframe.contentWindow,l=new k.Image();l.src=i;});}};f.exports=h;},null);
__d('ExternalTrackingTag',['AsyncSignal','TrackingPixel','Event'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={listenForElementClick:function(i,j,k,l,m){c('Event').listen(i,'click',function(){h.sendRequest(j,k,l,m);});},sendRequest:function(i,j,k,l){if(!i)return;new (c('AsyncSignal'))('/ads/external_tracking_tag/',{href:i,tracking_tag_id:j,adgroup_id:k,ad_id:l}).send();c('TrackingPixel').loadWithNoReferrer(i);}};f.exports=h;},null);
__d('FeedAdsClickLogger',['Arbiter','AsyncRequest','Banzai','BanzaiODS','collectDataAttributes','DataAttributeUtils','DOM','ge','LitestandMessages','LitestandStream','Parent','TrackingNodes','ExternalTrackingTag','URI','isFacebookURI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='ssinfeed',i={},j=false,k=[];function l(){'use strict';}l.prototype.init=function(m){'use strict';c('Arbiter').subscribe("ClickRefAction/new",this.onNewUserAction.bind(this));if(m.append_tracking_data_to_links){this.appendTrackingDataToLinks();c('Arbiter').subscribe(c('LitestandMessages').STORIES_INSERTED,this.appendTrackingDataToLinks.bind(this));c('Arbiter').subscribe('FeedAdsClickLogger/refreshTrackingData',this.appendTrackingDataToLinks.bind(this),c('Arbiter').SUBSCRIBE_NEW);}};l.prototype.getStories=function(){'use strict';var m=c('LitestandStream').getStreamRoot();if(m){return c('DOM').scry(m,c('LitestandStream').getStoriesSelector());}else{var n=c('ge')('home_stream');if(n)return c('DOM').scry(n,'.uiStreamStory');}return [];};l.prototype.appendTrackingDataToLinks=function(){'use strict';var m=this.getStories();for(var n=0;n<m.length;n++){var o=m[n];if(o in k)continue;var p=c('DataAttributeUtils').getDataFt(o);if(!p||p.indexOf('ei')===-1&&p.indexOf('mei')===-1)continue;var q=c('DOM').scry(o,'a');for(var r=0;r<q.length;r++){var s=q[r];if(s.getAttribute('ajaxify')!=null)continue;if(s.getAttribute('rel')!=null)continue;var t=s.getAttribute('href');if(!t||t.charAt(0)==='#')continue;var u=new (c('URI'))(s);if(c('isFacebookURI')(u)===false)continue;if(u.isLinkshimURI()===true)continue;var v=c('collectDataAttributes')(s,['ft']).ft,w=u.getQueryData();w.ft=v;w.__md__=0;u.setQueryData(w);s.setAttribute('href',u.toString());s.setAttribute('onmousedown',"this.href = this.href.replace('__md__=0', '__md__=1');");}k.push(o);}};l.prototype.getHref=function(m){'use strict';return (m.getAttribute&&(m.getAttribute('ajaxify')||m.getAttribute('data-endpoint'))||m.action||m.href);};l.prototype.sendLogRequest=function(m,n){'use strict';var o=m.ei||m.ai;if(!o&&m.mei)o=m.mf_story_key;if(m!==null&&typeof o==="string"){var p=false;if(m.tn){var q=c('TrackingNodes').parseTrackingNodeString(m.tn);for(var r=0;r<q.length;r++){var s=q[r][0];switch(s){case c('TrackingNodes').types.LIKE_LINK:case c('TrackingNodes').types.UNLIKE_LINK:case c('TrackingNodes').types.COMMENT:case c('TrackingNodes').types.COMMENT_LINK:case c('TrackingNodes').types.ADD_COMMENT_BOX:case c('TrackingNodes').types.MULTI_ATTACHMENT_VIDEO:return;case c('TrackingNodes').types.XBUTTON:case c('TrackingNodes').types.HIDE_LINK:case c('TrackingNodes').types.REPORT_SPAM_LINK:case c('TrackingNodes').types.HIDE_ALL_LINK:case c('TrackingNodes').types.DROPDOWN_BUTTON:case c('TrackingNodes').types.UNHIDE_LINK:return;case c('TrackingNodes').types.RELATED_SHARE_ARTICLE:case c('TrackingNodes').types.RELATED_SHARE_VIDEO:return;case c('TrackingNodes').types.ATTACHMENT:case c('TrackingNodes').types.USER_MESSAGE:p=true;break;}}}var t=Date.now(),u=500;m.duplicate_click=!!i[o]&&t-i[o]<u;i[o]=t;if(c('Banzai').isEnabled('ssinfeed')){c('Banzai').post(h,m,{delay:0,retry:c('Banzai').isEnabled('ssinfeed_retry')});}else{var v=new (c('AsyncRequest'))('/ajax/ssinfeed/end/').setData(m).setAllowCrossPageTransition(true).setMethod('POST');v.send();}var w=m.href;if(new (c('URI'))(w).isLinkshimURI()&&new (c('URI'))(w).getQueryData())w=new (c('URI'))(w).getQueryData().u;if(p&&!m.duplicate_click&&n!==null&&n.url&&w&&c('isFacebookURI')(new (c('URI'))(w))===false){c('ExternalTrackingTag').sendRequest(n.url,n.tag_id,n.adgroup_id);c('BanzaiODS').bumpEntityKey('external_tracking_tags','request_sent');}}};l.prototype.onNewUserAction=function(m,n){'use strict';if(!n.node)return;var o=this.getHref(n.node),p=c('Parent').byTag(n.node,'input')||c('Parent').byTag(n.node,'button');if(!o&&p&&p.type=="submit"&&p.getAttribute&&c('DataAttributeUtils').getDataFt(p))o="#";var q,r;if(o&&n.event&&(n.event.type==='click'||n.event.type==='contextmenu')){q=c('collectDataAttributes')(n.node,['ft']);q.ft.href=o;q.ft.mouse_type=n.event.type;r=c('collectDataAttributes')(n.node,['external-tracking-tags']);this.sendLogRequest(q.ft,r['external-tracking-tags']);}};f.exports.init=function(m){if(j===false){new l().init(m);j=true;}};},null);