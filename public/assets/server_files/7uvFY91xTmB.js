if (self.CavalryLogger) { CavalryLogger.start_js(["CqR5\/"]); }

__d("LocalSERPSurfaceRequestParam",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={SINGLE_STATE:"sist",TYPEAHEAD:"tyah",ECHO:"ec",SERP_TO_SERP:"s2s",NEARBY_PLACES:"nepl",FEED_STORY:"fest",PLACES_TAB:"plta",NOTIFICATIONS:"noti",RECENT_SEARCHES:"rese",TODAY:"to"};},null);
__d("SearchAwarenessEventTypes",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={CLICK:"click",IMPRESSION:"impression",DISMISSAL:"dismissal",WEAK_DISMISSAL:"weak_dismissal",SYSTEM_FORCED_DISMISSAL:"system_forced_dismissal"};},null);
__d("SearchAwarenessUserAction",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={LIKE:"like",COMMENT:"comment",ARTICLE_CLICK:"article_click",COMPOSE_PUBLISH:"compose_publish",PAGE_LIKE:"page_like"};},null);
__d("SearchPivotType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={PHOTO:"photo",PHOTO_EXPERIMENTAL:"photo_experimental",VIDEO:"video",FEED_SEARCH_KEYWORDS:"feed_search_keywords",SEARCH_AWARENESS_KEYWORDS:"search_awareness_keywords",ARTICLE_CLICK_ACTION:"ARTICLE_CLICK_ACTION",STORY_CLICK_ACTION:"STORY_CLICK_ACTION",STORY_LIKE_ACTION:"STORY_LIKE_ACTION",STORY_UNLIKE_ACTION:"STORY_UNLIKE_ACTION",STORY_COMMENT_DELETE_ACTION:"STORY_COMMENT_DELETE_ACTION",COMPOSER_PUBLISH_ACTION:"COMPOSER_PUBLISH_ACTION",FAN_PAGE_ACTION:"FAN_PAGE_ACTION",TRENDING_SERP_LOAD:"TRENDING_SERP_LOAD",PHOTOS_SERP_LOAD:"PHOTOS_SERP_LOAD",STORY_COMMENT_ACTION:"STORY_COMMENT_ACTION",SCROLL_ACTION:"SCROLL_ACTION",NEWS_FEED:"NEWS_FEED",PAGE:"PAGE",GROUP:"GROUP",NEWS_FEED_SECONDARY:"NEWS_FEED_SECONDARY",POST_SEARCH_SERP:"POST_SEARCH_SERP",LEARNING_NUX:"LEARNING_NUX",LEARNING_NUX_SECOND_STEP:"LEARNING_NUX_SECOND_STEP",MOBILE_STORY_LIKE_ACTION:"MOBILE_STORY_LIKE_ACTION",MOBILE_STORY_COMMENT_ACTION:"MOBILE_STORY_COMMENT_ACTION",MOBILE_COMMENT_LIKE_ACTION:"MOBILE_COMMENT_LIKE_ACTION",TIMELINE:"TIMELINE",NEXT_TRENDING:"NEXT_TRENDING",LEARNING_NUX_STANDALONE:"LEARNING_NUX_STANDALONE",TUTORIAL_NUX:"TUTORIAL_NUX",FEED_READ_ACTION:"FEED_READ_ACTION",NON_TRIGGERED_LEARNING_NUX:"NON_TRIGGERED_LEARNING_NUX",TYPEAHEAD_TOOLTIP:"TYPEAHEAD_TOOLTIP",TRIGGERED_LEARNING_NUX:"TRIGGERED_LEARNING_NUX"};},null);
__d("TimelineFilterOptions",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ALL:"all",REVIEW:"review",TAG_REVIEW:"tagreview",FACE_ALERTS:"facealertsreview",POSTSANDAPPS:"postsandapps",LOCATION:"location",PHOTOS:"photos",TAGGED_PHOTOS:"taggedphotos",OWN_PHOTOS:"ownphotos",LIKES:"likes",LIKED_INTERESTS:"likedinterests",LIKED_POSTS:"likedposts",GROUPS:"groups",GROUP_MEMBERSHIP:"groupmembership",GROUP_POSTS:"groupposts",HIDDEN:"hidden",SPAM:"spam",ALL_APPS:"apps",SEARCH:"search",VIDEO_SEARCH:"videosearch",ADS:"ads",CLUSTER:"cluster",APP:"app",STORIES:"stories",COLLECTION_ITEM:"citem",FITNESS:"fitness",OG_VIDEO:"ogvideo",SAVED_FOR_LATER:"saved",PRIVATE_NOTES:"private_notes",NOW:"now"};},null);
__d("WorkInviteSource",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={RHC_MODULE:"rhc_module",NEWSFEED_NUX:"newsfeed_nux",IOS_APP:"ios_app",ANDROID_APP:"android_app",BULK_UPLOAD:"bulk_upload",GROUP_INVITE_DIALOG:"group_invite_dialog",GROUP_INVITE_TYPEAHEAD:"group_invite_typeahead",SEARCH_RESULT:"search_result",SEARCH_RHC:"search_rhc",SEARCH_TYPEAHEAD:"search_typeahead",SELF_INVITE:"self_invite",SELF_INVITE_VIA_INVITE_LINK:"self_invite_via_invite_link"};},null);
__d('BrowseFacebarHighlighter',['csx','CSS','NodeHighlighter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={};Object.assign(i,c('NodeHighlighter'),{getHighlightCandidates:function(){return ["._53ad"];},isDiscardNode:function(j){return c('CSS').hasClass(j,'DefaultText');},createSegmentedRegex:function(j){j=this.escapeAndAddBidirectionalCharsToTokens(j);return '(^|\\s|\\b)('+j.join('|')+')';}});f.exports=i;},null);
__d('TypeaheadFacepileX.react',['React','joinClasses'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;function j(){var k,l;'use strict';for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return k=(l=i.constructor).call.apply(l,[this].concat(n)),this.renderPic=function(p,q){var r='url('+this.props.photos[p]+')';return (c('React').createElement('span',{className:c('joinClasses')('splitpic',q),key:p,style:{backgroundImage:r}}));}.bind(this),this.renderPics=function(){var p=this.props.size;if(p>=3){return [this.renderPic(0,'leftpic'),this.renderPic(1,'toppic'),this.renderPic(2,'bottompic')];}else return [this.renderPic(0,'leftpic'),this.renderPic(1)];}.bind(this),k;}j.prototype.render=function(){'use strict';return (c('React').createElement('span',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"splitpics clearfix")}),this.renderPics()));};f.exports=j;},null);
__d("XSearchAwarenessController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/async\/awareness\/",{origin:{type:"String"},story_id:{type:"String"},actor_id:{type:"String"},global_share_id:{type:"String"},query:{type:"String"},dismiss:{type:"Exists",defaultValue:false},source_object_id:{type:"String"},user_action:{type:"String"}});},null);
__d('SearchAwarenessDismissButton',['Arbiter','AsyncRequest','DOM','EventListener','XSearchAwarenessController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={init:function(i,j,k,l){var m=c('EventListener').listen(j,'click',function(){c('DOM').remove(i);m.remove();c('Arbiter').inform('SearchAwareness.dismissUnit');h.dismiss(k,l);});},dismiss:function(i,j){var k=c('XSearchAwarenessController').getURIBuilder().setString('origin',i).setString('source_object_id',j).setExists('dismiss',true);new (c('AsyncRequest'))().setURI(k.getURI()).send();}};f.exports=h;},null);
__d('SearchAwarenessDispatcher',['csx','cx','Arbiter','AsyncRequest','AttachmentRelatedShareConstants','Banzai','CSS','DOM','EventListener','NavigationMessage','PageLikeConstants','Run','SearchAwarenessDismissButton','SearchAwarenessEventTypes','SearchAwarenessUserAction','SearchAwarenessWebConfig','SearchPivotType','SubscriptionsHandler','UFIFeedbackTargets','UFIUIEvents','XSearchAwarenessController','getScrollPosition','joinClasses','setTimeoutAcrossTransitions','throttle'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=false,k={},l={},m,n={init:function(){if(!c('SearchAwarenessWebConfig').master_gk)return;if(j)return;m=new (c('SubscriptionsHandler'))();m.addSubscriptions(c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,n._cleanup.bind(this)),c('Arbiter').subscribe(c('PageLikeConstants').LIKED,n._onFan.bind(this)),c('Arbiter').subscribe('composer/publish',n._onComposerPublish.bind(this)),c('Arbiter').subscribe('LitestandComposer/publish',n._onComposerPublish.bind(this)),c('Arbiter').subscribe(c('AttachmentRelatedShareConstants').ARTICLE_CLICK,n._onArticleClick.bind(this)));c('Run').onLeave(n._cleanup.bind(this));j=true;},_cleanup:function(){m&&m.release();m=null;j=false;var o=c('DOM').scry(document.body,"._18az")[0];if(o==null)return;c('CSS').removeClass(document.body,"_18at");c('CSS').removeClass(document.body,"_18au");c('CSS').removeClass(document.body,"_18aw");c('CSS').removeClass(o,"_18ax");},_onFan:function(o,p){if(!c('SearchAwarenessWebConfig').has_on_fan)return;n._dispatch(p.target,{origin:c('SearchPivotType').FAN_PAGE_ACTION,actor_id:p.profile_id,user_action:c('SearchAwarenessUserAction').PAGE_LIKE});},_onLike:function(o,p){if(!p.ft_id)return;c('UFIFeedbackTargets').getFeedbackTarget(p.ft_id,function(q){var r=q.entidentifier;if(r==null||k[r]!=null)return;k[r]=true;n._dispatch(p.target,{actor_id:q.actorid,story_id:q.entidentifier,origin:p.origin,query:p.query,user_action:c('SearchAwarenessUserAction').LIKE});});},_onPhotoClick:function(o,p){if(!c('SearchAwarenessWebConfig').has_on_photo_click)return;n._dispatch(p.target,{story_id:p.storyid,origin:c('SearchPivotType').STORY_CLICK_ACTION});},_onArticleClick:function(o,p){if(!c('SearchAwarenessWebConfig').has_on_article_click)return;var q=p.global_share_id!=null?String(p.global_share_id):null;n._dispatch(null,{global_share_id:q,story_id:p.share_id,origin:c('SearchPivotType').ARTICLE_CLICK_ACTION,user_action:c('SearchAwarenessUserAction').ARTICLE_CLICK});},initOnComment:function(o,p){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();if(m==null)return;m.addSubscriptions(c('Arbiter').subscribe('UFI/CommentAddedActive',function(q,r){var s={origin:o,query:p,ft_id:r};n._onComment(q,s);}));},_onComment:function(o,p){if(!p.ft_id)return;c('UFIFeedbackTargets').getFeedbackTarget(p.ft_id,function(q){var r=q.entidentifier;if(r==null||l[r]!=null)return;l[r]=true;n._dispatch(p.target,{actor_id:q.actorid,story_id:q.entidentifier,origin:p.origin,query:p.query,user_action:c('SearchAwarenessUserAction').COMMENT});});},_onComposerPublish:function(o,p){if(!c('SearchAwarenessWebConfig').has_on_composer_publish)return;n._dispatch(null,{story_id:p.content_id,origin:c('SearchPivotType').COMPOSER_PUBLISH_ACTION,user_action:c('SearchAwarenessUserAction').COMPOSE_PUBLISH});},initOnLike:function(o,p,q){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();if(m==null)return;m.addSubscriptions(c('Arbiter').subscribe(c('UFIUIEvents').ReactionButtonClicked,function(r,s){var t={ft_id:s.ft_id,origin:o,query:p,target:q?null:s.target};n._onLike(r,t);}));},onPageLoad:function(o,p,q){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();n._dispatch(null,{query:p,origin:o,actor_id:q});},initProfileScopedSearch:function(){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();if(m==null)return;var o=c('DOM').scry(document.body,"._5ibl")[0];if(o!=null){n._dispatch(o,{origin:c('SearchPivotType').TIMELINE,specified_target:true});}else m.addSubscriptions(c('Arbiter').subscribe('profileSearchBoxLoaded',function(){var p=c('DOM').scry(document.body,"._5ibl")[0];if(p==null)return;n._dispatch(p,{origin:c('SearchPivotType').TIMELINE,specified_target:true});}));},onPhotosSERPLoad:function(o){if(o==null||!c('SearchAwarenessWebConfig').master_gk)return;n._dispatch(null,{query:o,origin:c('SearchPivotType').PHOTOS_SERP_LOAD});},_dispatch:function(o,p,q){if(!p.origin)return true;var r=c('XSearchAwarenessController').getURIBuilder().setString('origin',p.origin);if(p.story_id)r.setString('story_id',p.story_id);if(p.actor_id)r.setString('actor_id',p.actor_id);if(p.global_share_id)r.setString('global_share_id',p.global_share_id.toString());if(p.query)r.setString('query',p.query);if(p.user_action)r.setString('user_action',p.user_action);var s=new (c('AsyncRequest'))().setURI(r.getURI()),t=o;if(o!=null&&!p.specified_target)t=this.findStory(o);if(t==null){var u=c('DOM').scry(document.body,"._585-")[0],v=c('DOM').scry(document.body,"._5ob9")[0];t=u!=null?u:v;}if(t)s.setRelativeTo(t);if(q)s.setHandler(q);if(t||q)s.send();return true;},showAwarenessExperienceNow:function(o,p,q){if(!j)n.init();if(p==null||!j||m==null)return;var r=void 0;m.addSubscriptions(p.subscribe('cancel',function(){r=true;c('SearchAwarenessDismissButton').dismiss(o);}),p.subscribe('hide',function(){if(!r&&q){c('Banzai').post('search_awareness',{origin:o,event_type:c('SearchAwarenessEventTypes').WEAK_DISMISSAL},{signal:true});}else if(!r&&!q)c('Banzai').post('search_awareness',{origin:o,event_type:c('SearchAwarenessEventTypes').SYSTEM_FORCED_DISMISSAL},{signal:true});}),c('Arbiter').subscribe('SearchAwareness.weakDismissUnit',function(){if(p!=null){r=false;p.hide();}}),c('Arbiter').subscribe('SearchAwareness.dismissUnit',function(){if(p!=null){r=true;p.hide();}}));p.show();c('Run').onLeave(function(){p=null;});},findStory:function(o){var p="^div._4-u2",q=c('DOM').scry(o,p);return q.length===1?q[0]:null;},onTrendingSERPLeave:function(o,p){if(!j)n.init();if(o==null||!j)return;c('Run').onLeave(function(){c('setTimeoutAcrossTransitions')(function(){c('Run').onAfterLoad(function(){n._dispatch(null,{query:o,origin:c('SearchPivotType').TRENDING_SERP_LOAD});});},p);});},openBelowBluebarUnit:function(o){if(!j)n.init();var p=c('DOM').scry(document.body,"._18a-")[0];if(p==null)return;var q;switch(o){case c('SearchPivotType').TRENDING_SERP_LOAD:q="_18at";break;case c('SearchPivotType').GROUP:q="_18au";break;case c('SearchPivotType').PAGE:q="_18aw";break;}if(q==null)return;c('CSS').addClass(document.body,q);c('CSS').addClass(p,"_18ay");var r=c('Arbiter').subscribe('SearchAwareness.dismissUnit',function(){c('CSS').removeClass(document.body,q);});m&&m.addSubscriptions(r);},trigger:function(o,p,q,r,s){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();n._dispatch(null,{query:p,origin:o,actor_id:q,story_id:r,global_share_id:s});},triggerLearningNUX:function(o,p,q,r,s){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();n._dispatch(null,{query:p,origin:o,actor_id:q,story_id:r,global_share_id:s},function(t){var u=c('DOM').create('div',{className:c('joinClasses')("_3lik","hidden_elem"),'data-origin':o});c('DOM').appendContent(u,t.payload);c('DOM').appendContent(document.body,u);setTimeout(function(){c('Arbiter').inform('SearchAwareness.triggerLearningNUX',{origin:o},c('Arbiter').BEHAVIOR_STATE);},0);});},onTimelineScroll:function(o,p,q,r){if(!c('SearchAwarenessWebConfig').master_gk)return;if(!j)n.init();var s=false,t=c('EventListener').listen(document,'scroll',c('throttle')(function(event){if(!s&&c('getScrollPosition')(window).y>p){s=true;n.onPageLoad(o,q,r);t.remove();}},500));}};f.exports=n;},null);
__d('FacebarSemanticQuery',['CurrentUser','URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='str',i=/\*[\w\-]+\(/g;function j(t){var u={me:c('CurrentUser').getID()};return Object.assign(u,Array.isArray(t.semantic_map)?{}:t.semantic_map);}function k(t,u){var v=j(t);if(typeof v[u]!=='undefined')return String(v[u]);return u;}function l(t){return new (c('URI'))("/profile.php").addQueryData({id:t});}function m(t,u){var v=[u],w=[],x=t.browse_functions,y=t.search_path;while(v.length>0){var z=v.pop();if(!p(z)){w.push(z);continue;}var aa=z.substring(0,z.indexOf('(')),ba=aa,ca=q(z);if(!x[aa]){w=[];break;}var da=x[aa].minNumParams,ea=x[aa].maxNumParams;if(v.length>0)if(x[aa].numParamsUnbounded){if(w.length>0)aa+='-'+ca.length;}else if(ca.length!=1&&ca.length>da||ca.length===0&&da!=ea)aa+='-'+ca.length;v.push(aa);for(var fa=0;fa<ca.length;fa++){if(ca[fa].length===0)continue;if(x[ba].allowsFreeText){v.push(h+'/'+encodeURIComponent(encodeURIComponent(ca[fa])));}else v.push(ca[fa]);}}return new (c('URI'))(y+w.join('/'));}function n(t){return t.replace(/['"\[\]]/g,'');}function o(t,u){var v=JSON.parse(u),w=[];if(v.length>0)w=[v[0]];var x=[],y=t.browse_functions,z=t.search_path;while(w.length>0){var aa=w.pop();if(typeof aa!=='object'){x.push(n(aa));continue;}var ba=Object.keys(aa)[0],ca=ba,da=aa[ba];if(!y[ba]){x=[];break;}var ea=y[ba].minNumParams,fa=y[ba].maxNumParams;if(w.length>0)if(y[ba].numParamsUnbounded){if(x.length>0)ba+='-'+da.length;}else if(da.length!=1&&da.length>ea||da.length===0&&ea!=fa)ba+='-'+da.length;w.push(ba);for(var ga=0;ga<da.length;ga++){if(da[ga].length===0)continue;if(y[ca].allowsFreeText){w.push(h+'/'+encodeURIComponent(da[ga]));}else w.push(da[ga]);}}return new (c('URI'))(z+x.join('/'));}function p(t){return (/^[a-z\-]+\(.*\)$/.test(t));}function q(t){if(!p(t)&&t.indexOf('param_')!==0)return [t];var u=t.substring(t.indexOf('(')+1,t.length-1);if(u.length===0)return [];return r(u);}function r(t){var u=[],v=0,w=0;for(var x=0;x<t.length;++x)if(t[x]==','&&w===0){u.push(t.substring(v,x));v=x+1;}else if(t[x]=='('){w++;}else if(t[x]==')')w--;u.push(t.substring(v,t.length));return u;}function s(t,u,v){'use strict';this.facebarConfig=t;this.unmapped=(u||"").trim();this.mapped=k(t,this.unmapped);this.position=null;this.$FacebarSemanticQuery1=typeof v!=='undefined'?v:false;}s.prototype.isEntity=function(){'use strict';return (/^\d+$/.test(this.mapped));};s.prototype.isShortcut=function(){'use strict';return this.mapped.indexOf('shortcut(')===0;};s.prototype.isImplemented=function(){'use strict';return this.mapped&&!this.mapped.match(i);};s.prototype.isSemanticForest=function(){'use strict';return this.$FacebarSemanticQuery1;};s.prototype.getUnimplemented=function(){'use strict';return (this.mapped.match(i)||[]).map(function(t){return t.substr(1,t.length-2);});};s.prototype.getURI=function(){'use strict';if(this.isEntity()){return l(this.mapped);}else if(this.isShortcut()){return new (c('URI'))(this.mapped.substr(9,this.mapped.length-10));}else if(this.isSemanticForest()){return o(this.facebarConfig,this.unmapped);}else return m(this.facebarConfig,this.unmapped);};f.exports=s;},null);
__d('FacebarURI',['FacebarJSConstants','FacebarSemanticQuery','KeywordsSearchResultConfig','URI','WWWBase','LocalSERPSurfaceRequestParam'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={event:{ref:c('FacebarJSConstants').eventLinkRef},user:{fref:'ts'},page:{fref:'ts'}},i={getSearchRawPrefix:function(){return 'search';},getSearchPath:function(){return '/'+this.getSearchRawPrefix()+'/';},getURI:function(j,k){var l=null,m=!k.song&&!k.isExtendedResult&&k.path;if(m){l=new (c('URI'))(m);if(k.type in h)l.addQueryData(h[k.type]);}else if(c('KeywordsSearchResultConfig').use_seo_urls&&k.type===c('KeywordsSearchResultConfig').result_type&&k.semantic.startsWith('str/')){if(k.keywordType===c('FacebarJSConstants').keywordTypes.local_category){l=new (c('URI'))('/search/places').addQueryData('q',k.keyword?k.keyword:k.text);}else l=new (c('URI'))(c('KeywordsSearchResultConfig').seo_top_url).addQueryData('q',k.keyword?k.keyword:k.text);}else{var n=new (c('FacebarSemanticQuery'))(j,k.semantic);if(n&&n.isImplemented())l=n.getURI();if(k.keywordType===c('FacebarJSConstants').keywordTypes.local)if(k.isSingleState){l.addQueryData('surface',c('LocalSERPSurfaceRequestParam').SINGLE_STATE);}else if(k.isRecent){l.addQueryData('surface',c('LocalSERPSurfaceRequestParam').RECENT_SEARCHES);}else l.addQueryData('surface',c('LocalSERPSurfaceRequestParam').TYPEAHEAD);}return l&&i.getQualifiedURI(l);},getQualifiedURI:function(j){var k=new (c('URI'))(j);if(!k.getDomain()){var l=new (c('URI'))(c('WWWBase').uri);k.setProtocol(l.getProtocol()).setDomain(l.getDomain()).setPort(l.getPort());}return k;}};f.exports=i;},null);
__d('FacebarFindPeopleAndPages',['cx','fbt','FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarURI','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={insertInto:function(k,l,m){k=this._cleanQuery(k);var n=this._getInsertionIndex(k,l);if(n>-1){var o=this._createFindPeopleAndPagesResult(k,m);l.splice(n,0,o);}},_getInsertionIndex:function(k,l){if(!k||!c('FacebarGlobalOptions').findPeopleAndPages)return -1;var m=l.some(this._isUserOrPageSuggestion);if(!m)return -1;var n=-1;for(var o=0;o<l.length;o++)if(this._isEntitySuggestion(l[o]))n=o+1;return n;},_isUserOrPageSuggestion:function(k){return k.type==='user'||k.type==='page';},_isEntitySuggestion:function(k){return k.type!==c('FacebarJSConstants').keywordType&&k.type!==c('FacebarJSConstants').grammarType;},_cleanQuery:function(k){return String(k).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createFindPeopleAndPagesResult:function(k,l){var m='str/'+k+'/keywords_entities',n=i._("Find all people and pages named \"{query}\"",[i.param('query',k)]);return {type:'grammar',results_set_type:'browse_type_blended',text:k,id:k,uid:k,query_string:k,icon_class:"_207",isSeeMore:true,isPeopleAndPagesSuggestion:true,structure:c('FacebarStructuredText').fromString(n),semantic:m,uri:c('FacebarURI').getQualifiedURI(new (c('URI'))('/search/'+m)),fromCache:l,tags:{displayedSeeMore:true}};}};f.exports=j;},null);
__d('FacebarKeywordSearchUtils',['FacebarURI','FacebarStructuredText','FacebarJSConstants','KeywordsSearchResultConfig','URI','LocalSERPSurfaceRequestParam'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=function(j){var k=0;while(k<j.length)if(j[k].exactMatchKeyword){j.splice(k,1);}else ++k;},i={addExactMatch:function(j,k,l){if(!k.length)return;var m,n;for(var o=0,p=k.length;o<p;o++){n=k[o];if(n.type==='grammar')continue;m=true;break;}if(!m)return;var q=this.getExactMatchKeywordResult(j);if(!q)return;var r=Math.min(k.length,l),s=r;for(o=0;o<r;o++){n=k[o];if(n.exactMatchKeyword)return;if(n.cost>c('KeywordsSearchResultConfig').default_cost)--s;if(n.type!==c('KeywordsSearchResultConfig').result_type)continue;q.backendCost=n.cost+c('KeywordsSearchResultConfig').exact_match_cost_delta_from_best;q.cost=n.backendCost;h(k);k.splice(o,0,q);return;}h(k);k.splice(Math.min(Math.min(r,l-1),s),0,q);},getExactMatchKeywordResult:function(j){if(!j||j.is_empty||!j.raw_text)return;var k=j.raw_text.toLowerCase().replace(/\s{2,}/g,' ').trim(),l=c('KeywordsSearchResultConfig').query_prefix_blacklist;for(var m=0;m<l.length;m++)if(k.startsWith(l[m]))return;var n=this.makeFacebarEntry(k);return this._makeFacebarResult(n,j.cache_id.length);},makeFacebarEntryForLocalPage:function(j){var k=j.getFragment(0).getUID(),l=j.getFragment(0).getText(),m=k+'/local_search',n=c('FacebarURI').getQualifiedURI(new (c('URI'))('/search/'+m).addQueryData('surface',c('LocalSERPSurfaceRequestParam').SINGLE_STATE));return {semantic:m,text:l,type:c('KeywordsSearchResultConfig').result_type,resultsSetType:c('KeywordsSearchResultConfig').result_set_type,uid:c('KeywordsSearchResultConfig').uid_prefix+l,iconClass:c('KeywordsSearchResultConfig').icon_class,keywordType:c('FacebarJSConstants').keywordTypes.local,uri:n,structure:c('FacebarStructuredText').fromString(l)};},makeFacebarEntry:function(j){var k=null,l=null;if(c('KeywordsSearchResultConfig').gsv2_results_page){l='str/'+encodeURIComponent(j).replace(/%20/g,'+')+'/'+c('KeywordsSearchResultConfig').gsv2_browse_edge;k=c('FacebarURI').getQualifiedURI(new (c('URI'))('/search/'+l));}else{k=c('FacebarURI').getQualifiedURI(new (c('URI'))(c('KeywordsSearchResultConfig').results_page_url).addQueryData('q',j));l=c('KeywordsSearchResultConfig').shortcut+'('+k.toString()+')';}if(c('KeywordsSearchResultConfig').use_seo_urls)k=c('FacebarURI').getQualifiedURI(new (c('URI'))(c('KeywordsSearchResultConfig').seo_top_url).addQueryData('q',j));return {semantic:l,text:j,type:c('KeywordsSearchResultConfig').result_type,resultsSetType:c('KeywordsSearchResultConfig').result_set_type,uid:c('KeywordsSearchResultConfig').uid_prefix+j,iconClass:c('KeywordsSearchResultConfig').icon_class,uri:k,structure:c('FacebarStructuredText').fromString(j)};},_makeFacebarResult:function(j,k){var l={semantic:j.semantic,structure:[{type:'grammar',text:j.text,uid:j.semantic}],type:j.type,resultsSetType:j.resultsSetType,cost:c('KeywordsSearchResultConfig').default_cost,cache_id_length:k,parse:{display:[{type:'grammar',uid:c('KeywordsSearchResultConfig').uid_prefix+j.text}],remTokens:[],suffix:''},iconClass:j.iconClass,exactMatchKeyword:true};l.tuid=JSON.stringify({semantic:l.semantic,structure:l.structure});return l;}};f.exports=i;},null);
__d('FacebarGSv2Echo',['cx','fbt','CurrentCommunity','CurrentUser','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText','FacebarURI','URI'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={insertInto:function(k,l,m,n,o,p,q){var r=j.normalizeValue(k);if(!this._shouldInsert(k,l))return;var s=l.findIndex(function(w){return w.isSpecialIntent&&this._isKeywordSuggestion(w)&&r===j.normalizeValue(w.text);}.bind(this),this),t=c('FacebarGlobalOptions').showEcho&&(!c('FacebarGlobalOptions').renderKeywordSnippets||s<0);if(!t)return;var u=this._removeExactMatchAndReturnSubtext(k,l),v=this._createEchoResult(k,m,u,n,o,p);if(n){if(c('FacebarGlobalOptions').singleStateClientInjections&&!o){l.unshift(this._createSingleStateResult(i._("{fullName} videos",[i.param('fullName',r)]),{isVideos:true}));l.unshift(this._createSingleStateResult(i._("{fullName} photos",[i.param('fullName',r)]),{isPhotos:true}));if(c('FacebarGlobalOptions').enablePersonSERP&&q&&k instanceof c('FacebarStructuredText'))l.unshift(this._createSingleStateResult(i._("{fullName}",[i.param('fullName',r)]),{isPersonSERP:true},k.getFragment(0).getUID()));}if(v!=null)l.unshift(v);}else if(v!=null)if(c('FacebarGlobalOptions').hasEchoOnTop){l.unshift(v);}else l.push(v);},_shouldInsert:function(k,l){k=j.normalizeValue(k);if(!k||!c('FacebarGlobalOptions').graphSearchV2)return false;for(var m=0;m<l.length;m++){var n=l[m];if(n.type===c('FacebarJSConstants').keywordType&&k===j.normalizeValue(n.text)){if(c('FacebarGlobalOptions').hasEchoOnTop)l.unshift(n);return false;}}return true;},_isKeywordSuggestion:function(k){return k.type===c('FacebarJSConstants').keywordType||k.type===c('FacebarJSConstants').grammarType;},_removeExactMatchAndReturnSubtext:function(k,l){var m='';k=j.normalizeValue(k);for(var n=0;n<l.length;n++){var o=l[n];if(this._isKeywordSuggestion(o)&&k===j.normalizeValue(o.text)){if(o.subtext)m=o.subtext;l.splice(n,1);return m;}}return m;},normalizeValue:function(k){return String(k).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'').toLowerCase();},_createEchoResult:function(k,l,m,n,o,p){var q=j.normalizeValue(k),r=n&&o&&c('FacebarGlobalOptions').showLocalPinkKwsSingleState&&k instanceof c('FacebarStructuredText')&&k.getFragment(0)&&k.getFragment(0).isLocal();if(r&&c('FacebarGlobalOptions').singleStateAsyncLocalPlaceEcho)return null;var s=r?c('FacebarKeywordSearchUtils').makeFacebarEntryForLocalPage(k):c('FacebarKeywordSearchUtils').makeFacebarEntry(q),t=r?c('FacebarJSConstants').keywordTypes.local:c('FacebarJSConstants').keywordTypes.keyword,u={};if(c('FacebarGlobalOptions').renderKeywordSnippets)if(r){u.subtext=m||i._("See photos, posts and info about this place");if(p!==null)u.boldedSubtext=i._("{categoryName}",[i.param('categoryName',p)]);}else if(n&&c('FacebarGlobalOptions').singleStateClientInjections){u.boldedSubtext=m||i._("Posts");}else if(c('CurrentUser').isWorkUser()){u.subtext=m||i._("Search {communityName}",[i.param('communityName',c('CurrentCommunity').getName())]);}else u.subtext=m||i._("Search Facebook");return babelHelpers['extends']({type:c('FacebarJSConstants').keywordType,results_set_type:c('FacebarJSConstants').browseTypes.keyword,text:k,id:q,uid:q,query_string:q,icon_class:"_5b1w",isSingleState:n,isLocal:r,exactMatchKeyword:true,structure:c('FacebarStructuredText').fromString(String(k)),semantic:s.semantic,uri:s.uri,keywordType:t,keywordSource:c('FacebarJSConstants').keywordTypes.echo,fromCache:l,tags:{}},u);},_createSingleStateResult:function(k,l,m){k=j.normalizeValue(k);var n=void 0,o=c('FacebarKeywordSearchUtils').makeFacebarEntry(k),p=void 0,q=o.semantic,r=o.uri,s='keyword';if(c('FacebarGlobalOptions').renderKeywordSnippets)if(l.isPhotos){s='photos';n=i._("Photos");}else if(l.isVideos){s='videos';n=i._("Videos");}else if(l.isPersonSERP){s='person_serp';if(m){q=m+'/'+c('FacebarJSConstants').browseEdges.keywords_person_serp;r=c('FacebarURI').getQualifiedURI(new (c('URI'))('/search/'+q));}n=i._("Overview");p=i._("Get an overview from public posts");}else n=i._("Posts");return babelHelpers['extends']({type:c('FacebarJSConstants').keywordType,results_set_type:c('FacebarJSConstants').browseTypes.keyword,text:k,id:k,uid:k,query_string:k,icon_class:"_5b1w",exactMatchKeyword:l.isPhotos==null&&l.isVideos==null&&l.isPersonSERP==null,structure:c('FacebarStructuredText').fromString(k),semantic:q,uri:r,boldedSubtext:n,subtext:p,keywordSource:c('FacebarJSConstants').injectedSuggestionSource,keywordType:s,tags:{},isSingleState:true},l);}};f.exports=j;},null);
__d("XAtWorkInvitesSearchDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/work\/invite\/search_typeahead_dialog\/",{source:{type:"String",required:true},__asyncDialog:{type:"Int"}});},null);
__d('FacebarInviteCoworkers',['cx','fbt','WorkInviteSource','FacebarGlobalOptions','FacebarStructuredText','XAtWorkInvitesSearchDialogController'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={insertInto:function(k,l,m){k=this._cleanQuery(k);var n=this._getInsertionIndex(k,l);if(n>-1){var o=this._createInviteCoworkersResult(k,m);l.splice(n,0,o);}},_getInsertionIndex:function(k,l){if(!k||!c('FacebarGlobalOptions').inviteCoworkers)return -1;return l.length;},_cleanQuery:function(k){return String(k).trim().replace(/\s+/g,' ').replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,'');},_createInviteCoworkersResult:function(k,l){var m=i._("Invite \"{query}\" to Facebook at Work",[i.param('query',k)]),n=c('XAtWorkInvitesSearchDialogController').getURIBuilder().setString('source',c('WorkInviteSource').SEARCH_TYPEAHEAD).getURI();return {uid:k,icon_class:"_5yiv",isSeeMore:true,isAsync:true,structure:c('FacebarStructuredText').fromString(m),asyncURI:n,fromCache:l};}};f.exports=j;},null);
__d('FacebarNoFlickerResults',['cx','fbt','FacebarGSv2Echo','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=[],k={},l=void 0,m={insertInto:function(n,o,p,q){var r;o.forEach(function(ba){ba.isInvalidated=false;});n=c('FacebarGSv2Echo').normalizeValue(n);var s=n.length===0,t=o.filter(function(ba){return ba.type===c('FacebarJSConstants').keywordType&&!ba.exactMatchKeyword;}),u=t.filter(function(ba){return !ba.exactMatchKeyword;}),v=t.length;if(u.length>1)if(s){j=[];}else j=u.slice(0,2);if(k[n]||p===true&&q===false||v>=c('FacebarGlobalOptions').default_num_top_results_to_show){k[n]=true;if(s){j=[];}else j=u.slice(0,2);return;}if(q===false)return;var w=function(){if(y){if(z>=x.length)return 'break';aa=x[z++];}else{z=x.next();if(z.done)return 'break';aa=z.value;}var ba=aa;if(!o.some(function(ca){return ca.text===ba.text;})){ba.isInvalidated=true;o.push(ba);}};for(var x=j,y=Array.isArray(x),z=0,x=y?x:x[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var aa,r=w();if(r==='break')break;}if(n.length<2||l==null)l=o.filter(function(ba){return ba.type!=='keyword';})[0];if(l==null)return;o.push(this._createResult(i._("{fullName} photos",[i.param('fullName',l.text.toLowerCase())])));o.push(this._createResult(i._("{fullName} posts",[i.param('fullName',l.text.toLowerCase())])));},_createResult:function(n){n=c('FacebarGSv2Echo').normalizeValue(n);var o=c('FacebarKeywordSearchUtils').makeFacebarEntry(n),p=void 0;if(c('FacebarGlobalOptions').renderKeywordSnippets)p=i._("Search Facebook");return {type:c('FacebarJSConstants').keywordType,results_set_type:c('FacebarJSConstants').browseTypes.keyword,text:n,id:n,uid:n,query_string:n,icon_class:"_5b1w",exactMatchKeyword:true,structure:c('FacebarStructuredText').fromString(String(n)),semantic:o.semantic,uri:o.uri,subtext:p,isInvalidated:true,tags:{}};}};f.exports=m;},null);
__d('FacebarResultStore',['cx','fbt','Arbiter','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','KeywordsSearchResultConfig','TokenizeUtil','SearchI18nMatch','SearchPivotType','concatMap'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=3;function k(p,q,r,s){'use strict';this.facebarConfig=p;this.facebarConfig.grammar_stop_words_penalty=this.facebarConfig.grammar_stop_words_penalty||2;this.facebarConfig.grammar_stop_words=this.facebarConfig.grammar_stop_words||{};this.facebarConfig.options=s;this.injectedSuggestionCount=0;this.tokenize=q;this.getEntry=r;this.typeaheadTypeMap=this.facebarConfig.mapped_types;this.facebarConfig.typeahead_types.forEach(function(t){this.typeaheadTypeMap[t]=t;},this);this.unicodeMatch=new (c('SearchI18nMatch'))({prefix_hangul_conjoining_jamo:true});this.resetCaches();}k.prototype.transformStructured=function(p){'use strict';var q=[],r=[],s='',t='';p.forEach(function(y,z){if(y.isType('text')){s+=y.getText();t=t==null?null:t+y.getText();}else{var aa=s.match(/\"/g);if(aa&&aa.length%2)s=s.replace(/\s+$/,'')+'"';if(s.length){Array.prototype.push.apply(q,this.tokenize(s));r.push(s);s='';}q.push(y.toStruct());r.push({uid:String(y.getUID()),type:this._getFBObjectType(y.getTypePart(1)),text:y.getText()});t=null;}},this);var u=false,v=s;if(s.length){if(s[s.length-1]=='\'')s=s.substr(0,s.length-1);if(s.length>0&&s[0]==='@'){u=true;v=this._convertToAliasKey(s.substring(1));Array.prototype.push.call(q,v);}else{v=this._convertToAliasKey(s);Array.prototype.push.apply(q,this.tokenize(s));}r.push(s);if(s[s.length-1]==' ')q.push('');}var w=JSON.stringify(r),x=w.replace(/\]$/,'').replace(/\"$/,'');x=x.replace(/\s{2,}/g,' ');return {tokens:q,text_form:w,is_empty:!!w.match(/^\[(\"\s*\")?\]$/),raw_text:t,cache_id:x,is_alias_search:u,potential_alias_term:v};};k.prototype.resetCaches=function(){'use strict';this.resetBootstrapCache();this.resetQueryCache();};k.prototype.resetBootstrapCache=function(){'use strict';this.bootstrapCache={};};k.prototype.resetQueryCache=function(){'use strict';this.queryCache={'':{tokens:[],results:[]}};};k.prototype.setNullState=function(p){'use strict';this.facebarConfig.null_state=p.map(this._extractStructure,this);};k.prototype.addEntryToNullState=function(p){'use strict';if(this.facebarConfig.null_state){var q=this.facebarConfig.entity_cost+p.grammar_costs['{'+p.type+'}'],r=c('FacebarResultStoreUtils').processEntityResult(p.type,p.uid,p.text,q);this.facebarConfig.null_state.unshift(r);}};k.prototype.addRecentEntryToNullState=function(p){'use strict';if(!this.facebarConfig.null_state)return;this.removeDuplicateInNullstateIfAvailable(p);var q=babelHelpers['extends']({},p,{isRecent:true,isNullState:true,type:c('FacebarJSConstants').keywordType,structure:c('FacebarStructuredText').fromString(p.text.toString()),tuid:JSON.stringify({semantic:p.semantic,structure:p.structure}),keyword_type:p.keywordType});if(p.icon_class)q.iconClass=p.icon_class;if(p.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.recent){q.iconClass="_5b1w";delete q.keywordBootstrapType;}if(p.results_set_type)q.resultsSetType=p.results_set_type;q.isInjectedSuggestion=false;this.insertEntryIntoRightPosition(q,true);};k.prototype.addSuggestionEntryToNullState=function(p,q){'use strict';if(!this.facebarConfig.null_state||this.injectedSuggestionCount===j)return;var r=this.removeDuplicateInNullstateIfAvailable(p);switch(q){case c('SearchPivotType').STORY_LIKE_ACTION:this.category=i._("Based on posts you liked");break;case c('SearchPivotType').STORY_COMMENT_ACTION:this.category=i._("Based on posts you commented on");break;default:this.category=i._("Based on posts you interacted with");}var s=babelHelpers['extends']({},p,{isRecent:false,isSuggestion:true,isTrending:false,isNullState:true,type:c('FacebarJSConstants').keywordType,structure:[{text:p.text,type:'keyword'}],tuid:JSON.stringify({semantic:p.semantic,structure:p.text}),isInjectedSuggestion:true,category:this.category});if(!c('FacebarGlobalOptions').hasRecentOnTopNullState)s.null_state_position='top';this.insertEntryIntoRightPosition(s,false);if(!r){c('Arbiter').inform('FacebarTypeahead.injectedSuggestion');++this.injectedSuggestionCount;}};k.prototype.removeDuplicateInNullstateIfAvailable=function(p){'use strict';var q,r=false;if(p.isInjectedSuggestion){q=p.semantic;}else q=decodeURIComponent(p.semantic);for(var s=0;s<this.facebarConfig.null_state.length;s++){var t=this.facebarConfig.null_state[s];if(t.semantic===q){this.facebarConfig.null_state.splice(s,1);r=true;break;}}return r;};k.prototype.clearRecentSearches=function(){'use strict';if(!this.facebarConfig.null_state)return;this.facebarConfig.null_state=this.facebarConfig.null_state.filter(function(p){return !p.isRecent;});};k.prototype.insertEntryIntoRightPosition=function(p,q){'use strict';var r=q?this.facebarConfig.null_state.findIndex(function(t){return t.isRecent;}):this.facebarConfig.null_state.findIndex(function(t){return t.isSuggestion;}),s=q?c('FacebarGlobalOptions').hasRecentOnTopNullState:!c('FacebarGlobalOptions').hasRecentOnTopNullState;if(r<0){if(s){this.facebarConfig.null_state.unshift(p);}else{if(this.facebarConfig.null_state.length>=c('FacebarGlobalOptions').maxResultCount)this.facebarConfig.null_state.shift();this.facebarConfig.null_state.push(p);}return;}this.facebarConfig.null_state.splice(r,0,p);};k.prototype.setSortFunction=function(p){'use strict';this._sortFunction=p;};k.prototype.addBootstrap=function(p){'use strict';var q=this.bootstrapCache;p.forEach(function(r){var s=this.getEntry(r);s.bootstrapped=true;var t=this.tokenize(s.textToIndex,true);if(s.tokens)Array.prototype.push.apply(t,s.tokens.split(' '));Array.prototype.push.apply(t,this.getExtraTokensToIndex(s));t.forEach(function(u){if(!q.hasOwnProperty(u))q[u]={};q[u][r]=true;});},this);};k.prototype._convertToAliasKey=function(p){'use strict';return p.replace(/\./g,'').toLowerCase();};k.prototype.getExtraTokensToIndex=function(p){'use strict';var q=[];if(p.alias!=null){var r=this._convertToAliasKey(p.alias);if(r.length>0)q.push(r);}return q;};k.prototype.addNullStateToQueryCache=function(p,q){'use strict';this.saveResults(this.facebarConfig.null_state,p,true);if(c('FacebarGlobalOptions').includeInitialTypeNamedX)this.saveResults(q,p,true);};k.prototype.extendResult=function(p,q){'use strict';var r=p.cache_id.substr(q.cache_id_length);if((r.indexOf("\"")>=0||q.tokens.length===0)&&!q.isTypeNamedXBootstrap)return null;var s;if(!!q.isTypeNamedXBootstrap){if(p.raw_text!==null){s=q.ext_text+r;}else if(p.tokens.length!==0&&p.tokens[0].text){s=p.tokens[0].text;}else return null;}else if(q.tokens[q.tokens.length-1].length!==0){s=q.ext_text+r;}else s=q.ext_text+" "+r;if(s.length===0)return null;q.ext_node.text=s;q.parse.entTokens=[s];q.parse.suffix="";this._extractStructure(q);if(!this._punctRegexp)this._punctRegexp=new RegExp(c('TokenizeUtil').getPunctuation(),'g');q.semantic=q.ext_semantic.replace('(ext_string)','('+s.replace(this._punctRegexp,"")+')');q.isExtendedResult=true;return q;};k.prototype.getResults=function(p,q){'use strict';if(p.tokens.length===0||p.tokens.length==1&&p.tokens[0]==='')return {results:this.facebarConfig.null_state||[],null_state:true};var r=this._getBestQueryCache(p.cache_id),s=r.results.filter(function(ma){return !ma.isRecent;}),t={},u=this._getBootstrapMatchByType(p,t),v=this._addMatchingBootstrapResults(p,u[0]||{},t);if(c('FacebarGlobalOptions').limitBootstrapResult)v=v.slice(0,c('FacebarGlobalOptions').limitBootstrapResultNum);var w=[],x=[];if(c('FacebarGlobalOptions').hasKeywordBootstrap&&c('FacebarGlobalOptions').useKeywordBootstrapScores){w=v.filter(function(ma){return ma.type===c('FacebarJSConstants').keywordType&&this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);}.bind(this));w.sort(function(ma,na){return na.popularSearchScore-ma.popularSearchScore;});x=v.filter(function(ma){return ma.type!==c('FacebarJSConstants').keywordType;});x.sort(this._sortFunction);v=x.concat(w);}else if(c('FacebarGlobalOptions').hasKeywordBootstrap){w=v.filter(function(ma){return ma.type===c('FacebarJSConstants').keywordType;});var y=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.recent;});if(c('FacebarGlobalOptions').onlyPrefixMatching)y=y.filter(function(ma){return this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);},this);y.sort(function(ma,na){return ma.structure[0].text.length-na.structure[0].text.length;});var z=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.trending&&this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);}.bind(this));z.sort(function(ma,na){return ma.structure[0].text.length-na.structure[0].text.length;});var aa=[];for(var ba=0;ba<z.length;ba++){var ca=z[ba].trendingTopicID;if(!ca)continue;if(aa[ca]){z.splice(ba--,1);}else aa[ca]=ca;}var da=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.serp_first&&this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);},this),ea=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.popular&&this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);},this),fa=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.null_state&&this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]);},this),ga=v.filter(function(ma){return ma.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.awareness&&(!c('FacebarGlobalOptions').searchAwarenessBootstrapJustPrefix||this.unicodeMatch.prefixMatch(ma.structure[0].text,p.tokens[0]));},this),ha=ea.concat(da).concat(fa);ha.sort(function(ma,na){na.popularSearchScore-ma.popularSearchScore;});w=y.concat(ga).concat(z).concat(ha);x=v.filter(function(ma){return ma.type!==c('FacebarJSConstants').keywordType;});x.sort(this._sortFunction);v=x.concat(w);}Array.prototype.push.apply(v,c('concatMap')(this._getResultsFromCache.bind(this,u,p),s));if(!c('FacebarGlobalOptions').hasKeywordBootstrap){v.sort(this._sortFunction);if(!c('FacebarGlobalOptions').graphSearchV2&&c('FacebarGlobalOptions').keywordSearchEnabled)c('FacebarKeywordSearchUtils').addExactMatch(p,v,q);}var ia={},ja=[],ka=false,la=0;v.forEach(function(ma){var na=c('FacebarStructuredText').fromStruct(ma.structure);if(na.hasType('blank')){ja.push(ma);return;}ma.semantic=ma.semantic.toLowerCase();if(!ma.termMatches)ma.termMatches=t[ma.semantic];var oa=n(ma),pa=o(ma);if(!oa)return;var qa=ia[oa]||pa!=null&&ia[pa];if(qa){if(ma.isJSBootstrapMatch){qa.isJSBootstrapMatch=true;qa.bootstrapCost=ma.bootstrapCost;}else if(qa.isJSBootstrapMatch&&ma.backendCost!==undefined&&qa.backendCost===undefined)qa.backendCost=ma.backendCost;if(ma.tags!=null)Object.assign(qa.tags||{},ma.tags);if(c('FacebarGlobalOptions').dedupeLocalResults&&l(ma)&&qa.keyword_type==='keyword')Object.assign(qa,ma);return;}if(ka&&ma.blankFilled)return;if(ma.type.indexOf('browse_type')>=0){la+=1;if(this.facebarConfig.maxGrammarResults!==undefined&&la>this.facebarConfig.maxGrammarResults)return;}ka=ka||!!ma.blankFilled;ia[oa]=ma;if(pa)ia[pa]=ma;ja.push(ma);},this);return {results:ja};};k.prototype.saveResults=function(p,q,r,s,t){'use strict';p=p.map(this._processBackendResult,this);var u=[],v={},w={};p.forEach(function(y){w[y.semantic]=true;});var x=this._getBestQueryCache(q.cache_id);x.results.forEach(function(y){if(y.type==='websuggestion')return;if(y.exactMatchKeyword)return;if(y.isExtendedResult)return;if(y.semantic in v)return;var z=this._getDifferenceArrayTokens(y.tokens,q.tokens),aa=this._getNumTokensMatching(z,y);aa=this._tryMatchingFinalInsertedEntity(z,aa,y);if(aa>0&&aa==z.length||(y.type==="shortcut"&&y.termMatches.indexOf(q.tokens[q.tokens.length-1]))>=0){y.cacheOnlyResult=!w[y.semantic];u.push(y);}},this);if(c('FacebarGlobalOptions').limitCacheResult)u=u.slice(0,c('FacebarGlobalOptions').limitCacheResultNum);p.forEach(function(y){y.tokens=q.tokens;y.cache_id_length=q.cache_id.length;if(!!y.isTypeNamedXBootstrap)++y.cache_id_length;u.push(y);},this);if(t)Array.prototype.push.apply(u,t);if(this.queryCache[q.cache_id]===undefined)this.queryCache[q.cache_id]={};Object.assign(this.queryCache[q.cache_id],{tokens:q.tokens,results:u,incomplete:r},s);};k.prototype.alreadyKnown=function(p){'use strict';return !!this.queryCache[p]&&!this.queryCache[p].incomplete;};k.prototype.stripBrackets=function(p){'use strict';return p.replace(/^[\[\{]/,'').replace(/[\]\}]$/,'');};k.prototype._extractStructure=function(p){'use strict';function q(t,u,v,w,x,y){return {type:t==='ent:extend_string'?'text':t,text:u,uid:v||null,isLocal:w?w:false,categoryName:x?x:null,isPersonSERP:y?y:false};}function r(t,u){t.split(' ').forEach(function(v){if(v!==''){if(u)p.chunks.push(p.structure.length);p.structure.push(q('text',v));}p.structure.push(q('text',' '));});p.structure.pop();}function s(t){if(p.structure.length!==0||c('FacebarJSConstants').nonGrammarTypes[p.type])return t;return t.charAt(0).toUpperCase()+t.substr(1);}p.structure=[];p.chunks=[];p.parse.display.forEach(function(t){if(typeof t==='string'){r(s(t),true);}else if(t.type==='ent:extend_string'){r(t.text,true);}else if(t.uid){var u=this.getEntry(t.uid,t.fetchType);p.chunks.push(p.structure.length);if(u==null)throw new Error('No entry found for uid \"'+t.uid+'\", type \"'+t.fetchType+'\" and piece text \"'+t.text+'\"');if(u.grammar_like){r(s(u.text),false);}else{var v=t.type;if(t.fetchType)v+=':'+t.fetchType;p.structure.push(q(v,u.text,t.uid,p.isLocal,p.categoryName,p.isPersonSERP));}}else if(t.type=='blank'){p.chunks.push(p.structure.length);p.structure.push(q(t.type,'...'));}},this);return p;};k.prototype._getDifferenceArrayTokens=function(p,q){'use strict';if(!p.length)return [''].concat(q);var r=p.length-1,s=p[r];if(s==='')s=p[--r];var t='';if(typeof s=='string'&&r<q.length)t=q[r].substr(s.length);if(t===''&&r+1<q.length&&q[r+1]==='')return [''];return [t].concat(q.slice(r+1));};k.prototype._processBackendResult=function(p){'use strict';if(p.isTypeNamedXBootstrap&&p.cache_id_length)return p;if(p.semantic==null)throw new Error('Facebar can\'t process empty semantic '+JSON.stringify(p));p.semantic=p.semantic.toString();p.backendCost=p.cost;this._extractStructure(p);if(p.type.match(/^\{.*\}$/))p.useExtendedIndex=true;if(p.alternateSemantic)p.alternateSemantic=p.alternateSemantic.toLowerCase().replace(/\[(\d*)\]/g,'$1');if(p.parse.extendable){var q=null;p.parse.display.forEach(function(w){if(w.type!=="ent:extend_string")return;q=w;},this);if(!q||p.semantic.match(/\[.*\]/).length!==1){p.parse.extendable=false;}else{p.ext_node=q;p.ext_semantic=p.semantic.replace(/\[(.*)\]/g,'ext_string');p.ext_text=q.text;}}if(p.semantic.match(/\[\d*\]/)){var r=p.parse,s=r.pos;if(s===undefined){p.semantic=p.semantic.replace(/\[(\d*)\]/g,'$1');}else{var t=r.remTokens[r.remTokens.length-1];if(r.remTokens.length&&p.structure[p.chunks[t]]&&p.structure[p.chunks[t]].uid){s=r.remTokens[r.remTokens.length-1];p.completed=true;}var u=p.structure[p.chunks[s]].uid;if(u===null){p.semantic=p.semantic.replace(/\[(\d*)\]/g,'$1');}else{var v=new RegExp('\\['+u+'\\]','g');p.unsubstituted_semantic=p.semantic;p.semantic=p.semantic.replace(v,u);if(r&&r.disambiguation&&r.disambiguation.length>0){r.disambiguation=r.disambiguation.filter(function(w){return w.indexOf('['+u+']')!==-1;});r.unsubstituted_disambiguation=r.disambiguation.splice(0);r.disambiguation=r.disambiguation.map(function(w){return w.replace(v,u);});}}}}p.semantic=p.semantic.replace(/\[(.*)\]/g,'$1');p.tuid=JSON.stringify({semantic:p.semantic,structure:p.structure});return p;};k.prototype._sortFunction=function(p,q){'use strict';return (p.cost||0)-(q.cost||0);};k.prototype._getResultsFromCache=function(p,q,r){'use strict';var s=q.tokens,t=this._getDifferenceArrayTokens(r.tokens,s),u=[],v=this._getNumTokensMatching(t,r),w=this._tryMatchingFinalInsertedEntity(t,v,r);if(r.parse.extendable||r.isExtendedResult){var x=this.extendResult(q,r);if(x)u.push(x);if(r.isExtendedResult)return u;}if(w>0&&w==t.length&&!(r.type===c('KeywordsSearchResultConfig').result_type&&t.length===1&&t[0]==='"'))u.push(r);if(r.type==="shortcut"&&r.termMatches.indexOf(q.tokens[s-1])>=0)u.push(r);return u;};k.prototype._addMatchingBootstrapResults=function(p,q,r){'use strict';var s=p.tokens;return c('concatMap')(function(t){var u=q[t];if(u===undefined)return [];var v=[],w=c('FacebarResultStoreUtils').getQueryFeatures(p);u.forEach(function(x){var y=this.getEntry(x,t);if(p.is_alias_search){if(!this._isAliasMatch(p,y,false))return;}else if(!this._isTitleTermMatch(s,y)&&!this._isAliasMatch(p,y,false))return;var z=this._isExactNameMatch(s,y)||this._isAliasMatch(p,y,true),aa=z?0:this.facebarConfig.non_title_term_match_penalty,ba=this._isNonGrammarTermMatch(s,y),ca=y.grammar_costs?y.grammar_costs['{'+t+'}']:0,da=ca+aa+this.facebarConfig.entity_cost+this.facebarConfig.grammar_stop_words_penalty*!ba,ea=c('FacebarResultStoreUtils').processEntityResult(t,x,y.text,da,p,w,r,z,!ba);ea.bootstrapCost=da;ea.isJSBootstrapMatch=true;if(t===c('FacebarJSConstants').keywordType){ea.iconClass=y.iconClass;ea.keywordBootstrapType=y.keywordBootstrapType;ea.parse=y.parse;ea.subtext=y.subtext;ea.boldedSubtext=y.boldedSubtext;ea.semantic=y.semantic;ea.popularSearchScore=y.popularSearchScore;ea.trendingTopicID=y.trendingTopicID;ea.photo=y.photo;ea.keyword_type=y.keyword_type;ea.keywordSource=y.keywordSource;}v.push(ea);},this);return v;}.bind(this),this.facebarConfig.bootstrap_types);};k.prototype._isTitleTermMatch=function(p,q){'use strict';var r=p[0]||{};if(typeof r=='object')return false;var s=q.titleToIndex;return p.length===1?this._isTokenizePrefixMatch(r,s):c('TokenizeUtil').isExactMatch(r,s);};k.prototype._isExactNameMatch=function(p,q){'use strict';var r=p[0]||{};if(typeof r=='object')return false;var s=q.text;for(var t=0;t<p.length-1;++t)if(p[t]!==''&&!c('TokenizeUtil').isExactMatch(p[t],s))return false;return p.length>0&&this._isTokenizePrefixMatch(p[p.length-1],s);};k.prototype._isAliasMatch=function(p,q,r){'use strict';if(q.alias==null||p.potential_alias_term==null)return false;var s=this._convertToAliasKey(q.alias);if(r||!p.is_alias_search){return c('TokenizeUtil').isExactMatch(p.potential_alias_term,s);}else return c('TokenizeUtil').isPrefixMatch(p.potential_alias_term,s);};k.prototype._isNonGrammarTermMatch=function(p,q){'use strict';var r=c('TokenizeUtil').parse(q.titleToIndex.toLowerCase()),s=r.tokens.filter(function(v){return v!==''&&!this.facebarConfig.grammar_stop_words[v];},this);s=s.join(' ');for(var t=0;t<p.length;++t){if(typeof p[t]=='object')return true;var u=t===p.length-1?this._isTokenizePrefixMatch(p[t],s):c('TokenizeUtil').isQueryMatch(p[t],s);if(u)return true;}return false;};k.prototype._getBootstrapMatchByType=function(p,q){'use strict';var r=p.tokens.slice();if(r.length===0)return [];var s=r.map(function(){return {};}),t=r[r.length-1]==='',u={},v,w=t?r.length-1:r.length,x=r[w-1];if(w&&x.uid){this._pushBootstrapEntryAtPosition(s,w-1,x.uid,p.is_alias_search);return s;}for(var y in this.bootstrapCache)if(w&&this.unicodeMatch.prefixMatch(y,x)&&(!t||y===x))for(v in this.bootstrapCache[y]){this._addMatchedTerm(v,y,q);if(!u[v]){u[v]=1;this._pushBootstrapEntryAtPosition(s,w-1,v,p.is_alias_search);}}for(var z=w-2;z>=0;z--){if(typeof r[z]=='object')break;if(r[z].length&&r[z][0]=='"')break;for(v in this.bootstrapCache[r[z]]){if(!u[v])u[v]=0;if(u[v]+z==w-1){++u[v];this._addMatchedTerm(v,r[z],q);this._pushBootstrapEntryAtPosition(s,z,v,p.is_alias_search);}}}if(!p.is_alias_search&&p.potential_alias_term)for(v in this.bootstrapCache[p.potential_alias_term]){this._addMatchedTerm(v,p.potential_alias_term,q);if(!u[v]){u[v]=1;this._pushBootstrapEntryAtPosition(s,0,v,p.is_alias_search);}}return s;};k.prototype._addMatchedTerm=function(p,q,r){'use strict';(r[p]=r[p]||[]).push(q);return r;};k.prototype._pushBootstrapEntryAtPosition=function(p,q,r,s){'use strict';var t=this.getEntry(r);if(!t)return;var u=[];if(t.grammar_costs){u=Object.keys(t.grammar_costs).map(function(x){return this.stripBrackets(x);},this);}else u=[t.type];for(var v=0;v<u.length;v++){var w=u[v];if(s&&w!=='user'&&w!=='page')continue;if(p[q][w]===undefined)p[q][w]=[];p[q][w].push(r);}};k.prototype._getNumTokensMatching=function(p,q){'use strict';var r=0,s=q.parse,t=p.length,u=null,v=null;if(s.pos!==undefined){var w=q.structure[q.chunks[s.pos]];if(w){u=w.uid;v=w.type.split(':')[2];}}q.outputTokensUsed=[];q.termMatches=[];if(u){r=this._prefixMatchEntity(p,s,u,q.outputTokensUsed,v,!!q.useExtendedIndex,q.termMatches);if(r===0||r===t)return r;}else if(s.suffix&&t==1&&s.suffix.indexOf(p[0])===0){return t;}else if(s.suffix==p[0]){++r;}else return 0;var x=[];s.remTokens=s.remTokens||[];for(var y=0;y<s.remTokens.length;y++){if(typeof p[r]!='string'||q.chunks.length<=s.remTokens[y]||q.structure.length<=q.chunks[s.remTokens[y]]||q.structure[q.chunks[s.remTokens[y]]].uid)break;var z=q.structure[q.chunks[s.remTokens[y]]].text;x.push(z.toLowerCase());}r=this._greedyMatchText(x,p,r,s.remTokens,q.outputTokensUsed,q.isNullState);if(r==t-1&&p[r]==='')return t;return r;};k.prototype._prefixMatchEntity=function(p,q,r,s,t,u,v){'use strict';q.entTokens=q.entTokens||[];if(q.entTokens.length===0){if(p[0]!=='')return 0;if(q.possessive&&p.length>1&&p[1]=='\'s'){s.push([q.pos+1]);return 2;}else return 1;}var w=false,x=this.getEntry(r,t);if(typeof t!=='undefined'&&t!==x.fetchType)return 0;var y=this.tokenize(u?x.textToIndex:x.text,true),z=[];for(var aa=0;aa<p.length+q.entTokens.length-1;aa++)if(aa<q.entTokens.length-1){z.push(q.entTokens[aa]);}else if(aa==q.entTokens.length-1){z.push(q.entTokens[aa]+p[0]);}else z.push(p[aa-q.entTokens.length+1]);var ba=-q.entTokens.length+1;for(var ca=0;ca<z.length;++ca){var da=z[ca];if(typeof da!='string')break;if(da===''){ba++;continue;}var ea=false;for(var fa=0;fa<y.length;fa++)if(y[fa]==da||ca===z.length-1&&y[fa].indexOf(da)===0){if(v)v.push(y[fa]);y[fa]='';ea=true;++ba;break;}if(ea)continue;if(!q.possessive||da.length<=2||da.substr(da.length-2)!='\'s')break;var ga=da.substr(0,da.length-2);for(fa=0;fa<y.length;fa++)if(y[fa]==ga){++ba;if(s)w=true;break;}break;}if(ba>0){if(w)s.push([q.pos+1]);return ba;}if(s===undefined)return 0;var ha=p[0],ia=ha;if(q.possessive&&ha.length>=2&&ha.substr(ha.length-2)=='\'s')ia=ha.substr(0,ha.length-2);q.suffix=q.suffix||'';if(p.length==1&&q.suffix.indexOf(ha)===0||q.suffix==ia||q.suffix==ha){if(ia!=ha&&q.suffix==ia)s.push([q.pos+1]);return 1;}return 0;};k.prototype._tryMatchingFinalInsertedEntity=function(p,q,r){'use strict';if(!r.completed||q<0)return q;var s=r.parse,t=s.remTokens[s.remTokens.length-1],u=r.structure[r.chunks[t]],v=this.getEntry(u.uid,u.type),w=this.tokenize(v.text,true);q=this._greedyMatchText(w,p,q);if(q==p.length-1&&p[q]==='')return p.length;return q;};k.prototype._greedyMatchText=function(p,q,r,s,t,u){'use strict';for(var v=0;v<p.length;v++){var w=p[v];if(w==q[r]){if(t!==undefined)t.push(s[v]);++r;continue;}if(r===q.length-1&&w.indexOf(q[r])===0){if(t!==undefined)if(w==q[r]){t.push([s[v]]);}else t.push([s[v],q[r].length]);return q.length;}if(u)break;}return r;};k.prototype._getBestQueryCache=function(p){'use strict';for(var q=p.length;q>=0;q--){var r=this.queryCache[p.slice(0,q)];if(r)return r;}};k.prototype._getFBObjectType=function(p){'use strict';if(this.typeaheadTypeMap[p]){return this.typeaheadTypeMap[p];}else return 'page';};k.prototype._isTokenizePrefixMatch=function(p,q){'use strict';return c('TokenizeUtil').isPrefixMatch(this.unicodeMatch.prefixMatchPrepare(p),this.unicodeMatch.prefixMatchPrepare(q));};k.EPSILON=1e-05;k.getUniqueSemantic=function(p){if(!p)return;var q=[],r=[],s=[];p='('+p+')';var t=p,u=false;p.replace(/[\(\),]/g,function(v,w){var x;switch(v){case ',':var y=s.length-1;x=t.substr(s[y],w-s[y]);q[y].push(x);s[y]=w+1;break;case '(':s.push(w+1);q.push([]);r.push(w+1);break;case ')':if(s.length===0)throw p+' is not a valid semantic string';var z=s.pop();x=t.substr(z,w-z);x=decodeURI(x.replace(/%/g,'%25').replace(/\s/g,'+').trim());var aa=q.pop();aa.push(x);var ba=aa.sort();for(var ca=1;ca<ba.length;ca++)if(ba[ca]==ba[ca-1])u=true;var da=ba.join(',');t=t.substr(0,r.pop())+da+t.substr(w);break;}return v;});if(u)return '';return t.replace(/\((.*)\)/,'$1');};var l=function(p){return p.keyword_type==='local'&&p.semantic.match(/[0-9]+\/local/)!=null;},m=function(p){if(!c('FacebarGlobalOptions').dedupeLocalResults||!l(p))return null;var q=encodeURIComponent(p.name.replace(/\s+/g,'+'));return 'str/'+q+'/keywords_search';},n=function(p){var q=m(p),r=q!=null?q:k.getUniqueSemantic(p.semantic);if(c('FacebarGlobalOptions').hasKeywordOnlyTypeahead&&p.semantic.match(/^[0-9]+$/)!=null)r=p.structure.toString().toLowerCase();return r!=null?r.toLowerCase():null;},o=function(p){var q=m(p),r=q!=null?q:k.getUniqueSemantic(p.alternateSemantic);if(c('FacebarGlobalOptions').hasKeywordOnlyTypeahead&&p.semantic.match(/^[0-9]+$/)!=null)r=p.structure.toString().toLowerCase();return r!=null?r.toLowerCase():null;};f.exports=k;},null);
__d("FacebarTimerUtils",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={getTimestamp:function(){return Date.now();}};f.exports=h;},null);
__d("FacebarTokenizer",["TokenizeUtil"],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h="[^\"]",i=["\\s's","'s","\""+h+"*\"?"],j=[[/\s+$/,''],[/\"\s+/,'"'],[/\s+\"/,'"'],[/\"\"/,''],[/^\"$/,''],[/\s+/,' ']],k={tokenize:function(l,m){var n=[],o=0;l=l.replace(/\s/g,' ').toLowerCase();l.replace(new RegExp(i.join('|'),'g'),function(q,r){if(r>o){var s=l.substr(o,r-o);Array.prototype.push.apply(n,c("TokenizeUtil").parse(s).tokens.slice(0));}var t=q;for(var u=0;u<j.length;u++){var v=j[u];t=t.replace(v[0],v[1]);}if(n.length&&t=='\'s'){n[n.length-1]+=t;}else if(t!=='')n.push(t);if(m)Array.prototype.push.apply(n,c("TokenizeUtil").parse(q).tokens);o=r+q.length;});if(o<l.length){var p=l.substr(o,l.length-o);Array.prototype.push.apply(n,c("TokenizeUtil").parse(p).tokens.slice(0));}return n;}};f.exports=k;},null);
__d('FacebarTypeaheadL2Terms',['FacebarJSConstants'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=3,i={addL2Terms:function(j,k,l,m){if(!m.suggestBackendL2Terms)return j;var n=[],o=[];j.forEach(function(q){if(q.exactMatchKeyword){q.tags.l2_suggestion=true;n.push(q);}else if(q.isKeywordL2){q.tags.l2_suggestion=true;q.type='l2suggestion';n.push(q);}else if(q.type!=='keywords')o.push(q);});var p=0;return o.map(function(q){if(c('FacebarJSConstants').entityTypes[q.type])if(p<h){p++;}else if(n.length)return n.pop();return q;});}};f.exports=i;},null);
__d('FacebarTypeaheadTypeNamedX',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={browse_type_user:'user',browse_type_page:'page',browse_type_place:'place',browse_type_group:'group',browse_type_application:'app'},i=1,j=2;k.addTypeNamedX=function(l,m,n,o){'use strict';var p=new k(),q=[],r=[];l.forEach(function(w){if(w.tags!=null)delete w.tags.hiddenSeeMore;if(w.isSeeMore){q.push(w);}else r.push(w);});if(!o.showTypeNamedX){q.forEach(function(w){if(w.tags!=null)w.tags.hiddenSeeMore=true;});return r;}var s=p.buildTypeNamedXBuckets(r,q,n,o),t=s[0],u=s[1];t.forEach(function(w){if(w.tags!=null)w.tags.displayedSeeMore=true;});var v=p.replaceResults(r,m,t);Array.prototype.push.apply(v,u);v.forEach(function(w){if(w.tags!=null)w.tags.hiddenSeeMore=true;});return r;};k.prototype.buildTypeNamedXBuckets=function(l,m,n,o){'use strict';var p={};o=o||{};l.forEach(function(t,u){var v=t.render_type||t.type;if(p[v]===undefined)p[v]={index:u,matchCount:0};if(!o.alwaysDisplayTypeNamedX&&t.text.toLowerCase().indexOf(n.toLowerCase())<0)return;p[v].matchCount++;});var q=[],r=[];m.forEach(function(t){var u=h[t.results_set_type];if(p[u]!==undefined&&p[u].matchCount>=i){q.push([t,p[u].index]);}else r.push(t);});q.sort(function(t,u){return t[1]-u[1];});var s=q.map(function(t){return t[0];});Array.prototype.push.apply(r,s.slice(j));s.length=Math.min(s.length,j);return [s,r];};k.prototype.replaceResults=function(l,m,n){'use strict';var o=[],p=Math.min(0,l.length-m)+n.length;for(var q=0;q<p;++q){var r=-1;for(var s=0;s<Math.min(m-q,l.length);++s){var t=l[s];if(!t.exactMatchKeyword&&t.type!=='websuggestion')r=s;}if(r>=0){o.push(l[r]);l.splice(r,1);}}Array.prototype.unshift.apply(l,n);return o;};function k(){'use strict';}f.exports=k;},null);
__d('ResultsBucketizer',['FacebarJSConstants','FacebarGlobalOptions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){'use strict';this.$ResultsBucketizer1=i;this.$ResultsBucketizer2=j;}h.trimResults=function(i,j,k){'use strict';var l=[];i.forEach(function(m,n){if(m.indexBeforeBuckets>j)l.push({index:n,originalIndex:m.indexBeforeBuckets});});l.sort(function(m,n){return m.originalIndex-n.originalIndex;}).slice(k).sort(function(m,n){return n.index-m.index;}).forEach(function(m){i.splice(m.index,1);});};h.mergeBuckets=function(i,j){'use strict';var k=[];for(var l in j)if(!j[l].rule.hidden&&(!j[l].rule.xor||!j[j[l].rule.xor]))k.push(j[l]);k.sort(function(m,n){var o=(m.rule.position||0)-(n.rule.position||0);if(o!==0)return o;return m.results[0].indexBeforeBuckets-n.results[0].indexBeforeBuckets;});i.length=0;k.forEach(function(m,n){if(m.rule.maxPromotions!=null&&n<k.length-1)h.trimResults(m.results,k[n+1].results[0].indexBeforeBuckets,m.rule.maxPromotions);Array.prototype.push.apply(i,m.results);}.bind(this));};h.prototype.$ResultsBucketizer3=function(i,j){'use strict';if(j.propertyName==null)return j.bucketName||'default';var k=this.$ResultsBucketizer2(i,j.propertyName);if(k==null||j.propertyValue!=null&&''+k!==j.propertyValue)return false;return j.bucketName||j.propertyName+'.'+k;};h.prototype.$ResultsBucketizer4=function(i,j,k){'use strict';var l={},m=false;if(c('FacebarGlobalOptions').renderKeywordsFirst){m=true;}else m=i[0]!=null&&i[0].type===c('FacebarJSConstants').keywordType;if(m&&k==null)k=c('FacebarGlobalOptions').default_num_top_results_to_show;i.forEach(function(n,o){j.some(function(p){var q=this.$ResultsBucketizer3(n,p);if(q===false)return false;if(l[q]==null)l[q]={results:[],rule:p};if(m&&q===c('FacebarJSConstants').keywordType&&l[q].results.length>=k)return true;if(!!p.maxResults&&l[q].results.length>=p.maxResults)return true;n.bucketLineage.push({bucketName:q,bucketIndex:l[q].results.length});l[q].results.push(n);return true;}.bind(this));}.bind(this));return l;};h.prototype.$ResultsBucketizer5=function(i,j,k){'use strict';var l=this.$ResultsBucketizer1[j];if(!l)return {};var m=this.$ResultsBucketizer4(i,l,k);for(var n in m){var o=m[n].rule.subBucketRules;if(!!o)this.$ResultsBucketizer5(m[n].results,o,k);}h.mergeBuckets(i,m);return m;};h.prototype.$ResultsBucketizer6=function(i,j,k){'use strict';if(j.length<=k)return j.slice();var l=j.map(function(n){return n.indexBeforeBuckets;}),m=l.sort(function(n,o){return n-o;})[k];if(m==null)return j;return j.filter(function(n){return n.indexBeforeBuckets<m;});};h.prototype.bucketize=function(i,j,k,l){'use strict';i.forEach(function(n,o){n.bucketLineage=[];n.indexBeforeBuckets=o;});k=k||{};Object.assign(k,this.$ResultsBucketizer5(i,'main',l));var m=this.$ResultsBucketizer6(k,i,j);return m;};f.exports=h;},null);
__d('FacebarDataSource',['invariant','Arbiter','AsyncRequest','AsyncResponse','CSRFGuard','FacebarFindPeopleAndPages','FacebarGSv2Echo','FacebarGlobalOptions','FacebarInviteCoworkers','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarNoFlickerResults','FacebarResultStore','FacebarResultStoreUtils','FacebarStructuredText','FacebarTimerUtils','FacebarTokenizer','FacebarTypeNamedXBootstrap','FacebarTypeNamedXTokenOptions','FacebarTypeaheadL2Terms','FacebarTypeaheadTypeNamedX','FacebarURI','ResultsBucketizer','ResultsBucketizerConfig','SearchDataSource','Vector','ViewportBounds','XHRRequest','queryThenMutateDOM','setTimeoutAcrossTransitions','throttle'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=50,l={};i=babelHelpers.inherits(m,c('SearchDataSource'));j=i&&i.prototype;function m(n){'use strict';j.constructor.call(this,n);this._fetched_null_state=null;this._initialQueryData=null;this._curQueryId=-1;this._maxRemoteQueryId=-1;this._single_state=false;this._is_person_serp=false;this._is_local=false;this._categoryName=null;this._waitingQueries=0;this.mixGrammarAndEntity=n.mixGrammarAndEntity!==undefined?n.mixGrammarAndEntity:true;this._num_topresults_to_show=null;this._isInjectedSuggestionFlow=false;this.grammarVersion=n.grammarVersion||'';if(!n.grammarOptions)n.grammarOptions={};this.recordingRoute='banzai_vital';this._maxGrammarResults=n.grammarOptions.maxGrammarResults;this.nullStateEndpoint=n.nullStateEndpoint||'/ajax/browse/null_state.php';this.setNullStateData(n.nullStateData||{},true);this._minQueryLength=n.minQueryLength||-1;this._performShortQuery=n.performShortQuery||false;this._fixProcessLean=n.grammarOptions.fixProcessLean||false;this.hasGSPreload=c('FacebarGlobalOptions').hasGSPreload;this.gsPreloadOptions=c('FacebarGlobalOptions').gsPreloadParams;this.useGloballyCachedKeywords=c('FacebarGlobalOptions').useGloballyCachedKeywords;this.globallyCachedKeywordsTTL=c('FacebarGlobalOptions').globallyCachedKeywordsTTL;this.globallyCachedKeywordsUseCDN=c('FacebarGlobalOptions').globallyCachedKeywordsUseCDN;this.globallyCachedKeywordsUseDT=c('FacebarGlobalOptions').globallyCachedKeywordsUseDT;this.throttleExecuteQuery();this.throttleSendRemoteQuery();this.throttleRenderResults();this.resultStoreOptions=n.grammarOptions||{};this.resultStoreOptions.useNewExactNameMatch=n.grammarOptions.useNewExactNameMatch==="true";this.defaultQuery=null;this._bypassBucketizer=false;this._resultsBucketizer=new (c('ResultsBucketizer'))(c('ResultsBucketizerConfig').rules,function(o,p){switch(p){case 'isSeeMore':return o.isSeeMore;case 'objectType':return o.type;case 'resultSetType':return o.results_set_type;case 'renderType':return o.render_type||o.type;case 'cacheOnlyResult':return o.cacheOnlyResult;case 'closeEntity':return o.bootstrapped||(!!o.tags?o.tags[p]:undefined);default:return !!o.tags?o.tags[p]:undefined;}});this.fetchNullState();this.initWithConfig(c('FacebarGlobalOptions').grammarConfig);c('Arbiter').subscribe('FacebarTypeahead.injectSuggestion',function(o,p){return this.addSearchSuggestionToNullState(p);}.bind(this));}m.prototype.addSearchSuggestionToNullState=function(n){'use strict';if(!n.query)return;var o=c('FacebarKeywordSearchUtils').makeFacebarEntry(n.query);this.resultStore.addSuggestionEntryToNullState(o,n.interaction);this._isInjectedSuggestionFlow=true;this.inform('reloadNullstate',true);this._isInjectedSuggestionFlow=false;};m.prototype.initWithConfig=function(n){'use strict';this.facebarConfig=n;this.createResultStore();this.blockees={};if(this._fetched_null_state){this.setNullState(this._fetched_null_state);this._fetched_null_state=null;}};m.prototype.throttleExecuteQuery=function(){'use strict';var n=c('FacebarGlobalOptions').executeQueryThrottleTime;this.executeQueryThrottled=c('throttle').withBlocking(this.executeQuery,n,this);};m.prototype.throttleSendRemoteQuery=function(){'use strict';var n=c('FacebarGlobalOptions').sendRemoteQueryThrottleTime;if(n===0){this.sendRemoteQueryThrottled=this.sendRemoteQuery;}else if(c('FacebarGlobalOptions').lazyThrottleRemoteQuery){var o=Date.now(),p=c('FacebarGlobalOptions').enableSendRemoteQueryDelay,q=c('FacebarGlobalOptions').sendRemoteQueryDelayTime;this.sendRemoteQueryThrottled=function(){for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];var u=Date.now();if(o+n<u){o=u;if(p){c('setTimeoutAcrossTransitions')(function(){this.sendRemoteQuery.apply(this,s);}.bind(this),q);}else this.sendRemoteQuery.apply(this,s);}}.bind(this);}else this.sendRemoteQueryThrottled=c('throttle').withBlocking(this.sendRemoteQuery,n,this);};m.prototype.throttleRenderResults=function(){'use strict';var n=c('FacebarGlobalOptions').renderThrottleTime;if(n===0){this.renderResultsThrottled=this.renderResults;return;}var o=Date.now();this.renderResultsThrottled=function(p,q,r,s,t,u){var v=Date.now();if(r||o+n<v){o=v;this.renderResults(p,q,r,s,t,u);}}.bind(this);};m.prototype.createResultStore=function(){'use strict';this.facebarConfig.maxGrammarResults=this._maxGrammarResults;this.resultStore=new (c('FacebarResultStore'))(this.facebarConfig,c('FacebarTokenizer').tokenize,this.getEntry.bind(this),this.resultStoreOptions);if(this._fixProcessLean)this._processLean();this.subscribe('setSortFunction',function(n,o){this.resultStore.setSortFunction(o);}.bind(this));};m.prototype.dirty=function(){'use strict';this._nullStateFetched=false;this.resultStore.resetCaches();j.dirty.call(this);};m.prototype.addEntries=function(n){'use strict';this.resultStore.addBootstrap(this.processEntries(n));};m.prototype._processLean=function(){'use strict';if(this._fixProcessLean){if(this._leanPayload&&this.resultStore){var n,o=this._leanPayload.entries;for(var p in o){n=this.getEntry(p);if(!n)continue;for(var q in o[p]){if(!n.grammar_costs)n.grammar_costs={};n.grammar_costs['{'+q+'}']=o[p][q];}}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null;}}else j._processLean.call(this);};m.prototype.setNullStateData=function(n,o){'use strict';if(o)this.nullStateData={grammar_version:this.grammarVersion};Object.assign(this.nullStateData,n);return this;};m.prototype.setNullState=function(n){'use strict';this._null_state=n;this.processEntries(this._null_state.entities);this.resultStore.setNullState(this._null_state.queries);var o=c('FacebarTypeNamedXBootstrap').typeNamedX;o.forEach(function(p){p.parse.extendable=true;p.qid=this._curQueryId;p.isTypeNamedXBootstrap=true;},this);this.resultStore.addNullStateToQueryCache(this.getRawStructure(c('FacebarStructuredText').fromString('')),o);this._typeNamedXResults={};o.forEach(function(p){this._typeNamedXResults[c('FacebarJSConstants').grammarToEntityTypes[p.resultsSetType]]=p;},this);};m.prototype.getNullStateTrending=function(){'use strict';return this._null_state.trending;};m.prototype.setSingleState=function(n){'use strict';this._single_state=n;};m.prototype.getSingleState=function(){'use strict';return this._single_state;};m.prototype.setIsPersonSERP=function(n){'use strict';this._is_person_serp=n;};m.prototype.setLocal=function(n){'use strict';this._is_local=n;};m.prototype.setCategoryName=function(n){'use strict';this._categoryName=n;};m.prototype.overrideNullState=function(n){'use strict';!(this._null_state!=null)?h(0):void 0;this._original_null_state=this._original_null_state||this._null_state;this.setNullState(n);};m.prototype.restoreNullState=function(){'use strict';if(this._original_null_state)this.setNullState(this._original_null_state);};m.prototype.fetchNullState=function(){'use strict';if(this._nullStateFetched){this.activityStart();setTimeout(this.activityEnd.bind(this),0);return;}var n=new (c('AsyncRequest'))().setURI(this.nullStateEndpoint).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(o){if(this.resultStore){this.setNullState(o.payload);this.inform('nullstateReady',true);}else this._fetched_null_state=o.payload;this._nullStateFetched=true;}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();n.send();};m.prototype.fetchNUXResults=function(n){'use strict';if(!c('FacebarGlobalOptions').allowGrammar)return;n=n||{};var o=new (c('AsyncRequest'))().setURI(n.URI).setData(this.nullStateData).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(p){if(this.resultStore){this.overrideNullState(p.payload);n.success&&n.success();}}.bind(this)).setFinallyHandler(this.activityEnd.bind(this));this.activityStart();o.send();};m.prototype.toTypeaheadEntryUid=function(n,o){'use strict';var p,q=c('FacebarStructuredText').fromStruct(o.structure),r=q.getFragment(0);if(q.getCount()==1&&r.isType('ent')){var s=r.getType().split(':')[2];p=this.getEntry(r.getUID(),s);p.type=this.resultStore.stripBrackets(o.type);}else{p=this.getEntry(o.tuid);if(!p){p={dynamic_cost:o.dynamic_cost,extra_uri_params:o.extra_uri_params,memcache:o.fromMemcache,photo:o.photo,results_set_type:o.resultsSetType,tuid:o.tuid,type:o.type,uid:o.tuid,tags:o.tags};this.processEntries([p]);p=this.getEntry(o.tuid);}p.icon_class=o.iconClass;p.unseen_posts=o.unseen_posts;if(c('FacebarGlobalOptions').renderKeywordSnippets){p.category=o.category;p.subtext=o.subtext;p.boldedSubtext=o.boldedSubtext;}}p.error_info=o.errorInfo;p.logInfo=o.logInfo;p.structure=q;p.text=p.structure.toString();p.queryTypeText=o.queryTypeText;p.semantic=!!o.isSingleState&&o.singleStateSemantic?o.singleStateSemantic:o.semantic;p.alternateSemantic=o.alternateSemantic;p.tree=o.tree;p.cost=o.cost;p.isSeeMore=!!o.isSeeMore;p.isNullState=!!o.isNullState;p.isSingleState=!!o.isSingleState;p.keywordSource=o.keywordSource;p.keyword=o.keyword;var t=o.keyword_type;p.keywordType=t;p.isTrending=!!o.isTrending||o.keywordBootstrapType===c('FacebarJSConstants').keywordBootstrapTypes.trending||t===c('FacebarJSConstants').keywordTypes.trending;p.isCelebrity=t===c('FacebarJSConstants').keywordTypes.celebrity;p.isFootball=t===c('FacebarJSConstants').keywordTypes.football;p.isPhotos=t===c('FacebarJSConstants').keywordTypes.photos;p.isVideos=t===c('FacebarJSConstants').keywordTypes.videos;p.isHashtag=t===c('FacebarJSConstants').keywordTypes.hashtag;p.isLocal=t===c('FacebarJSConstants').keywordTypes.local||t===c('FacebarJSConstants').keywordTypes.local_category;p.isCompany=t===c('FacebarJSConstants').keywordTypes.company;p.isMovie=t===c('FacebarJSConstants').keywordTypes.movie;p.isHappeningNow=t===c('FacebarJSConstants').keywordTypes.happeningNow;p.isSpecialIntentGeneric=t===c('FacebarJSConstants').keywordTypes.specialIntentGeneric;p.isLink=t===c('FacebarJSConstants').keywordTypes.link;c('FacebarJSConstants').intentKeys.map(function(u){p.isSpecialIntent=p.isSpecialIntent||p[u];});p.isRecent=!!o.isRecent;p.isPrefetched=!!o.isPrefetched;p.isSuggestion=!!o.isSuggestion;p.isInjectedSuggestion=!!o.isInjectedSuggestion;p.isFromGSEF=!!o.isFromGSEF;p.isGloballyCachedKeyword=!!o.isGloballyCachedKeyword;p.entityInfo=o.entityInfo;p.cacheOnlyResult=o.cacheOnlyResult||false;p.isExtendedResult=o.isExtendedResult||false;if(o.isExtendedResult){p.uri=c('FacebarURI').getURI(this.facebarConfig,p);}else p.uri=p.uri||c('FacebarURI').getURI(this.facebarConfig,p);p.parse=o.parse;p.tags=o.tags||{};p.isKeywordL2=o.isKeywordL2||false;p.exactMatchKeyword=o.exactMatchKeyword||false;p.qid=o.qid;p.templateID=o.templateID;if(o.isJSBootstrapMatch){p.isJSBootstrapMatch=o.isJSBootstrapMatch;p.backendCost=o.backendCost;p.bootstrapCost=o.bootstrapCost;p.keywordBootstrapType=o.keywordBootstrapType;}this._replaceCategoryWithTermMatches(n,p,o);return p.tuid;};m.prototype._replaceCategoryWithTermMatches=function(n,o,p){'use strict';if(o.type!=='user'&&o.type!=='page')return;if(!o.term_to_subtitle||!p.termMatches)return;var q=o.alias,r=q==null?'':this.resultStore._convertToAliasKey(q),s=[];p.termMatches.forEach(function(u){var v=o.term_to_subtitle[u];if(!n.is_alias_search&&u===r&&u!==n.potential_alias_term)v=null;if(v)s.push(v);},this);if(o.category===undefined)o.category="";if(o.original_category!==undefined)o.category=o.original_category;if(!s||s.length===0)return;if(o.original_category===undefined)o.original_category=o.category;if(!o.original_category)return;var t=o.original_category.length>0?o.original_category.split(' \xB7 '):[];t.unshift.apply(t,s);t=t.filter(function(u,v,w){return v==w.indexOf(u);});o.category=t.splice(0,2).join(" \xB7 ");};m.prototype.getRawStructure=function(n){'use strict';if(typeof n=='string')n=c('FacebarStructuredText').fromString(n);if(this.resultStore)return this.resultStore.transformStructured(n.toArray());};m.prototype.saveResult=function(n){'use strict';this._initialQueryData=this.getUID(n.uid,n.fetchType);};m.prototype.isDefaultKeywordQuery=function(n){'use strict';return n.type===c('FacebarJSConstants').keywordType&&c('FacebarResultStoreUtils').getTextFromResult(n).toLowerCase()===this.value.getHash().trim().toLowerCase();};m.prototype.buildUids=function(n){'use strict';if(!n||!this.resultStore)return [];if(typeof n==='string')n=c('FacebarStructuredText').fromString(n);var o=this.getRawStructure(n),p=this.resultStore.getResults(o,this.getMaxResults()),q=p.results;if(typeof q==='undefined')return [];var r=p.null_state===true,s=0;q=q.filter(function(w,x){if(!c('FacebarGlobalOptions').allowGrammar&&w.type=='grammar')return false;return w.semantic!='<blank>'&&(w.type!='unimplemented'||s++===0);},this);var t=[],u=[],v=[];q.forEach(function(w){if(w.forcedPosition>0){v.push(w);}else if(w.isSeeMore){t.push(w);}else u.push(w);});if(r){q=this.orderNullState(q,c('FacebarGlobalOptions').maxNullstateResultCount?c('FacebarGlobalOptions').maxNullstateResultCount:this.getMaxResults());}else q=u;if(v.length>0){v.sort(function(w,x){return w.forcedPosition-x.forcedPosition;});v.forEach(function(w){q.splice(w.forcedPosition,0,w);});}if(t.length>0)q.push.apply(q,t);return q.map(function(w){return this.toTypeaheadEntryUid(o,w);}.bind(this));};m.prototype.orderNullState=function(n,o){'use strict';var p={top:[],bottom:[],middle:[]},q=function(t){var u=t.null_state_position;return p.hasOwnProperty(u)?u:'middle';},r=function(t,u){return t.original_cost-u.original_cost;};n&&n.forEach(function(t){p[q(t)].push(t);},this);for(var s in p){p[s]=p[s].sort(r).slice(0,o);o-=p[s].length;}return [].concat(p.top,p.middle,p.bottom);};m.prototype.isEntity=function(n){'use strict';if(!n)return false;return (/^\d+$/.test(n));};m.prototype.handleResponse=function(n,o){'use strict';if(!(n.payload.errors)){this.processEntries(n.payload.entities);if(n.payload.blockees)n.payload.blockees.forEach(function(p){if(!this.blockees.hasOwnProperty(p))this.blockees[p.toLocaleLowerCase()]=p;}.bind(this));n.payload.results.forEach(function(p){p.qid=n.queryId;if(!p.parse)p.parse={};p.parse.entTokens=p.parse.entTokens||[];p.parse.remTokens=p.parse.remTokens||[];p.parse.suffix=p.parse.suffix||'';if(this.isEntity(p.semantic))p=this._buildCommonEntityFields(p,o.tokens);}.bind(this));this.saveResults(n,o);}};m.prototype.saveResults=function(n,o){'use strict';var p=[];if(n.payload.seemore&&this._typeNamedXResults)n.payload.seemore.forEach(function(q){p.push(this._typeNamedXResults[q]);},this);if(n.payload.prefetched)this.processPrefetched(n.payload.prefetched);this.resultStore.saveResults(n.payload.results,o,n.payload.incomplete,{},p);};m.prototype.processPrefetched=function(n){'use strict';for(var o in n){var p=c('FacebarStructuredText').fromString(o),q=this.getRawStructure(p),r=n[o];this.processEntries(r.entities);r.results.forEach(function(s){if(this.isEntity(s.semantic))s=this._buildCommonEntityFields(s,q.tokens);}.bind(this));this.resultStore.saveResults(r.results,q,r.incomplete);}};m.prototype.processEntries=function(n){'use strict';return n.map(function(o,p){var q=o.uid=o.uid+'';o.textToIndex=this.getTitleTerms(o);o.titleToIndex=this.getTitleTerms(o);q=this.getUID(q,o.fetchType);var r=this.getEntry(q);if(!r){this.setEntry(q,{});r=this.getEntry(q);}else delete o.photo;Object.assign(r,o);r.tuid=q;r.index===undefined&&(r.index=p);return q;},this);};m.prototype.getUID=function(n,o){'use strict';n=n+'';if(o!==undefined){o=/([^:]+:)?([^:]+)(:.*)?/.exec(o)[2];return JSON.stringify([n,o]);}return n;};m.prototype.getEntry=function(n,o){'use strict';var p;n=''+n;p=o!=null?j.getEntry.call(this,this.getUID(n,o))||j.getEntry.call(this,n):j.getEntry.call(this,n);return p;};m.prototype.getEntryForFragment=function(n){'use strict';return this.getEntry(n.getUID(),n.getTypePart(2));};m.prototype.getMaxResults=function(){'use strict';return this._numResults.max;};m.prototype.query=function(n,o,p){'use strict';this.executeQueryThrottled(n,this._initialQueryData,{keyPress:c('FacebarTimerUtils').getTimestamp()});this._initialQueryData=null;};m.prototype.executeQuery=function(n,o,p){'use strict';this._curQueryId++;p.queryId=this._curQueryId;p.startCacheQuery=c('FacebarTimerUtils').getTimestamp();var q=this.getMaxResults()+c('FacebarTypeNamedXTokenOptions').additionalResultsToFetch;this.setQueryData({qid:this._curQueryId,max_results:q});this.inform('beforeQuery',{value:n,queryId:this._curQueryId});this.value=n;var r=this.buildUids(n,[]);p.endCacheQuery=c('FacebarTimerUtils').getTimestamp();if(o&&r.length===0)r.push(o);if(c('FacebarGlobalOptions').sendExistingIDs){var s=[];r.forEach(function(t){var u=this.getEntry(t);if(u&&u.type in c('FacebarJSConstants').entityTypes)s.push(u.uid);},this);if(s.length>0)this.setQueryData({qid:this._curQueryID,existing_ids:JSON.stringify(s),max_results:q});}this.inform('query',{value:n,results:r,queryId:this._curQueryId});if(this.resultStore)this.respond(n,r,false,false,p);};m.prototype.shouldFetchMore=function(n,o){'use strict';if(!n.is_empty&&c('FacebarGlobalOptions').fetchMoreKeywords){var p=o.filter(function(q){return q.type===c('FacebarJSConstants').keywordType;}).length;if(p<c('FacebarGlobalOptions').default_num_top_results_to_show)return true;}if(n.is_empty)return false;if(this.resultStore.alreadyKnown(n.cache_id))return false;if(n.raw_text&&this._isQueryTooShort(n.raw_text))return false;if(c('FacebarGlobalOptions').alwaysFetchMore)return true;if(o.length<this.getMaxResults()||this._performShortQuery)return true;return this.countValidResults(o)<this.getMaxResults()||this._performShortQuery;};m.prototype.countValidResults=function(n){'use strict';var o=0;n.forEach(function(p){if(p&&!p.isNullState&&!p.isSeeMore)o++;},this);return o;};m.prototype.sendRemoteQuery=function(n,o,p,q,r,s){'use strict';var t=this.getQueryData(n.text_form);if(s){var u=this.globallyCachedKeywordsTTL*60,v=new (c('XHRRequest'))(this.globalKeywordsEndpoint).setData({value:t.value,platform:'desktop',ttl:this.globallyCachedKeywordsTTL,global:this.globallyCachedKeywordsUseCDN,use_dt:this.globallyCachedKeywordsUseDT}).setMethod('GET').setRequestHeader('Cache-Control','max-age='+u).setResponseHandler(function(x,y){y=c('CSRFGuard').clean(y);var z=JSON.parse(y);this.handleQueryResponse(new (c('AsyncResponse'))(null,z),x,n,o,p,q,s);this.activityEnd();}.bind(this,p.queryId)).setErrorHandler(function(x){return this.activityEnd();}.bind(this));this.inform('sending_global_request',v);this._maxRemoteQueryId=p.queryId;p.waitingQueries=this._waitingQueries;p.inflightRequests=c('AsyncRequest').getInflightCount();p.startRemoteQuery=c('FacebarTimerUtils').getTimestamp();v.send();this.activityStart();}else{t.gs_prefetch_mode=q;if(r)t.max_results=r;if(this.globallyCachedKeywordsUseCDN&&!this._single_state){t.log_global_hit=true;t.log_global_ttl=this.globallyCachedKeywordsTTL;t.log_global_platform='desktop';t.log_dt=this.globallyCachedKeywordsUseDT;}var w=new (c('AsyncRequest'))().setURI(this.queryEndpoint).setData(t).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(x,y){this.handleQueryResponse(y,x,n,o,p,q,s);}.bind(this,p.queryId)).setFinallyHandler(function(){this.activityEnd();}.bind(this));this.inform('sending_request',w);this._maxRemoteQueryId=p.queryId;p.waitingQueries=this._waitingQueries;p.inflightRequests=c('AsyncRequest').getInflightCount();p.startRemoteQuery=c('FacebarTimerUtils').getTimestamp();w.send();this.activityStart();}};m.prototype.handleQueryResponse=function(n,o,p,q,r,s,t){'use strict';var u=s||t;if(u&&n.payload.is_user)return;var v=n.payload;n.queryId=o;n.inputQuery=p.text_form;if(v.results!=null)v.results.forEach(function(x){x.isSingleState=this._single_state;x.isFromGSEF=s;x.isGloballyCachedKeyword=t;}.bind(this));r.endRemoteQuery=c('FacebarTimerUtils').getTimestamp();this.inform('response_received',n);this.handleResponse(n,p);var w=[];if(v.abandon_cache)w=v.results.map(function(x){return this.toTypeaheadEntryUid(p,x);}.bind(this));this.respond(q,w,true,v&&(!v.results||v.results.length===0),r,v.num_topresults_to_show,u);this.inform('backend_response',n);if(c('FacebarGlobalOptions').disable_snowballing){this.resultStore.resetQueryCache();this.saveResults(n,p);}};m.prototype.activityStart=function(){'use strict';if(!this._waitingQueries)this.inform('activity',{activity:true},c('Arbiter').BEHAVIOR_STATE);this._waitingQueries++;};m.prototype.activityEnd=function(){'use strict';this._waitingQueries--;if(!this._waitingQueries)this.inform('activity',{activity:false},c('Arbiter').BEHAVIOR_STATE);};m.prototype._bucketizeResults=function(n,o,p){'use strict';o=this._tagKeywordsSuggestions(o);o=c('FacebarTypeaheadL2Terms').addL2Terms(o,this.getMaxResults(),n.toString(),c('FacebarGlobalOptions'));o=c('FacebarTypeaheadTypeNamedX').addTypeNamedX(o,this.getMaxResults(),n.toString(),c('FacebarGlobalOptions'));return this._resultsBucketizer.bucketize(o,k,null,p);};m.prototype._tagKeywordsSuggestions=function(n){'use strict';if(!n||n.length===0)return n;var o=n[0];if(o.bootstrapped)return n;if(o.type==='grammar'||o.cost<c('FacebarGlobalOptions').closeEntityThreshold&&o.type==='user')return n;return n.map(function(p){if(p.type!==c('FacebarJSConstants').keywordType)return p;p=babelHelpers['extends']({},p);p.tags.topBucket=true;return p;});};m.prototype._buildCommonEntityFields=function(n,o){'use strict';if(n.queryTypeText)return n;if(c('FacebarGlobalOptions').unbreakParseDisplay){n.parse.display=[{type:'ent:'+n.type,uid:n.semantic}];}else n.parse.display=[{type:'ent:'+n.type,uid:parseInt(n.semantic,10)}];if(n.parse.fetchType)n.parse.display[0].fetchType=n.parse.fetchType;n.parse.entTokens=o;n.parse.pos=0;n.resultsSetType='{'+n.type+'}';n.queryTypeText=c('FacebarJSConstants').defaultQueryTypeText;return n;};m.prototype.setBypassBucketizer=function(n){'use strict';this._bypassBucketizer=n;};m.prototype.respond=function(n,o,p,q,r,s,t){'use strict';if(p&&this.value){if(typeof this.value==='string')this.value=c('FacebarStructuredText').fromString(this.value);this.inform('remote_query_match',{isMatch:this.value.matches(n),queryId:r?r.queryId:0});n=this.value;if(!o||o.length===0)o=this.buildUids(n);}this.inform('reorderResults',o);this.inform('respondValidUids',o);var u=o.map(this.getEntry,this);u.forEach(function(w,x){w.fromCache=!p;w.isSingleState=this._single_state;},this);if(!p&&(n.getHash().length<512||n.getHash().startsWith('http://')||n.getHash().startsWith('https://'))){var v=this.getRawStructure(n);if(this.shouldFetchMore(v,u)){if(r!=null)r.dispatchRemoteQuery=c('FacebarTimerUtils').getTimestamp();if(this.useGloballyCachedKeywords&&!this._single_state){this.sendRemoteQueryThrottled(v,n,r,false,null,true);this.sendRemoteQueryThrottled(v,n,r);}else if(this.hasGSPreload){this.sendRemoteQueryThrottled(v,n,r,true,this.gsPreloadOptions.max_entities_to_fetch);this.sendRemoteQueryThrottled(v,n,r);}else this.sendRemoteQueryThrottled(v,n,r);}}if(!p||!r||r.queryId===this._maxRemoteQueryId)this.renderResultsThrottled(n,u,p,q,s,t);if(r!=null)this.logLatencies(p,r);};m.prototype.renderResults=function(n,o,p,q,r,s){'use strict';if(r!=null){l[String(n)]=r;}else r=l[String(n)];c('FacebarGSv2Echo').insertInto(n,o,!p,this._single_state,this._is_local,this._categoryName,this._is_person_serp);if(c('FacebarGlobalOptions').graphSearchV2&&c('FacebarGlobalOptions').renderKeywordsFirst&&c('FacebarGlobalOptions').hasFlickerFix&&n!=null&&this._single_state!==true&&!c('FacebarGlobalOptions').hasKeywordOnlyTypeahead)c('FacebarNoFlickerResults').insertInto(n,o,s?false:p,this._waitingQueries!==0);if(!!n&&n instanceof c('FacebarStructuredText')&&!n.isEmptyOrWhitespace()&&!this._bypassBucketizer)o=this._bucketizeResults(n,o,r);o.length=Math.min(o.length,this.getMaxResults());this.injectExtraResults(n,o);q=p&&o.length===0;this.inform('respond',{value:n,results:o,isAsync:!!p,isEmptyResults:q});};m.prototype.injectExtraResults=function(n,o,p){'use strict';c('FacebarFindPeopleAndPages').insertInto(n,o,!p,this._single_state);c('FacebarInviteCoworkers').insertInto(n,o,!p,this._single_state);};m.prototype.logLatencies=function(n,o){'use strict';var p=c('FacebarTimerUtils').getTimestamp();if(n){this.inform('remote_query_latency',{queryId:o.queryId,latencies:{queryStart:Math.max(o.startRemoteQuery-o.dispatchRemoteQuery,0),queryEnd:Math.max(o.endRemoteQuery-o.startRemoteQuery,0),keyPressToQueryDispatch:Math.max(o.dispatchRemoteQuery-o.keyPress,0),keyPressToQueryStart:Math.max(o.startRemoteQuery-o.keyPress,0),keyPressToQueryEnd:Math.max(o.endRemoteQuery-o.keyPress,0),render:Math.max(p-o.endRemoteQuery,0),inflightRequests:o.inflightRequests,waitingQueries:o.waitingQueries,keyPressToRender:Math.max(p-o.keyPress,0)}});}else this.inform('cache_query_latency',{queryId:o.queryId,latencies:{queryStart:Math.max(o.startCacheQuery-o.keyPress,0),queryEnd:Math.max(o.endCacheQuery-o.startCacheQuery,0),keyPressToQueryEnd:Math.max(o.endCacheQuery-o.keyPress,0),render:Math.max(p-o.endCacheQuery,0),keyPressToRender:Math.max(p-o.keyPress,0)}});};m.prototype._updateMaxResults=function(){'use strict';c('queryThenMutateDOM')(function(){var n=c('Vector').getViewportDimensions().y,o=c('ViewportBounds').getTop()||42,p=56,q=48,r=n-o-q-25;this._maxResults=Math.max(this._numResults.min,Math.min(this._numResults.max,Math.floor(r/p)-1));this.value&&this.query(this.value);}.bind(this));};m.prototype.getCurQueryId=function(){'use strict';return this._curQueryId;};m.prototype.setTypenamedXOption=function(n){'use strict';c('FacebarGlobalOptions').showTypeNamedX=n;};m.prototype.setMinQueryLength=function(n){'use strict';this._minQueryLength=n;};m.prototype.setGrammarOption=function(n){'use strict';c('FacebarGlobalOptions').allowGrammar=n;};Object.assign(m.prototype,{events:['query','respond','bootstrapped','activity','ready']});f.exports=m;},null);
__d('FacebarTypeahead',['Arbiter','Typeahead','emptyFunction'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('Typeahead'));i=h&&h.prototype;function j(k,l,m,n,o,p){'use strict';i.constructor.call(this,k,l,m,n);this.getCore();this.proxyEvents();this.initBehaviors(o||[]);var q=this.core.subscribe('focus',function(){if(p)p.init(this);this.core.unsubscribe(q);this.data.bootstrap(false);this.core.input.focus();}.bind(this));this.data.bootstrap(true);this.inform('init',this,c('Arbiter').BEHAVIOR_PERSISTENT);c('Arbiter').inform('Facebar/init',this,c('Arbiter').BEHAVIOR_PERSISTENT);}j.prototype.proxyEvents=function(){'use strict';var k,l=[],m=null,n=function(){while(k=l.shift())this.inform(k[0],k[1]);m=null;}.bind(this);[this.data,this.view,this.core].forEach(function(o){o.subscribe(o.events,function(p,q){l.push([p,q]);m=m||setTimeout(n,0);}.bind(this));},this);};Object.assign(j.prototype,{init:c('emptyFunction')});f.exports=j;},null);
__d('SimpleStructuredInput',['csx','Arbiter','ArbiterMixin','DOM','DataStore','Event','FacebarStructuredText','Input','Parent','getActiveElement','mixin'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function k(l){'use strict';j.constructor.call(this);this.$SimpleStructuredInput1=l;this.$SimpleStructuredInput2=c('DOM').find(l,"._1frb");this.$SimpleStructuredInput3=c('DOM').find(l,"._5eay");c('DataStore').set(l,'SimpleStructuredInput',this);this.init();}k.prototype.init=function(){'use strict';var l=function(event){return this.inform(event.type);}.bind(this);c('Event').listen(this.$SimpleStructuredInput2,'blur',l);c('Event').listen(this.$SimpleStructuredInput2,'focus',l);c('Event').listen(this.$SimpleStructuredInput2,'input',function(){this.inform('change');}.bind(this));this.inform('init',null,c('Arbiter').BEHAVIOR_PERSISTENT);};k.prototype.setHint=function(l){'use strict';var m=l.map(function(o){return o.text;}).join(''),n=c('Input').getValue(this.$SimpleStructuredInput2);if(this.hasFocus()&&n.length>0&&m.toLowerCase().indexOf(n.toLowerCase())===0){c('Input').setValue(this.$SimpleStructuredInput3,n+m.slice(n.length));}else c('Input').setValue(this.$SimpleStructuredInput3,'');};k.prototype.focus=function(){'use strict';this.$SimpleStructuredInput2.focus();};k.prototype.blur=function(){'use strict';this.$SimpleStructuredInput2.blur();this.setHint([]);};k.prototype.hasFocus=function(){'use strict';return c('DOM').contains(this.$SimpleStructuredInput1,c('getActiveElement')());};k.prototype.setStructure=function(l){var m=arguments.length<=1||arguments[1]===undefined?false:arguments[1];'use strict';var n=l.map(function(o){return o.text;});c('Input').setValue(this.$SimpleStructuredInput2,n.join(''));if(m!==true)this.inform('change');};k.prototype.getStructure=function(){'use strict';return c('FacebarStructuredText').fromString(c('Input').getValue(this.$SimpleStructuredInput2)).toStruct();};k.prototype.getSelection=function(){'use strict';return {offset:this.$SimpleStructuredInput2.selectionStart,length:this.$SimpleStructuredInput2.selectionEnd-this.$SimpleStructuredInput2.selectionStart};};k.prototype.setSelection=function(l){'use strict';if(this.hasFocus()){this.$SimpleStructuredInput2.setSelectionRange(l.offset,l.offset+l.length);this.inform('select');}};k.prototype.isSelectionAtEnd=function(){'use strict';var l=this.getSelection().offset,m=c('Input').getValue(this.$SimpleStructuredInput2).length;return l>=m;};k.prototype.selectAll=function(){'use strict';this.setSelection({offset:0,length:c('Input').getValue(this.$SimpleStructuredInput2).length});};k.getInstance=function(l){'use strict';var m=c('Parent').bySelector(l,"._5eaz");if(m==null)throw new Error('No DOMElement structured input found using');return c('DataStore').get(m,'SimpleStructuredInput')||new k(m);};f.exports=k;},null);
__d('StructuredInputDOM',['cx','createArrayFromMixed','CSS','DOM','FacebarGlobalOptions','getElementText','isElementNode','isTextNode'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=function(){return c('FacebarGlobalOptions').graphSearchV2?"_4v1s":"_586o";},j={ENTITY_CLASS:i(),encodeText:function(k){return k.replace(/ /g,'\u00a0');},decodeText:function(k){return k.replace(/\u00a0/g,' ');},createIconNode:function(k){if(k&&typeof k=='object'){var l=c('DOM').create('i',{className:k.className,style:k.uri&&{backgroundImage:'url("'+k.uri+'")'}});l.setAttribute('data-select','ignore');return l;}},createTextNode:function(k){return c('DOM').create('span',{'data-si':true},j.encodeText(k||""));},createEntityNode:function(k,l){var m=j.encodeText(k.text),n=j.createIconNode(l.icon),o=c('DOM').create('span',{},n?[n,m]:m),p=(l.className||'').split(/\s+/);p.push(j.ENTITY_CLASS);p.forEach(c('CSS').addClass.bind(c('CSS'),o));var q={si:true,uid:k.uid,type:k.type,text:m,'is-local':k.isLocal,'category-name':k.categoryName,fulltext:m,group:l.group,select:l.select,icon:JSON.stringify(l.icon||null)};for(var r in q)if(q[r]!=null)o.setAttribute('data-'+r,q[r]);return o;},convertToTextNode:function(k){k.className='';k.setAttribute('data-type','text');k.removeAttribute('data-group');k.removeAttribute('data-select');k.removeAttribute('data-icon');k.removeAttribute('data-uid');k.removeAttribute('data-is-local');k.removeAttribute('data-category-name');for(var l=k.firstChild;l;l=l.nextSibling)if(!c('isTextNode')(l))c('DOM').remove(l);},isEntityNode:function(k){return c('isElementNode')(k)&&c('CSS').hasClass(k,j.ENTITY_CLASS);},containsOnlyText:function(k,l){l=c('createArrayFromMixed')(l);for(var m=k.firstChild;m;m=m.nextSibling)if(!(c('isTextNode')(m)||k.nodeName in l))return false;return true;},getText:function(k){return c('getElementText')(k).replace(/ /g,'\u00a0');},getDecodedText:function(k){return j.decodeText(c('getElementText')(k));},getLength:function(k){return c('getElementText')(k).length;},getMarker:function(k,l,m){var n=k.firstChild;while(n){var o=j.getLength(n);if(o>l||!n.nextSibling){if(c('isTextNode')(n)||!m){return {node:n,offset:Math.min(l,o)};}else return j.getMarker(n,l);}else l-=o;n=n.nextSibling;}}};f.exports=j;},null);
__d('StructuredInputUtil',['StructuredInputDOM'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(n,o,p){var q=n.substr(0,o).lastIndexOf(p);return q!==-1?q+1:0;}function i(n,o,p){var q=n.indexOf(p,o);return q!==-1?q:n.length;}function j(n,o,p){return (o===0||o===n.length||n.substr(o,p.length)==p);}function k(n,o,p,q){switch(o){case 'none':return p;case 'all':return q?n.length:0;case 'word':if(j(n,p,'\u00a0')){return p;}else if(q){return i(n,p,'\u00a0');}else return h(n,p,'\u00a0');}}function l(n,o){return o&&c('StructuredInputDOM').isEntityNode(n)&&!c('StructuredInputDOM').isEntityNode(o);}var m={getMarkerAtOffset:function(n,o){var p=n.firstChild,q=0,r=0;while(p){q+=r;r=c('StructuredInputDOM').getLength(p);if(q+r>o){break;}else p=p.nextSibling;}return {node:p||n.lastChild,offset:o-q};},validateEntityText:function(n){var o=c('StructuredInputDOM').getText(n),p=n.getAttribute('data-fulltext'),q=n.getAttribute('data-group');if(q=='hashtag'){var r=o.match(/#[^\s]+/);p=r&&r[0];}var s=o.indexOf(p),t={prefix:null,entity:null,suffix:null};switch(q){case 'none':t.entity=o;break;case 'hashtag':case 'all':if(s!=-1){t.prefix=o.substr(0,s);t.entity=o.substr(s,p.length);t.suffix=o.substr(s+p.length);}else t.suffix=o;break;case 'word':if(s!=-1){t.prefix=o.substr(0,s);o=o.substr(s);}var u=0,v=0;while(u<p.length){v=i(p,u+1,'\u00a0');if(o.substr(0,v)!=p.substr(0,v)){break;}else u=v;}t.entity=o.substr(0,u)||null;t.suffix=o.substr(u)||null;}return t;},getGrouping:function(n,o){var p=n.getAttribute('data-group'),q=n.getAttribute('data-select');if(o=='select'){return q=='group'?p:'none';}else return p;},snapMarkerToText:function(n,o){var p=n.node;if(c('StructuredInputDOM').isEntityNode(p)){var q=n.offset,r=m.getGrouping(p,o);if(r!='none')if(q===0){var s=p.previousSibling;if(l(p,s))return {node:s,offset:c('StructuredInputDOM').getLength(s)};}else if(q==c('StructuredInputDOM').getLength(p)){var t=p.nextSibling;if(l(p,t))return {node:t,offset:0};}}return n;},nextMarkerBoundary:function(n,o,p){var q=n.node;if(c('StructuredInputDOM').isEntityNode(q)&&(!o||n.offset!==0)){var r=m.getGrouping(q,p);if(r!='none')return {node:n.node,offset:k(c('StructuredInputDOM').getText(q),r,n.offset,o)};}return n;}};f.exports=m;},null);
__d('StructuredInputCleaner',['DOM','StructuredInputDOM','StructuredInputUtil','UserAgent_DEPRECATED','createArrayFromMixed','getElementText','isTextNode'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){'use strict';this._node=i;this._selection=j;this._wrapText=k;}h.prototype._cleanEntityNode=function(i){'use strict';var j=i.getAttribute('data-text'),k=c('StructuredInputDOM').getText(i);i.style.cssText='';if(j==k&&c('StructuredInputDOM').containsOnlyText(i,{I:true}))return null;var l=[],m=c('StructuredInputUtil').validateEntityText(i),n=c('StructuredInputDOM').createIconNode(JSON.parse(i.getAttribute('data-icon')));if(!m.entity&&(m.suffix&&!m.prefix||m.prefix&&!m.suffix)){c('StructuredInputDOM').convertToTextNode(i);i.setAttribute('data-text',k);return null;}if(m.prefix)l.push(this._createTextNode(m.prefix));if(m.entity){if(this._selection&&c('getElementText')(i)!==m.entity)this._selection.markDirty(i);c('DOM').setContent(i,n?[n,m.entity]:m.entity);i.setAttribute('data-text',m.entity);l.push(i);}if(m.suffix)l.push(this._createTextNode(m.suffix));return l;};h.prototype._removeSpecialNodes=function(){'use strict';var i=c('createArrayFromMixed')(this._node.getElementsByTagName('script')),j=c('createArrayFromMixed')(this._node.getElementsByTagName('style'));i.forEach(c('DOM').remove);j.forEach(c('DOM').remove);};h.prototype._collapseNodes=function(){'use strict';for(var i,j=this._node.firstChild;j;j=i){i=j.nextSibling;if(!c('isTextNode')(j)&&!c('StructuredInputDOM').isEntityNode(j)&&!c('StructuredInputDOM').containsOnlyText(j))for(var k=j.lastChild;k;k=j.lastChild){this._node.insertBefore(k,i);i=k;}}};h.prototype._createTextNode=function(i){'use strict';if(this._wrapText){return c('StructuredInputDOM').createTextNode(i);}else return document.createTextNode(i);};h.prototype.replaceNodes=function(i,j){'use strict';if(j==null)return;var k=i.length?i[i.length-1].nextSibling:null;i.forEach(function(l){if(j.indexOf(l)===-1)c('DOM').remove(l);},this);j.reverse().forEach(function(l){if(i.indexOf(l)===-1)this._node.insertBefore(l,k);k=l;},this);};h.prototype.clean=function(){'use strict';this._removeSpecialNodes();this._collapseNodes();var i=[],j=function(){if(i.length){this.replaceNodes(i,this._cleanTextNodes(i));i.length=0;}}.bind(this);Array.from(this._node.childNodes).forEach(function(k){if(c('StructuredInputDOM').isEntityNode(k)){this.replaceNodes([k],this._cleanEntityNode(k));j(i);}else i.push(k);}.bind(this));j();if(!this._node.firstChild&&c('UserAgent_DEPRECATED').firefox())this._node.appendChild(this._createTextNode());};h.prototype.endOnText=function(){'use strict';var i=function(j,k){if(c('StructuredInputDOM').isEntityNode(j))this._node.insertBefore(this._createTextNode(),k?j:null);}.bind(this);i(this._node.firstChild,true);i(this._node.lastChild,false);};Object.assign(h.prototype,{_cleanTextNodes:function(){var i=function(k){return (k.nodeName==='BR'||k.nodeName==='SPAN'&&j(k));},j=function(k){return k.getAttribute('data-si')&&c('StructuredInputDOM').containsOnlyText(k)&&c('StructuredInputDOM').getLength(k)>0;};return function(k){if(k.length!=1||!i(k[0])){var l=k.map(c('StructuredInputDOM').getText).join('').replace(/\s+/g,' ');return l?[this._createTextNode(l)]:[];}else{k[0].style.cssText='';return;}};}()});f.exports=h;},null);
__d("DOMSelection",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();(function(){var h=this,i={isPreceding:function(o,p){return p.compareDocumentPosition(o)&2;},contains:function(o,p){if(o.compareDocumentPosition!=null){return o.compareDocumentPosition(p)&16;}else return o.contains(p);},isCursorPreceding:function(o,p,q,r){if(o===q)return p<=r;if(i.isText(o)&&i.isText(q))return i.isPreceding(o,q);if(i.isText(o)&&!i.isText(q))return !i.isCursorPreceding(q,r,o,p);if(!i.contains(o,q))return i.isPreceding(o,q);if(o.childNodes.length<=p)return false;if(o.childNodes[p]===q)return 0<=r;return i.isPreceding(o.childNodes[p],q);},isText:function(o){return (o!=null?o.nodeType==3:false);},getChildIndex:function(o){var p=0;while(o=o.previousSibling)p++;return p;}},j=h.Selection=(function(){function o(p){this.win=p;}o.prototype.hasSelection=function(){return o.hasSelection(this.win);};o.prototype.isBidirectional=function(){return o.isBidirectional(this.win);};o.prototype.getOrigin=function(){return o.getOrigin(this.win);};o.prototype.getFocus=function(){return o.getFocus(this.win);};o.prototype.getStart=function(){return o.getStart(this.win);};o.prototype.getEnd=function(){return o.getEnd(this.win);};o.prototype.trySelection=function(p,q,r,s){return o.trySelection(this.win,p,q,r,s);};o.prototype.setSelection=function(p,q,r,s){return o.setSelection(this.win,p,q,r,s);};o.prototype.clearSelection=function(){return o.clearSelection(this.win);};return o;})();function k(){if(h.document.selection&&/MSIE 9\./.test(navigator.userAgent)){return false;}else return !!h.getSelection;}if(k()){j.supported=true;j.hasSelection=function(o){var p;return (p=o.getSelection())&&(p.focusNode!=null)&&(p.anchorNode!=null);};j.isBidirectional=function(o){return true;};j.getOrigin=function(o){var p;if(!((p=o.getSelection())&&(p.anchorNode!=null)))return null;return [p.anchorNode,p.anchorOffset];};j.getFocus=function(o){var p;if(!((p=o.getSelection())&&(p.focusNode!=null)))return null;return [p.focusNode,p.focusOffset];};j.getStart=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [p,r];return [q,s];};j.getEnd=function(o){var p,q,r,s,t,u;if(!j.hasSelection(o))return null;t=j.getOrigin(o),p=t[0],r=t[1];u=j.getFocus(o),q=u[0],s=u[1];if(i.isCursorPreceding(p,r,q,s))return [q,s];return [p,r];};var l=function(o,p,q,s,t,u){var v=p.getSelection();if(!v)return;if(t==null)t=q;if(u==null)u=s;if(v.collapse&&v.extend){v.collapse(q,s);v.extend(t,u);}else{r=p.document.createRange();r.setStart(q,s);r.setEnd(t,u);if(o||!j.hasSelection(p)||(r.endContainer===t&&r.endOffset===u&&r.startContainer===q&&r.startOffset===s)){try{v.removeAllRanges();}catch(w){}v.addRange(r);}}};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){try{var q=o.getSelection();if(!q)return;q.removeAllRanges();}catch(p){}};j.getText=function(o){var p=o.getSelection();if(!p)return;return p.toString();};}else if(h.document.selection){var m=function(o,p,q){var r,s,t,u,v;s=o.createElement('a');r=p.duplicate();r.collapse(q);v=r.parentElement();while(true){v.insertBefore(s,s.previousSibling);r.moveToElementText(s);if(!(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)>0&&(s.previousSibling!=null)))break;}if(r.compareEndPoints((q?'StartToStart':'StartToEnd'),p)===-1&&s.nextSibling){r.setEndPoint((q?'EndToStart':'EndToEnd'),p);t=s.nextSibling;u=r.text.length;}else{t=s.parentNode;u=i.getChildIndex(s);}s.parentNode.removeChild(s);return [t,u];},n=function(o,p,q,r,s){var t,u,v,w,x;x=0;t=i.isText(r)?r:r.childNodes[s];u=i.isText(r)?r.parentNode:r;if(i.isText(r))x=s;w=o.createElement('a');u.insertBefore(w,t||null);v=o.body.createTextRange();v.moveToElementText(w);w.parentNode.removeChild(w);p.setEndPoint((q?'StartToStart':'EndToEnd'),v);return p[q?'moveStart':'moveEnd']('character',x);};j.supported=true;j.hasSelection=function(o){var p;if(!o.document.selection)return false;p=o.document.selection.createRange();return p&&p.parentElement().document===o.document;};j.getStart=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,true);};j.getEnd=function(o){var p;if(!j.hasSelection(o))return null;p=o.document.selection.createRange();return m(o.document,p,false);};j.isBidirectional=function(o){return false;};j.getOrigin=function(o){return j.getStart(o);};j.getFocus=function(o){return j.getEnd(o);};var l=function(o,p,q,r,s,t){if(s==null)s=q;if(t==null)t=r;var u=p.document.body.createTextRange();n(p.document,u,false,s,t);n(p.document,u,true,q,r);return u.select();};j.setSelection=l.bind(j,true);j.trySelection=l.bind(j,false);j.clearSelection=function(o){return o.document.selection.empty();};j.getText=function(o){if(!j.hasSelection(o))return null;var p=o.document.selection.createRange();return p&&p.text;};}else j.supported=false;}).call(this);f.exports=Selection;},null);
__d('StructuredInputSelection',['DOM','DOMSelection','Scroll','Vector','StructuredInputUtil','StructuredInputDOM'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(j){'use strict';var k=j.ownerDocument;this.window=k.defaultView||k.parentWindow;this.root=j;this.selection=false;this.start=new i(this,[]);this.end=new i(this,[]);this.update();}h.prototype.isSupported=function(){'use strict';return !!(c('DOMSelection')&&c('DOMSelection').hasSelection);};h.prototype.update=function(){'use strict';this.selection=false;if(this.isSupported()&&this.root==document.activeElement)if(c('DOMSelection').hasSelection(this.window)){var j=c('DOMSelection').getStart(this.window),k=c('DOMSelection').getEnd(this.window),l=c('DOMSelection').getFocus(this.window);this.start=this.makeMarker(j);this.end=this.makeMarker(k);this.backward=j[0]==l[0]&&j[1]==l[1];this.selection=this.start.node&&this.end.node;}};h.prototype.makeMarker=function(j){'use strict';if(j[0]===this.root){return new i(this,[this.root.childNodes[j[1]],0]);}else return new i(this,j);};h.prototype.getFocus=function(){'use strict';return this.backward?this.start:this.end;};h.prototype.getOrigin=function(){'use strict';return this.backward?this.end:this.start;};h.prototype.move=function(j){'use strict';if(this.selection){this.start.move(j);this.start.snap();this.end.setPosition(this.start);return this.apply();}};h.prototype.expand=function(j){'use strict';if(this.selection){if(c('DOMSelection').isBidirectional()){this.start.move(!j);this.start.snap();this.end.move(j);this.end.snap();}return this.apply();}};h.prototype.getText=function(){'use strict';if(this.selection&&this.isSupported()){var j=c('DOMSelection').getText(this.window);return j;}};h.prototype.getOffset=function(){'use strict';if(this.selection)return this.start.rootOffset;};h.prototype.getLength=function(){'use strict';return (this.getText()||"").length;};h.prototype.setPosition=function(j,k){'use strict';this.backward=false;this.selection=true;this.start.setPosition(c('StructuredInputUtil').getMarkerAtOffset(this.root,j));this.start.snap();if(k>0){this.end.setPosition(c('StructuredInputUtil').getMarkerAtOffset(this.root,j+k));this.end.snap();}else this.end.setPosition(this.start);return this.apply();};h.prototype.hasRange=function(){'use strict';return this.selection&&(this.start.node!=this.end.node||this.start.offset!=this.end.offset);};h.prototype.scrollToFocus=function(){'use strict';var j=5,k=this.getFocus();if(k.node){var l=c('Vector').getElementDimensions(this.root).x,m=c('Scroll').getLeft(this.root),n=k.node.offsetLeft+k.node.offsetWidth;if(n-m<j){c('Scroll').setLeft(this.root,n-j);}else if(n-m>l-j)c('Scroll').setLeft(this.root,n-l+j);}};h.prototype.apply=function(){'use strict';if(this.start.hasChanged()||this.end.hasChanged()){var j=this.getOrigin().getMarker(true),k=this.getFocus().getMarker(true);this.selection=this.selection&&j&&j.node&&k&&k.node;if(this.selection&&this.isSupported()){this.start.changed=false;this.end.changed=false;c('DOMSelection').trySelection(this.window,j.node,j.offset,k.node,k.offset);return true;}}};h.prototype.markDirty=function(j){'use strict';if(c('DOM').contains(j,this.start.node,j))this.start.changed=true;if(c('DOM').contains(j,this.end.node,j))this.end.changed=true;};function i(j,k){'use strict';this.selection=j;this.node=k[0];this.offset=k[1];this.rootOffset=this.getRootOffset(k[0],k[1]);this.sibling=this.node&&this.node.previousSibling;this.changed=false;}i.prototype.hasChanged=function(){'use strict';return this.changed||!this.isNodeValid();};i.prototype.isNodeValid=function(){'use strict';if(c('StructuredInputDOM').getLength(this.node)>this.offset){var j=this.node;while(j=j.parentNode)if(j==this.selection.root)return true;}};i.prototype.getMarker=function(j){'use strict';if(this.isNodeValid()&&(j&&!this.node.firstChild||!j&&this.node.parentNode==this.selection.root)){return this;}else return c('StructuredInputDOM').getMarker(this.selection.root,this.rootOffset,j);};i.prototype.move=function(j){'use strict';this.node&&this.setPosition(c('StructuredInputUtil').nextMarkerBoundary(this.getMarker(false),j,'select'));};i.prototype.snap=function(){'use strict';this.node&&this.setPosition(c('StructuredInputUtil').snapMarkerToText(this.getMarker(false),'select'));};i.prototype.setPosition=function(j){'use strict';if(j.offset!=this.offset||j.node!=this.node){this.changed=true;this.node=j.node;this.offset=j.offset;this.rootOffset=this.getRootOffset(this.node,this.offset);}};i.prototype.getRootOffset=function(j,k){'use strict';var l=0,m=5;while(j&&l++<m)if(j===this.selection.root){return k;}else{var n=j;while(n=n.previousSibling)k+=c('StructuredInputDOM').getLength(n);j=j.parentNode;}};f.exports=h;},null);
__d('StructuredInput',['csx','cx','fbt','Arbiter','ArbiterMixin','CSS','DataStore','DOM','Event','Input','InputSelection','JSLogger','Keys','Locale','Parent','Scroll','StructuredInputCleaner','StructuredInputDOM','StructuredInputSelection','StructuredInputUtil','Style','UserAgent_DEPRECATED','createArrayFromMixed','createObjectFrom','emptyFunction','getActiveElement','isElementNode','isTextNode','mixin','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();var m=229,n=c('createObjectFrom')([c('Keys').UP,c('Keys').DOWN,c('Keys').LEFT,c('Keys').RIGHT,c('Keys').HOME,c('Keys').END]),o=c('createObjectFrom')([c('Keys').BACKSPACE,c('Keys').DELETE]),p=c('createObjectFrom')([c('Keys').SPACE,c('Keys').RETURN]),q=c('createObjectFrom')('IUB'.split('').map(function(v){return v.charCodeAt(0);})),r=c('UserAgent_DEPRECATED').firefox(),s=c('UserAgent_DEPRECATED').ie(),t=c('UserAgent_DEPRECATED').webkit();k=babelHelpers.inherits(u,c('mixin')(c('ArbiterMixin')));l=k&&k.prototype;function u(v){'use strict';l.constructor.call(this);c('DataStore').set(v,'StructuredInput',this);this._root=v;this._richInput=c('DOM').find(v,"._586i");this._textInput=c('DOM').find(v,"._586f");this._placeholderText=c('DOM').scry(v,"._586j")[0];this._hintText=c('DOM').find(v,"._586k");this._contentWidth=null;this._richWidth=null;this._hintNodes=[];c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(w,x){x.structuredInputState={initInputsFinished:!!this._initInputsFinished,initEventsFinished:!!this._initEventsFinished,cleanInputPreTogglesFinished:!!this._cleanInputPreTogglesFinished,cleanInputFinished:!!this._cleanInputFinished,elements:{richInput:!!this._richInput,textInput:!!this._textInput,placeholderText:!!this._placeholderText,hintText:!!this._hintText}};}.bind(this));this.init();}u.prototype.init=function(){'use strict';this.init=c('emptyFunction');this._initSelection();this._initCleaner();this._initInputs();this._initInputsFinished=true;this._initEvents();this._initEventsFinished=true;this._scheduledCleanInput=false;this._richChanged=false;this._textChanged=false;this._selectionChanged=false;this._selectionIgnore=false;this._imeMode=false;this.cleanInput();this.inform('init',null,c('Arbiter').BEHAVIOR_PERSISTENT);};u.prototype._initInputs=function(){'use strict';this._richInput.contentEditable=true;this._richInput.spellcheck=false;this._richInput.tabIndex=0;this._richInput.setAttribute('aria-label',j._("Search Facebook"));this._textInput.tabIndex=-1;this._multiline=this._textInput.nodeName=='TEXTAREA';if(!c('CSS').shown(this._richInput)){var v=c('InputSelection').get(this._textInput),w=c('getActiveElement')()===this._textInput;c('DOM').setContent(this._richInput,c('StructuredInputDOM').encodeText(c('Input').getValue(this._textInput)));c('CSS').hide(this._textInput);c('CSS').show(this._richInput);this.cleanInput();if(w){this._richInput.focus();this.setSelection({offset:v.start,length:v.end-v.start});}}this.togglePlaceholder();this._toggleHint();};u.prototype._initEvents=function(){'use strict';var v=null,w=false,x=function(){this._richChanged=true;w||this.scheduleCleanInput(true);}.bind(this),y=function(){this._textChanged=true;w||this.scheduleCleanInput(false);}.bind(this),z=function(){this._selectionChanged=true;this.scheduleCleanInput(false);}.bind(this),aa=function(){this._imeMode=true;this._placeholderText&&c('CSS').hide(this._placeholderText);c('CSS').hide(this._hintText);}.bind(this),ba=function(){this._imeMode=false;this._richChanged=true;this.cleanInput();}.bind(this);c('Event').listen(this._richInput,'keydown',function(ca){v=ca.keyCode;if(ca.ctrlKey&&ca.keyCode in q){return ca.kill();}else if(ca.keyCode in n){z();}else if(ca.keyCode===c('Keys').BACKSPACE&&this._deleteTrailingChunk()){this._richChanged=true;this.cleanInput();return ca.kill();}else if(ca.keyCode in o){x();}else if(ca.keyCode==m)aa();}.bind(this));c('Event').listen(this._richInput,'keypress',function(ca){if(ca.keyCode==c('Keys').RETURN){this._multiline&&this._insertText("\n");return ca.kill();}else if(!this._selectionChanged&&this._selectionIsText()){y();}else x();}.bind(this));if(!w){c('Event').listen(this._richInput,'keyup',function(ca){if((this._imeMode||ca.keyCode!=v)&&ca.keyCode in p){ba();return ca.kill();}else if(this._imeMode){this._textChanged=true;this.cleanInput();}}.bind(this));if(r)c('Event').listen(this._richInput,'input',function(){this._textChanged=true;this.cleanInput();}.bind(this));}else{c('Event').listen(this._richInput,'compositionstart',aa);c('Event').listen(this._richInput,'compositionend',function(){setTimeout(ba,0);});c('Event').listen(this._richInput,'input',function(){this._textChanged=true;if(!this._imeMode)if(!this._richChanged){this.cleanInput();}else this.scheduleCleanInput();}.bind(this));}c('Event').listen(document,'selectionchange',function(){if(this._selectionIgnore){this._selectionIgnore=false;}else this._selectionChanged=true;}.bind(this));c('Event').listen(this._richInput,'mousedown',function(){this._selectionChanged=true;this._selectionLength=0;this._selectionOffset=0;}.bind(this));c('Event').listen(this._richInput,'mouseup',function(){this._selectionChanged=true;this.scheduleCleanInput();}.bind(this));c('Event').listen(this._richInput,'cut',function(){this._richChanged=true;this.scheduleCleanInput(false);}.bind(this));c('Event').listen(this._richInput,'paste',function(ca){this._richChanged=true;this.scheduleCleanInput(true);}.bind(this));c('Event').listen(this._richInput,'drop',function(ca){this.focus();this.selectAll();this._insertClipboard(ca&&ca.dataTransfer);return ca.kill();}.bind(this));c('Event').listen(this._richInput,'dragover',function(ca){ca.dataTransfer.dropEffect='move';ca.dataTransfer.effectAllowed='move';return ca.kill();});c('Event').listen(this._richInput,'focus',function(ca){this._toggleHint();this.inform('focus');}.bind(this));c('Event').listen(this._richInput,'blur',function(ca){c('CSS').hide(this._hintText);this._imeMode=false;this._richChanged=true;this.scheduleCleanInput(false);this.inform('blur');}.bind(this));};u.prototype._initCleaner=function(){'use strict';this._cleaner=new (c('StructuredInputCleaner'))(this._richInput,this._selection,true);};u.prototype._initSelection=function(){'use strict';this._selection=new (c('StructuredInputSelection'))(this._richInput);this._selectionLength=0;this._selectionOffset=0;};u.prototype._insertClipboard=function(v){'use strict';if(v&&typeof v.getData==='function'){var w=v.getData('Text');this._insertText(w);}};u.prototype._deleteTrailingChunk=function(v){'use strict';var w=this.getSelection();if(w.length>0||w.offset===0)return false;var x=this.getSelection().offset-1,y=c('StructuredInputUtil').getMarkerAtOffset(this._richInput,x);if(y&&c('StructuredInputDOM').isEntityNode(y.node)&&c('StructuredInputUtil').getGrouping(y.node,'select')!=='none'){c('DOM').remove(y.node);return true;}return false;};u.prototype._selectionIsText=function(){'use strict';var v=this._selection.start.node,w=this._selection.end.node;return v&&v===w&&!c('StructuredInputDOM').isEntityNode(v)&&!c('StructuredInputDOM').isEntityNode(v.parentNode);};u.prototype._insertText=function(v){'use strict';if(v){var w=c('DOM').create('div',{},v);return this._insertNodes(w);}};u.prototype._insertHTML=function(v){'use strict';if(v){var w=c('DOM').create('div'),x=new (c('StructuredInputCleaner'))(w,null,false);w.innerHTML=v;x.clean();return this._insertNodes(w);}};u.prototype._insertNodes=function(v){'use strict';if(document.selection){document.selection.createRange().pasteHTML(v.innerHTML);}else document.execCommand('insertHTML',false,v.innerHTML);this._richChanged=true;this.cleanInput();};u.prototype.togglePlaceholder=function(v){'use strict';if(!this._placeholderText)return;var w=c('StructuredInputDOM').getLength(this._richInput)===0;if(v&&w){c('CSS').show(this._placeholderText);}else c('CSS').conditionShow(this._placeholderText,w&&!this._imeMode);};u.prototype._toggleHint=function(){'use strict';var v=c('createArrayFromMixed')(this._hintNodes),w=null,x='',y=c('StructuredInputDOM').getText(this._richInput).toLowerCase();if(!this.hasFocus())return;if(this._contentOverflows()){c('CSS').hide(this._hintText);return;}while(v.length&&x.length<y.length){w=v.shift();x+=c('StructuredInputDOM').getText(w);}if(y.length&&x.substr(0,y.length).toLowerCase()==y.toLowerCase()){c('DOM').setContent(this._hintText,Array.from(this._richInput.cloneNode(true).childNodes).filter(function(aa){return aa.tagName!=='BR';}));var z=c('StructuredInputDOM').createTextNode(x.substr(y.length));v.unshift(z);c('DOM').appendContent(this._hintText,c('DOM').create('span',{className:"_586h"},v));c('CSS').show(this._hintText);c('CSS').hide(this._placeholderText);}else c('CSS').hide(this._hintText);};u.prototype._contentOverflows=function(){'use strict';if(this._richWidth===null)this._richWidth=this._richInput.clientWidth;if(this._contentWidth===null){var v=this._richInput.lastChild;this._contentWidth=c('isElementNode')(v)?v.offsetLeft+v.offsetWidth:0;}return this._contentWidth>this._richWidth;};u.prototype._forceTop=function(){'use strict';if(!this._multiline)c('Scroll').setTop(this._richInput,0);c('Scroll').setTop(this._root,0);};u.prototype._createStructureNodes=function(v){'use strict';return v.map(function(w){return w.uid||w.type&&w.type!='text'?c('StructuredInputDOM').createEntityNode(w,w.display||{}):c('StructuredInputDOM').createTextNode(w.text);}.bind(this));};u.prototype._suppressInput=function(){'use strict';if(r||s){if(this._richClean)return;this._richClean=this._richInput.cloneNode(true);this._richClean.contentEditable=false;this._root.insertBefore(this._richClean,this._richInput.nextSibling);c('Scroll').setLeft(this._richClean,c('Scroll').getLeft(this._richInput));c('Style').set(this._richInput,'padding',0);c('Style').set(this._richInput,'height',0);}};u.prototype._revealInput=function(){'use strict';if(!this._richClean)return;c('Style').set(this._richInput,'height','');c('Style').set(this._richInput,'padding','');this._root.removeChild(this._richClean);this.focus();this._richClean=null;};u.prototype._cleanInput=function(){'use strict';var v;if(this._textChanged&&!this._richChanged){this._selection.update();v='change';}else if(this._richChanged||this._selectionChanged){this._selection.update();if(this._richChanged){this._contentWidth=null;this._cleaner.clean();this._cleaner.endOnText();this._selection.apply();v='change';}if(this._selectionChanged){this._cleanSelection();if(this._selectionLength||!this._richChanged)v='select';}}this._revealInput();this._forceTop();this._cleanInputPreTogglesFinished=true;if(this._richChanged||this._textChanged){this.togglePlaceholder();this._toggleHint();}this._selectionIgnore=true;this._selectionChanged=false;this._richChanged=false;this._textChanged=false;this._cleanInputFinished=true;v&&this.inform(v);};u.prototype._cleanSelection=function(){'use strict';var v=this._selection.getLength(),w=this._selection.getOffset();if(v){this._selection.expand(v>=this._selectionLength);v=this._selection.getLength();w=this._selection.getOffset();}this._selectionLength=v;this._selectionOffset=w;};u.prototype.cleanInput=function(){'use strict';this._scheduledCleanInput||this._cleanInput();};u.prototype.scheduleCleanInput=function(v){'use strict';v&&this._suppressInput();if(!this._scheduledCleanInput){this._scheduledCleanInput=true;c('setTimeoutAcrossTransitions')(function(){this._cleanInput();this._scheduledCleanInput=false;}.bind(this),0);}};u.prototype.setEnabled=function(v){'use strict';this._textInput.disabled=!v;this._richInput.contentEditable=v;};u.prototype.getRoot=function(){'use strict';return this._root;};u.prototype.getRichInput=function(){'use strict';return this._richInput;};u.prototype.getEnabled=function(){'use strict';return !this._textInput.disabled;};u.prototype.getText=function(){'use strict';return c('StructuredInputDOM').getDecodedText(this._richInput);};u.prototype.setText=function(v){'use strict';c('DOM').setContent(this._richInput,c('StructuredInputDOM').createTextNode(v));this._richChanged=false;this._selectionChanged=false;this.inform('change');};u.prototype.setHint=function(v){'use strict';this._hintNodes=this._createStructureNodes(v);this._toggleHint();};u.prototype.getStructure=function(){'use strict';var v=[];Array.from(this._richInput.childNodes).forEach(function(w){var x=!c('isTextNode')(w),y=c('StructuredInputDOM').getDecodedText(w);y.length&&v.push({text:y,uid:x?w.getAttribute('data-uid'):null,type:x&&w.getAttribute('data-type')||'text',isLocal:x&&w.getAttribute('data-is-local'),categoryName:x?w.getAttribute('data-category-name'):null});});return v;};u.prototype.setStructure=function(v){'use strict';c('DOM').setContent(this._richInput,this._createStructureNodes(v));this._cleaner.clean();this._cleaner.endOnText();this.togglePlaceholder();this._toggleHint();this._richChanged=false;this._selectionChanged=false;this.inform('change');};u.prototype.getContentDimensions=function(){'use strict';var v=this._richInput.lastChild;return {width:v?v.offsetLeft+v.offsetWidth:0,height:v?v.offsetTop+v.offsetHeight:0};};u.prototype.getSelection=function(){'use strict';if(this._selection)return {offset:this._selection.getOffset(),length:this._selection.getLength()};};u.prototype.setSelection=function(v){'use strict';if(this.hasFocus()&&this._selection){this._selection.update();this._selection.setPosition(v.offset,v.length);this._selection.scrollToFocus();this._selectionChanged=false;this.inform('select');}};u.prototype.moveSelectionToEnd=function(){'use strict';this.setSelection({length:0,offset:c('StructuredInputDOM').getLength(this._richInput)});};u.prototype.isSelectionAtEnd=function(){'use strict';var v=this.getSelection().offset,w=c('StructuredInputDOM').getLength(this._richInput);return v>=w;};u.prototype.selectAll=function(){'use strict';this.setSelection({offset:0,length:c('StructuredInputDOM').getLength(this._richInput)});};u.prototype.hasFocus=function(){'use strict';return c('DOM').contains(this._root,document.activeElement);};u.prototype.focus=function(){'use strict';this._richInput.focus();};u.prototype.blur=function(){'use strict';var v={position:'absolute',top:0,width:'1px',height:'1px'};if(c('Locale').isRTL()){v.right='-100px';}else v.left='-100px';var w=c('DOM').create('input',{type:'text',tabIndex:-1,style:v});c('DOM').appendContent(this._root,w);var x=function(){if(this.hasFocus()||t&&document.activeElement===document.body){w.focus();w.blur();}};this.blur=x;this.blur();};u.getInstance=function(v){var w=c('Parent').bySelector(v,"._586g");if(!w)throw new Error('No DOMElement structured input found using '+v);return c('DataStore').get(w,'StructuredInput')||new u(w);};f.exports=u;},null);
__d('FacebarTypeaheadInput',['csx','ArbiterMixin','DOM','FacebarStructuredText','Locale','SimpleStructuredInput','StructuredInput','Vector','mixin'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k={text:{className:"text",group:"all",select:"none"},ent:{className:"entity",group:"all",select:"group"},'ent:hashtag_exact':{className:"entity",group:"hashtag",select:"none"}};function l(n){return Object.assign(n.toStruct(),{display:k[n.getType()]||k[n.getTypePart(0)]});}i=babelHelpers.inherits(m,c('mixin')(c('ArbiterMixin')));j=i&&i.prototype;function m(n){'use strict';j.constructor.call(this);this.root=n;var o=c('DOM').scry(this.root,"._586i")[0];if(o){this.input=c('StructuredInput').getInstance(n);}else this.input=c('SimpleStructuredInput').getInstance(n);this.value=null;this.selection={offset:0,length:0};this.resetOnChange=true;this.initEvents();}m.prototype.initEvents=function(){'use strict';var n=function(o,p){this.inform(o,p);}.bind(this);this.input.subscribe('blur',n);this.input.subscribe('focus',n);this.input.subscribe('change',function(o,p){if(this.resetOnChange)this.value=null;this.inform('change',p);}.bind(this));};m.prototype.togglePlaceholder=function(n){'use strict';if(this.input instanceof c('StructuredInput'))return this.input.togglePlaceholder(n);return null;};m.prototype.focus=function(){'use strict';this.input.focus();};m.prototype.blur=function(){'use strict';this.input.blur();};m.prototype.getElement=function(){'use strict';return this.root;};m.prototype.getRawInputElement=function(){'use strict';var n=c('DOM').scry(this.root,"._586i")[0];if(n==null)return c('DOM').scry(this.root,"._1frb")[0];return n;};m.prototype.getValue=function(){'use strict';if(this.value==null)this.value=c('FacebarStructuredText').fromStruct(this.input.getStructure());return this.value;};m.prototype.getLength=function(){'use strict';return this.getValue().getLength();};m.prototype.resetPlaceholder=function(){'use strict';this.input.resetPlaceholder();};m.prototype.setValue=function(n,o){'use strict';this.value=n;this.resetOnChange=!!o;var p=n.toArray().map(l);this.input.setStructure(p);this.input.setSelection({offset:n.getLength(),length:0});this.resetOnChange=true;};m.prototype.storeSelection=function(){'use strict';this.selection=this.input.getSelection();};m.prototype.restoreSelection=function(){'use strict';if(this.selection)this.input.setSelection(this.selection);};m.prototype.clearSelection=function(){'use strict';this.input.setSelection({offset:this.getLength(),length:0});};m.prototype.setHint=function(n){'use strict';var o=n&&!n.hasRTL()&&!c('Locale').isRTL()?n.toArray().map(l):[];this.input.setHint(o);};m.prototype.isSelectionAtEnd=function(){'use strict';return this.input.isSelectionAtEnd();};m.prototype.selectInput=function(n){'use strict';this.input.setSelection({offset:n||0,length:this.getLength()});};Object.assign(m.prototype,{events:['change','focus','blur']});f.exports=m;},null);
__d('FacebarTypeaheadWebSearch',['FacebarStructuredFragment','FacebarStructuredText'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=new (c('FacebarStructuredFragment'))({type:'ent:websuggestion',text:'Web Search: ',uid:null}),i=h.getText().toLowerCase().trim();function j(m,n){if(!m||m.type!=='websuggestion')return;var o=n.getValue().toArray();o.forEach(function(p){if(p.isType('ent')&&!p.isType('ent','user')&&p.getUID())if(m.extra_uri_params){m.extra_uri_params.qh=p.getUID();return;}});}function k(m){return m.getType()===h.getType();}function l(m){'use strict';this._core=m.getCore();this._view=m.getView();this._input=this._core.input;this._isEnabled=false;}l.prototype.enable=function(){'use strict';this._isEnabled=true;this.changeListener=this._input.subscribe('change',this._changeWebSearch.bind(this));this.lockListener=this._input.subscribe('shortcut',this._lockWebSearch.bind(this));this.beforeSelectListener=this._view.subscribe('beforeSelect',this._beforeSelect.bind(this));this.beforeRenderListener=this._view.subscribe('beforeRender',this._beforeRender.bind(this));};l.prototype._changeWebSearch=function(){'use strict';var m=this._input.getValue(),n=m.toArray(),o=n[0];if(o&&o.getType()==='text')if(o.getText().toLowerCase().startsWith(i)){n.splice(0,1,h,new (c('FacebarStructuredFragment'))({text:o.getText().substr(i.length).replace(/^ /,'')}));this._replaceFragments(n);}else if(n.length>1&&n.some(k)){var p='';n.forEach(function(q){if(k(q))return;p+=q.getText();});this._input.storeSelection();this._input.setValue(c('FacebarStructuredText').fromString(p));this._input.restoreSelection();}};l.prototype._replaceFragments=function(m){'use strict';this._input.storeSelection();this._input.setValue(new (c('FacebarStructuredText'))(m));this._input.restoreSelection();};l.prototype._beforeSelect=function(m,n){'use strict';j(n.selected,this._input);return true;};l.prototype._beforeRender=function(m,n){'use strict';var o=this._input.getValue().toArray()[0],p=o&&k(o);n.results.forEach(function(q){if(q.type==='websuggestion')q.isLockedWebSearchMode=p;});return true;};l.prototype._lockWebSearch=function(m,n){'use strict';if(n.shift){var o=this._input.getValue().toArray()[0];if(!o||!k(o))this._input.setValue(new (c('FacebarStructuredText'))([h]));}};l.prototype.disable=function(){'use strict';this.beforeSelectListener.unsubscribe();this.changeListener.unsubscribe();this.lockListener.unsubscribe();this.beforeRenderListener.unsubscribe();this._isEnabled=false;};l.addPrefix=function(m){'use strict';var n=k(m.getFragment(0))||m.getFragment(0).getText().toLowerCase().startsWith(i);if(!n){var o=[h].concat(m.toArray());return new (c('FacebarStructuredText'))(o);}else return m;};f.exports=l;},null);
__d('FacebarTypeaheadCore',['csx','invariant','Arbiter','ArbiterMixin','Base64','DOM','Event','FacebarGlobalOptions','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarResultStoreUtils','FacebarStructuredText','FacebarTypeaheadInput','FacebarTypeaheadWebSearch','Keys','KeywordsSearchResultConfig','Parent','Random','URI','arrayContains','getActiveElement','mixin','setTimeout'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));k=j&&j.prototype;function l(m){'use strict';k.constructor.call(this);this.events=['session','focus','select','change','execute','blur','focusStartTime','open'];Object.assign(this,m);}l.prototype.init=function(m,n,o){'use strict';if(window.getSelection===null)throw new Error('Facebar: window.getSelection is null!');this.init=function(){};this.data=m;this.view=n;this.root=o;this.facebarRoot=c('Parent').bySelector(o,"._585-");this.windowFocused=true;this.isFocused=false;this.hoverAnimation=null;this.stickyQuery=null;this.settedQuery=null;this.selectedQuery=null;this.currentQuery=null;this.isSuggestionBagdeVisible=false;this.initSubcomponents();this.initEvents();this.checkValue();this.checkSingleState();this.checkLocal();this.checkCategoryName();this.checkIsPersonSERP();};l.prototype.initSubcomponents=function(){'use strict';var m=c('DOM').find(this.root,"._5861");this.input=new (c('FacebarTypeaheadInput'))(m);this.view.setInputElement(this.input.getRawInputElement());};l.prototype.initEvents=function(){'use strict';c('Event').listen(this.root,'keydown',this.keydown.bind(this));c('Event').listen(this.root,'keyup',this.keyup.bind(this));c('Event').listen(this.root.parentNode,'mousedown',this.mousedown.bind(this));c('Event').listen(this.view.getElement(),'mousedown',this.mousedown.bind(this));c('Event').listen(window,'focus',this.focusWindow.bind(this));c('Event').listen(window,'blur',this.blurWindow.bind(this));this.view.subscribe('select',this.selectView.bind(this));this.view.subscribe('highlight',this.highlightView.bind(this));this.view.subscribe('render',this.highlightView.bind(this));this.view.subscribe('hideHelp',this.performQuery.bind(this));this.input.subscribe('focus',this.focusInput.bind(this));this.input.subscribe('blur',this.blurInput.bind(this));this.input.subscribe('change',this.changeInput.bind(this));this.data.subscribe('activity',this.typeaheadActivity.bind(this));this.data.subscribe('respond',this.completeData.bind(this));this.data.subscribe('nullstateReady',this.performQueryIfVisible.bind(this));this.data.subscribe('reloadNullstate',this.performQuery.bind(this));c('Arbiter').subscribe('FacebarTypeahead.clearRecentSearches',function(){return this.clearRecentSearches();}.bind(this));c('Arbiter').subscribe('FacebarTypeahead.focus',function(){this.input.focus();c('setTimeout')(function(){this.input.clearSelection();}.bind(this),0);}.bind(this));c('setTimeout')(this.initFocus.bind(this),0);};l.prototype.initFocus=function(){'use strict';if(!this.lazyFocused&&c('DOM').contains(this.input.root,c('getActiveElement')())){this.lazyFocused=true;this.isFocused=true;this._newSession();this.inform('focus',{catchup:true});this.open(true);}};l.prototype.setStartTime=function(m){'use strict';this.inform('focusStartTime',{time:m});};l.prototype.cleanQuery=function(m){'use strict';m=babelHelpers['extends']({},m)||{};if(!m.structure)m.structure=new (c('FacebarStructuredText'))();if(!c('FacebarGlobalOptions').allowGrammar||c('FacebarJSConstants').nonGrammarTypes[m.type])m.structure=c('FacebarStructuredText').fromString(m.structure.toString());!(m.structure instanceof c('FacebarStructuredText'))?i(0):void 0;return m;};l.prototype._unlockQuery=function(){'use strict';var m=this.input.getValue();if(m.hasType('ent')&&m.trim().getCount()===1){this.input.storeSelection();this.input.setValue(c('FacebarStructuredText').fromString(m.toString()));this.input.restoreSelection();}};l.prototype.setPageQuery=function(m){'use strict';m=this.cleanQuery(m);var n=this.input.getValue(),o=m.structure,p=!o.isEmptyOrWhitespace()&&(n.isEmptyOrWhitespace()||!n.matches(o));return this.selectQuery(m,p);};l.prototype.selectQuery=function(m,n){'use strict';n=n!==false;m=this.cleanQuery(m);if(n||!this.selectedQuery){if(n||this.getValue().isEmptyOrWhitespace())this.setQuery(m);this.selectedQuery=m;}return m;};l.prototype.completeSelection=function(){'use strict';var m=this.view.getSelection();if(m&&!m.search){this.data.saveResult(m);m.structure=m.structure.pad();this.setQuery(m);return true;}return false;};l.prototype.setQuery=function(m){var n=arguments.length<=1||arguments[1]===undefined?true:arguments[1];'use strict';m=this.cleanQuery(m);if(m.structure.hasType('blank'))m.structure=new (c('FacebarStructuredText'))(m.structure.toArray().filter(function(o){return o.getType()!='blank';}));this.input.setValue(m.structure);this.settedQuery=m;this.stickyQuery=n===false?this.stickyQuery:m;this.checkValue();this.checkSingleState();this.checkLocal();this.checkCategoryName();this.checkIsPersonSERP();};l.prototype.checkValue=function(){var m=arguments.length<=0||arguments[0]===undefined?false:arguments[0];'use strict';if(!m&&this.value&&this.value.getHash()===this.input.getValue().getHash())return;this.checkBlockedSearch();this.performQueryIfVisible();this.showSearchSuggestionBadgeIfPossible();};l.prototype.showSearchSuggestionBadgeIfPossible=function(){'use strict';if(this.isNullState()){if(!this.isSuggestionBagdeVisible&&this.data.resultStore.injectedSuggestionCount){c('Arbiter').inform('FacebarTypeahead.showSuggestionBadge');this.isSuggestionBagdeVisible=true;}}else if(this.isSuggestionBagdeVisible){c('Arbiter').inform('FacebarTypeahead.hideSuggestionBadge');this.isSuggestionBagdeVisible=false;}};l.prototype.checkSingleState=function(){'use strict';var m=this.input.getValue();this.data.setSingleState(m.getCount()===1&&m.hasType('ent'));};l.prototype.checkIsPersonSERP=function(){'use strict';var m=this.input.getValue();this.data.setIsPersonSERP(m.getCount()===1&&m.isPersonSERP());};l.prototype.checkLocal=function(){'use strict';var m=this.input.getValue();this.data.setLocal(m.getCount()===1&&m.isLocal());};l.prototype.checkCategoryName=function(){'use strict';var m=this.input.getValue();if(m.getCategoryName()!==null)this.data.setCategoryName(m.getCategoryName());};l.prototype.checkBlockedSearch=function(){'use strict';var m=this.input.getValue().toString().toLocaleLowerCase();if(!this.data.blockees||!this.data.blockees.hasOwnProperty(m)){this.view.hideBlockNotification();}else this.view.showBlockNotification(this.data.blockees[m]);};l.prototype.isNullState=function(){'use strict';return this.input.getValue().getHash()==='';};l.prototype.performQueryIfVisible=function(){'use strict';if(!this.view.visible)return;this.performQuery();};l.prototype.performQuery=function(){'use strict';this.value=this.nextQuery=this.getValue();if(c('FacebarGlobalOptions').graphSearchV2)this.view.resetIndex();this.data.query(this.nextQuery);this.currentQuery=this.nextQuery;};l.prototype.requery=function(){'use strict';if(this.currentQuery)this.data.query(this.currentQuery);};l.prototype.executeQuery=function(m){'use strict';var n=this.isNullState();m=this.cleanQuery(m);if(c('FacebarGlobalOptions').facebar_use_js_session_id)m.csid=String(c('Random').uint32())+String(c('Random').uint32());var o=this.inform('execute',m),p=this.getSessionID();this.close();if(c('FacebarGlobalOptions').allowGrammar){this.selectQuery(m);}else this.selectQuery();if(c('FacebarGlobalOptions').hasRecentSearchNullState&&m.type!=='shortcut'&&(!n||m.isInjectedSuggestion)){this.data.resultStore.addRecentEntryToNullState(m);if(m.isInjectedSuggestion){c('Arbiter').inform('FacebarTypeahead.removeInjectedSuggestion');--this.data.resultStore.injectedSuggestionCount;this.performQuery();}}if(!o)this._navigateToQuery(m,p,m.csid);};l.prototype.getSearchType=function(){'use strict';return 'facebar';};l.prototype._newSession=function(){'use strict';if(this._sessionID!=null)return;this._sessionID=Math.random().toString();this.inform('session',this._sessionID,c('Arbiter').BEHAVIOR_STATE);};l.prototype._closeSession=function(){'use strict';this._sessionID=null;this.inform('session',null,c('Arbiter').BEHAVIOR_STATE);};l.prototype.getSessionID=function(){'use strict';return this._sessionID;};l.prototype._navigateToQuery=function(m,n,o){'use strict';var p=this.data.facebarConfig;if(m.uri){m.uri.addQueryData(m.extra_uri_params);m.uri.addQueryData({ref:'br_tf'});if(m.structure&&(m.type=='websuggestion'||m.type==c('KeywordsSearchResultConfig').result_type||m.type=='grammar'&&(!p||String(m.uri.getPath()).startsWith(p.search_path)))){var q=this.data.getRawStructure(m.structure).text_form,r=c('Base64').encode(encodeURIComponent(q)).replace(/\=+$/,''),s={sid:n,qs:r,gv:this.data.getQueryData().grammar_version};if(o)s.csid=o;var t=c('Base64').encode(JSON.stringify(s)).replace(/\=+$/,'');m.uri.addQueryData({ref:t,bs:m.alternateSemantic});}m.uri.go();return;}};l.prototype.reset=function(){'use strict';this.selectQuery();this.inform('reset');this.showSearchSuggestionBadgeIfPossible();};l.prototype.open=function(m){'use strict';this.inform('open');this.view.show(this.facebarRoot.offsetWidth);this.input.focus({catchup:m});this.checkValue(true);this.checkSingleState();this.checkLocal();this.checkCategoryName();this.checkIsPersonSERP();if(!this.isFocused){this.isFocused=true;this._newSession();this.inform('focus');}};l.prototype.close=function(){'use strict';this._closeSession();if(this.inform('close')===false)return;if((!this.value||this.value.isEmptyOrWhitespace())&&this.selectedQuery){this.input.setValue(this.selectedQuery.structure);}else if(this.stickyQuery)this.input.setValue(this.stickyQuery.structure);this.input.blur();this.view.hide();this.view.setAutoSelect(false);this.inform('session',null,c('Arbiter').BEHAVIOR_STATE);if(this.isFocused){this.isFocused=false;c('setTimeout')(this.inform.bind(this,'blur'),0);}};l.prototype.getElement=function(){'use strict';return this.root;};l.prototype.getValue=function(){'use strict';return this.input.getValue();};l.prototype.getText=function(){'use strict';return this.getValue().toString();};l.prototype.submitQuery=function(m){'use strict';if(c('FacebarGlobalOptions').graphSearchV2&&this.view.index<0){var n=this.input.getValue(),o=this.data.getRawStructure(n);if(o&&!o.is_empty){var p=!o.raw_text?c('FacebarResultStoreUtils').getRawTextFromStructured(n.toArray()):o.raw_text,q=c('FacebarKeywordSearchUtils').makeFacebarEntry(p);q.position=m;this.inform('magSearch',q);this.executeQuery(q);}}else this.view.select();};l.prototype.keydown=function(event){'use strict';var m=true,n=c('Event').getKeyCode(event);if(event.metaKey===true)this.metaOnKeyDown=true;switch(n){case c('Keys').ESC:this.close();break;case c('Keys').RIGHT:m=this.input.isSelectionAtEnd()&&this.completeSelection();break;case c('Keys').TAB:var o=this.cleanQuery(this.view.getSelection()),p=o.structure.hasType('blank');if(event.getModifierState('shift')||!this.completeSelection()&&!this.loading){this.view.setAutoSelect(false);this.view.hide();m=false;}else if(!p&&!c('FacebarGlobalOptions').graphSearchV2)this.tabQueued=true;break;case c('Keys').UP:this.view.prev();break;case c('Keys').DOWN:this.view.next();break;case c('Keys').RETURN:var q=-2;this.submitQuery(q);break;case c('Keys').PAGE_UP:this.view.first();break;case 222:var r=this.input.value.trim();if(!event.getModifierState('shift')&&r.endsOnType('ent'))this.input.setValue(r);m=false;break;default:var s=n<=46&&n!==8&&n!==32,t=n>=112&&n<=126,u=n===144||n===145,v=n===91||n===92||n===93||n===224;if(!s&&!t&&!u&&!event.metaKey&&!v){this.data.setSingleState(false);this.data.setLocal(false);if(c('FacebarGlobalOptions').autohighlight)this.view.setAutoSelect(true);}this.stickyQuery=null;m=false;break;}this.input.storeSelection();if(m){event.preventDefault();event.stopPropagation();}};l.prototype.keyup=function(event){'use strict';var m=c('Event').getKeyCode(event),n=m<=46&&m!==8&&m!==32,o=m>=112&&m<=126,p=m===144||m===145,q=m===91||m===92||m===93||m===224;if(!n&&!o&&!p&&!event.metaKey&&!q&&!this.metaOnKeyDown)if(c('FacebarGlobalOptions').unlockTextOnKeypress)this._unlockQuery();if(!q)this.metaOnKeyDown=false;};l.prototype.mousedown=function(event){'use strict';if(c('FacebarGlobalOptions').autohighlight)this.view.setAutoSelect(true);this.input.storeSelection();if(c('Parent').bySelector(event.target,"._50c9"))event.preventDefault();};l.prototype.focusWindow=function(){'use strict';this.windowFocused=true;};l.prototype.blurWindow=function(){'use strict';this.windowFocused=false;};l.prototype.selectView=function(m,n){'use strict';if(!n||!n.selected)return;this.inform('select',n);var o=this.cleanQuery(n.selected);this.executeQuery(o);};l.prototype.highlightView=function(){'use strict';var m=this.view.getSelection();if(c('FacebarGlobalOptions').graphSearchV2){this.input.setHint(m?m.structure:null);}else m&&this.input.setHint(m.structure);};l.prototype.blurInput=function(){'use strict';c('setTimeout')(function(){if(this.windowFocused||c('URI').getRequestURI().getSubdomain()==='apps'){this.input.togglePlaceholder();this.close();}}.bind(this),0);};l.prototype.changeInput=function(){'use strict';this.inform('change');this.checkValue();this.checkLocal();this.checkIsPersonSERP();this.inform('change_end');};l.prototype.focusInput=function(){'use strict';this.open();this.input.togglePlaceholder(false);};l.prototype.updateData=function(){'use strict';this.view.setLoading(this.loading);};l.prototype.completeData=function(m,n){'use strict';this.checkBlockedSearch();if(n.forceDisplay||this.value&&this.value.matches(n.value)){var o=c('FacebarGlobalOptions').graphSearchV2?!n.results.length:!n.results.length&&!this.loading&&n.isEmptyResults;this.view.render(n.value,n.results,n.isAsync,o);if(this.tabQueued&&this.completeSelection())delete this.tabQueued;}};l.prototype.typeaheadActivity=function(m,n){'use strict';this.fetching=n.activity;if(this.loading!==this.fetching){this.loading=this.fetching;this.updateData();}};l.prototype.getNameTextFromSelected=function(){'use strict';var m=this.settedQuery&&this.settedQuery.semantic,n=this.data.facebarConfig&&this.data.facebarConfig.name_functions,o=m&&n&&m.match(/[a-z-]+\([^()]+\)/g);if(o)for(var p=0;p<o.length;p++){var q=o[p].match(/([a-z-]+)\(([^()]+)\)/);if(q&&c('arrayContains')(n,q[1]))return q[2];}return this.value.toString();};l.prototype.clearRecentSearches=function(){'use strict';this.data.resultStore.clearRecentSearches();};l.clearRecentSearches=function(){'use strict';c('Arbiter').inform('FacebarTypeahead.clearRecentSearches');};f.exports=l;},null);
__d('FacebarTypeaheadRecorder',['clickRefAction','Event','Keys','SearchTypeaheadRecorder','URI','Arbiter','FacebarTimerUtils','FacebarGlobalOptions','FacebarJSConstants'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('SearchTypeaheadRecorder'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k);this.userText="";this.nullStateCandidates=null;this.singleStateCandidates=null;this.queryTimes={};this._sessionDisabled=false;this.type="facebar";this._maxQueryID=0;this._isQueryMatch=true;}j.prototype.initEvents=function(k){'use strict';k.getCore().subscribe('session',function(l,m){if(m===null){this.sessionEnd();}else this.sessionStart(m);}.bind(this));k.getCore().subscribe('select',function(l,m){this.recordStat('time_between_select_and_last_render',Date.now()-this._lastRenderTime);this.recordSelectInfo(m);}.bind(this));k.getCore().subscribe('magSearch',function(l,m){this.recordMagSearch(m);}.bind(this));k.getCore().input.subscribe('shortcut',function(l,m){this.recordShortcut(m);}.bind(this));k.getCore().subscribe('quickSelectRedirect',function(l,m){this.recordQuickSelectInfo(m);}.bind(this));k.getView().subscribe('render',function(l,m){if(this.data._isInjectedSuggestionFlow)return;this.recordRender(m);if(this.allFromNullState){this.nullStateCandidates=this.buildListTypeaheadRecords();}else if(this.allFromSingleState)this.singleStateCandidates=this.buildListTypeaheadRecords();this._lastRenderTime=Date.now();}.bind(this));k.getView().subscribe('show',function(l,m){if(!this.data.lastNullOrSingleStateFetchStartTime)return;this.recordStat('time_render_null_state',Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null;}.bind(this));k.getView().subscribe('logPerformanceTiming',function(l,m){this.performanceTimings[m.field]=m.value;}.bind(this));k.data.subscribe('query',function(l,m){if(!m.value.isEmpty())this.recordCountStat('num_queries');this.recordAvgStat('num_results_from_cache',m.results.length);this.queryTimes[m.queryId]={send:c('FacebarTimerUtils').getTimestamp()};}.bind(this));k.data.subscribe('sending_global_request',function(l,m){var n=m.getData().value;if(!n)return;this.backendQueries.push(n);}.bind(this));k.data.subscribe('sending_request',function(l,m){var n=m.data.value;if(!n)return;this.backendQueries.push(n);}.bind(this));k.subscribe('navigation',function(l,m){if(m&&m.structure){this.recordStat('navigation_input',JSON.stringify(m.structure.toStruct()));this.recordStat('navigation_text',m.structure.toString());}}.bind(this));k.data.subscribe('response_received',function(l,m,n){if(this.queryTimes[m.queryId]){var o=this.queryTimes[m.queryId];o.recv=c('FacebarTimerUtils').getTimestamp()-o.send;if(m&&m.payload)o.payload_size=JSON.stringify(m.payload).length;}}.bind(this));k.data.subscribe('remote_query_latency',function(l,m){if(this.queryTimes[m.queryId]){var n=this.queryTimes[m.queryId];n.remoteQueryLatencies=m.latencies;}}.bind(this));k.data.subscribe('cache_query_latency',function(l,m){if(this.queryTimes[m.queryId]){var n=this.queryTimes[m.queryId];n.cacheQueryLatencies=m.latencies;}}.bind(this));k.data.subscribe('backend_response',function(l,m){if(this.queryTimes[m.queryId]){var n=this.queryTimes[m.queryId];n.render=c('FacebarTimerUtils').getTimestamp()-n.send;if(m.payload.incomplete)n.incomplete=true;n.backendInfo=m.payload.info;if(this.core.scubaInfo)this.logToScuba(m,n,this.core.scubaInfo,m.inputQuery,this.type);}}.bind(this));k.getCore().subscribe('change',function(l,m){this.userInput(this.core.getText());}.bind(this));k.data.subscribe('remote_query_match',function(l,m){if(this._maxQueryID<m.queryId){this._maxQueryID=m.queryId;this._isQueryMatch=m.isMatch;}}.bind(this));c('Arbiter').subscribe('BrowseNUX/typing',this.disableThisSession.bind(this));c('Arbiter').subscribe('TestConsole/typing',this.disableThisSession.bind(this));k.subscribe('clear',function(){this.recordAppendStat('before_clear_queries',this.userText);}.bind(this));c('Event').listen(this.element,'keydown',function(event){this.recordStat('keypressed',1);this.recordCountStat('count_keys_pressed');if(c('Event').getKeyCode(event)==c('Keys').BACKSPACE){if(!this._backspacing){this._backspacing=true;this.recordAppendStat('before_backspace_queries',this.core.getText());}}else this._backspacing=false;}.bind(this));this.core.subscribe('open',function(l,m){if(m&&m.catchup)return;this.data.lastNullOrSingleStateFetchStartTime=Date.now();}.bind(this));this.core.subscribe('focusStartTime',function(l,m){this.data.lastNullOrSingleStateFetchStartTime=m.time;}.bind(this));this.data.subscribe('beforeQuery',function(l,m){if(!this.queryStartTime)this.queryStartTime=[];if(!this.query&&!this.data.lastNullOrSingleStateFetchStartTime)this.data.lastNullOrSingleStateFetchStartTime=Date.now();this.queryStartTime[this.query]=Date.now();}.bind(this));k.subscribe('filter',function(l,m){this._unsupportedGrammarInfo=this.buildUnsupportedGrammarInfo(m);}.bind(this));k.getCore().subscribe('recordFunction',function(l,m){this._extraRecorder.push(m);}.bind(this));this.data.subscribe('bootstrapped',function(l,m){this.recordStat('bootstrap_size',m.size||-1);}.bind(this));};j.prototype._reset=function(k){'use strict';this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this._topreplace=false;this._inflightRequests={};};j.prototype.sessionStart=function(k){'use strict';this._sessionEnded=false;this.data.setQueryData({sid:k});this.recordStat('sid',k);if(!this.stats.session_start_time){this.recordStat('session_start_time',c('FacebarTimerUtils').getTimestamp());var l=new Date(),m=l.getTimezoneOffset(),n=Date.now()-m*60*1000;this.recordStat('session_start_time_user_timezone',n);}this.recordStat('keypressed',0);this.queryTimes={};this._lastRenderTime=0;};j.prototype.sessionEnd=function(){'use strict';if(this._sessionEnded||this._sessionDisabled){if(this._sessionDisabled){this.reset();this._sessionDisabled=false;this._sessionEnded=true;}return;}this._sessionEnded=true;var k='typed';if(this.allFromNullState){k='nullstate';}else if(this.allFromSingleState)k='singlestate';this.recordStat('last_state',k);this.recordStat('session_end_time',c('FacebarTimerUtils').getTimestamp());this.recordStat('grammar_version',this.data.getQueryData().grammar_version);this.submit();this.nullStateCandidates=null;this.singleStateCandidates=null;};j.prototype.disableThisSession=function(){'use strict';this._sessionDisabled=true;};j.prototype.userInput=function(k){'use strict';this.userText=k;};j.prototype.buildUnsupportedGrammarInfo=function(k){'use strict';var l=k.results?k.results[0]:null;if(!l||l.results_set_type!=='unimplemented')return null;return {unsupported_grammar:{category:l.error_info.category||'unknown',edge:l.error_info.blamed_edge}};};j.prototype.buildTypeaheadRecord=function(k,l){'use strict';var m=k.rankType||k.render_type||k.type,n=0,o=l;if(typeof k.groupIndex=='number'){n=k.groupIndex;o=k.indexInGroup;}var p={group_index:n,index_in_group:o,cost:k.cost,s_value:k.s_value||0,semantic:k.semantic,text:k.structure.toString(),cache_only:k.cacheOnlyResult?1:0,prefetched:k.isPrefetched?1:0,parse:k.parse,category:k.category,type:m,source:k.bootstrapped,grammar_results_type:(k.results_set_type||'').replace(/[\[\{](.*)[\]\}]/,'$1'),result_from_memcache:k.memcache,dynamic_cost:k.dynamic_cost,is_js_bootstrap_match:k.isJSBootstrapMatch,backend_cost:k.backendCost,bootstrap_cost:k.bootstrapCost,match_type:k.match_type,l_type:k.l_type,vertical_type:k.vertical_type,prefix_match:k.prefix_match,prefix_length:k.prefix_length,index_before_buckets:k.indexBeforeBuckets,bucket_lineage:k.bucketLineage,nullstate:k.isNullState,singlestate:k.isSingleState,query_id:k.qid,template_id:k.templateID,coeff_cost:typeof k.grammar_costs=='undefined'?-1:k.grammar_costs["{"+k.type+"}"],suggestion:k.isSuggestion,keyword_source:k.keywordSource,keyword_bootstrap_type:k.keywordBootstrapType,exact_match_suggestion:k.exactMatchKeyword?1:0,keyword_type:k.keywordType};if(k.logInfo)p.backend_log_info=k.logInfo;if(k.s_token)p.s_token=k.s_token;if(k.s_categories)p.s_categories=k.s_categories;return p;};j.prototype.buildListTypeaheadRecords=function(){'use strict';var k=[];this.results&&this.results.forEach(function(l,m){if(l.uid!=='search')k.push(this.buildTypeaheadRecord(l,m));}.bind(this));return k;};j.prototype.recordShortcut=function(k){'use strict';this.recordStat('shortcut',1);this.recordStat('shortcut_with_shift',k.shift);};j.prototype.recordStats=function(k,l){'use strict';for(var m in l)this.recordStat(k+'_'+m,l[m]);};j.prototype.getTypeaheadIndex=function(k,l){'use strict';var m=typeof k.groupIndex=='number'?k.groupIndex+1:0;return l-m;};j.prototype.recordQuickSelectInfo=function(k){'use strict';var l={input_query:k.input_query,semantic:k.semantic,type:k.type,position:k.position,with_mouse:k.with_mouse,text:k.text,quick_select:1};this.recordStats('selected',l);this.recordStat('quick_select',1);};j.prototype.recordMagSearch=function(k){'use strict';var l={};l.text=k.text;l.semantic=k.semantic;l.type=k.type;l.input_query=k.text;l.position=k.position;this.recordStats('selected',l);};j.prototype.recordSelectInfo=function(k){'use strict';var l=k.selected,m=this.getTypeaheadIndex(l,k.index),n={};if(l.uid=='search'){n.selected_search=1;}else{n=this.buildTypeaheadRecord(l);var o=n.type=='friend'?'user':n.type;n.position=m;n[o]=1;}n.with_mouse=k.clicked?1:0;n.quick_select=0;n.input_query=this.userText;n.input_fragments=JSON.stringify(this.core.currentQuery.toStruct());var p=l.dataGT?{gt:JSON.parse(l.dataGT)}:{},q={href:l.path};c('clickRefAction')('click',q,null,null,p);this.recordStats('selected',n);this.recordAppendStat('selection_history',{selected:n,candidate_results:this.buildListTypeaheadRecords(),timestamp:c('FacebarTimerUtils').getTimestamp()});var r={};this._extraRecorder.forEach(function(s){s(k,this.results,r);}.bind(this));this.recordStat('extra_select_info',JSON.stringify(r));this.recordStat('selected_with_mouse',k.clicked?1:0);};j.prototype._dataToSubmit=function(){'use strict';this.recordStat('max_results',this.data._maxResults);if(this.stats&&this.stats.selected_input_query){this.recordStat('input_query',this.stats.selected_input_query);}else this.recordStat('input_query',this.userText);this.recordStat('uri',new (c('URI'))(window.location.href).toString());if(!this.stats.shortcut){this.recordStat('shortcut',0);this.recordStat('shortcut_with_shift',false);}var k=this.stats;for(var l in this.avgStats){var m=this.avgStats[l];k[l]=m[0]/m[1];}var n={candidate_results:this.buildListTypeaheadRecords(),timestamp:c('FacebarTimerUtils').getTimestamp(),input_query:this.userText,remote_query_match:this._isQueryMatch};if(this._unsupportedGrammarInfo)Object.assign(n,this._unsupportedGrammarInfo);this.recordAppendStat('suggestions_at_end_of_session',n);if(this.nullStateCandidates)this.recordAppendStat('suggestions_at_nullstate_session',{candidate_results:this.nullStateCandidates});if(this.singleStateCandidates)this.recordAppendStat('suggestions_at_singlestate_session',{candidate_results:this.singleStateCandidates});this.recordAppendStat('query_times',this.queryTimes);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat('backend_queries',this.backendQueries);}if(c('FacebarGlobalOptions').taSessionLoggingSample){var o=[];this.results.forEach(function(q){o.push([q.text||'',q.category||'',q.subtext||'']);});this.recordStat('raw_suggestions_text',o);}if(c('FacebarGlobalOptions').graphSearchV2){this.recordStat('experience_type','gsv2');}else this.recordStat('experience_type','facebar');for(var p in this.appendStats)k[p]=JSON.stringify(this.appendStats[p]);return k;};j.prototype.getDataToSubmit=function(){'use strict';return this._dataToSubmit();};j.prototype.reset=function(){'use strict';return this._reset();};j.prototype.submit=function(){'use strict';if(!this._sessionDisabled)i.submit.call(this);this.view.inform('feedback');this._reset();};Object.assign(j.prototype,{_sessionEnded:true,_extraRecorder:[],_banzaiRoute:'facebar'});f.exports=j;},null);
__d('FacebarTypeaheadV2',['csx','cx','CSS','DOM','Event','Parent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={init:function(k){this._view=k.getView();this._root=c('Parent').bySelector(k.getElement(),"._585-");this._button=c('DOM').find(this._root,"._4w98");this._core=k.getCore();c('Event').listen(this._button,'click',this.buttonDownAndClick.bind(this));c('Event').listen(this._button,'mousedown',this.buttonDownAndClick.bind(this));c('Event').listen(this._button,'mouseup',this.buttonUp.bind(this));this._core.subscribe('open',this.showButton.bind(this));this._core.subscribe('close',this.hideButton.bind(this));},showButton:function(){c('CSS').addClass(this._button,"_4w97");},hideButton:function(){if(c('CSS').matchesSelector(this._button,"._4w97"))c('CSS').removeClass(this._button,"_4w97");},buttonDownAndClick:function(event){event.preventDefault();},buttonUp:function(){if(!this._core.isFocused){this._core.focusInput();}else{var k=-1;this._core.submitQuery(k);}}};f.exports=j;},null);
__d('FacebarTypeaheadDebugPane.react',['Banzai','Image.react','LeftRight.react','React'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=i.constructor).call.apply(m,[this].concat(o)),this.state={feedbackSent:false},this.sendFeedback=function(q){var r=this.props.result;if(r.decoration&&r.decoration.entity===r)r.decoration.entity='';var s=JSON.stringify(r),t=JSON.stringify(r.debug.allResults),u={result:s,query:r.debug.query,position:r.debug.position,sid:r.debug.sid,allResults:t,isOK:q};c('Banzai').post('facebar_feedback',u,{delay:0});this.setState({feedbackSent:true});this.setState({feedbackOK:q});return false;}.bind(this),this.renderDebugText=function(q){return c('React').createElement('div',{key:q},q);},l;}k.prototype.componentWillReceiveProps=function(l){'use strict';if(l.result!==this.props.result)this.setState({feedbackSent:false});};k.prototype.render=function(){'use strict';var l=this.sendFeedback.bind(this,true),m=this.sendFeedback.bind(this,false),n=this.state.feedbackSent,o=n&&this.state.feedbackOK,p=n&&!this.state.feedbackOK;return (c('React').createElement('div',{className:'fsm pam'},c('React').createElement(c('LeftRight.react'),null,c('React').createElement('div',null,this.props.result.debug.map(this.renderDebugText)),c('React').createElement('div',null,c('React').createElement('div',{className:o?'':'hidden_elem'},c('React').createElement('strong',null,'Feedback sent'),c('React').createElement(c('Image.react'),{className:'mls',src:'/images/green_up.gif'})),c('React').createElement('div',{className:p?'':'hidden_elem'},c('React').createElement('strong',null,'Feedback sent'),c('React').createElement(c('Image.react'),{className:'mls',src:'/images/red_down.gif'})),c('React').createElement('div',{className:n?'hidden_elem':''},c('React').createElement('a',{href:'#',onClick:l},c('React').createElement(c('Image.react'),{src:'/images/green_up.gif'})),c('React').createElement('a',{href:'#',onClick:m},c('React').createElement(c('Image.react'),{className:'mls',src:'/images/red_down.gif'})))))));};k.propTypes={result:j.object.isRequired};f.exports=k;},null);
__d('FacebarTypeaheadDiffText.react',['cx','React'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.renderDiff=function(r,s){return (c('React').createElement('span',{className:"diffNode _5td3",key:s},r));},this.renderParts=function(){var r=this.props.prefix,s=this.props.text;if(r==null)return this.renderDiff(s,0);var t=s.toLowerCase().indexOf(r.toLowerCase());r=r.trim();if(t===0)s=s.slice(r.length);var u=s.split(/\b/).map(this.renderDiff);if(t===0)u.unshift(r);return u;}.bind(this),m;}l.prototype.render=function(){'use strict';return (c('React').createElement('span',this.props,this.renderParts()));};l.propTypes={prefix:k.string,text:k.string};l.generatePrefixes=function(m,n){var o=[],p,q;for(var r=0,s=n.length;r<s;r++){q=n[r].getText();p=m.slice(0,Math.min(m.length,q.length));if(p==='')return o;if(q.toLowerCase().indexOf(p.toLowerCase())===0){o.push(p);m=m.slice(p.length);}else o.push('');}return o;};f.exports=l;},null);
__d('FacebarTypeaheadHighlightedText.react',['BrowseFacebarHighlighter','React'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=i.constructor).call.apply(m,[this].concat(o)),this.renderHighlight=function(q,r){if((r+1)%3===0){return c('React').createElement('span',{className:'highlightNode',key:r},q);}else if(q)return q;},this.renderParts=function(){var q=this.props.text,r=this.props.tokens;if(r&&q){var s=c('BrowseFacebarHighlighter').createRegex(r),t=q.split(s);return t.map(this.renderHighlight);}else return q;}.bind(this),l;}k.prototype.render=function(){'use strict';return (c('React').createElement('span',this.props,this.renderParts()));};k.propTypes={text:j.string,tokens:j.array};f.exports=k;},null);
__d('FacebarTypeaheadItem.react',['cx','Badge.react','Image.react','React','FacebarGlobalOptions','FacebarTypeaheadDebugPane.react','FacebarTypeaheadDiffText.react','FacebarTypeaheadHighlightedText.react','TimelineFilterOptions','URI','XUICloseButton.react','TypeaheadCanvasConfig','FacebarJSConstants','joinClasses','DOM','DOMContainer.react'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;function l(n){var o=n.getTypePart(0);return o?'fragment'+o.charAt(0).toUpperCase()+o.substr(1):'fragment';}i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.renderHighlightedFragment=function(s,t){return (c('React').createElement(c('FacebarTypeaheadHighlightedText.react'),{className:l(s),key:t,text:s.getText(),tokens:this.props.highlight}));}.bind(this),this.renderDiffedFragment=function(s,t,u){return (c('React').createElement(c('FacebarTypeaheadDiffText.react'),{className:l(s),key:u,prefix:t,text:s.getText()}));},this.renderText=function(){var s=this.props.result,t=s.isLocal,u=s.displayStructure!=null?s.displayStructure.toArray():s.structure.toArray(),v=this.props.prefix;if(c('FacebarGlobalOptions').graphSearchV2&&!s.isSeeMore&&v!=null&&v.trim()!==''){var w=c('FacebarTypeaheadDiffText.react').generatePrefixes(v,u);if(t)w=[];return u.map(function(x,y){if(!w[y])w[y]='';return this.renderDiffedFragment(x,w[y],y);}.bind(this));}else return u.map(this.renderHighlightedFragment);}.bind(this),this.renderBadge=function(){if(this.props.result.photo&&this.props.showSecondaryIcon&&!this.props.result.isTrending)return (c('React').createElement('span',{className:"_34my"}));if(this.props.result.category&&this.props.result.category.toString().toLowerCase()===c('TypeaheadCanvasConfig').category_games.toLowerCase()&&c('TypeaheadCanvasConfig').in_games_v1){return (c('React').createElement(c('Badge.react'),{type:'game_blue',size:'medium'}));}else if(this.props.result.is_verified){return (c('React').createElement(c('Badge.react'),{type:'verified',size:'medium'}));}else if(this.props.result.is_work_user){return (c('React').createElement(c('Badge.react'),{type:'work',size:'medium'}));}else if(this.props.result.pages_verified_badge===1)return (c('React').createElement(c('Badge.react'),{type:'page_gray_check',size:'medium'}));}.bind(this),this.renderIcon=function(){var s=this.props.result,t=s.icon_class;if(t){return (c('React').createElement('span',{className:"_k83"},c('React').createElement('span',{className:t})));}else if(s.photo)return (c('React').createElement(c('Image.react'),{className:"_20h",alt:'',src:s.photo}));}.bind(this),this.renderSecondaryIcon=function(){var s=this.props.result;if(s.photo&&this.props.showSecondaryIcon){return (c('React').createElement('div',{className:"_20h"},c('React').createElement(c('Image.react'),{alt:'',src:s.photo})));}else if(!s.isRecent&&s.isInjectedSuggestion)return (c('React').createElement('span',{className:"_3kxl"}));}.bind(this),this.renderUnseenPosts=function(){if(this.props.recentSearchItem&&this.props.result.unseen_posts){var s=c('React').createElement(c('DOMContainer.react'),null,c('DOM').create('span',{className:''},' \xB7 ')),t=c('React').createElement(c('DOMContainer.react'),null,c('DOM').create('span',{className:''},this.props.result.unseen_posts.markup));return c('React').createElement('span',{className:"_2tb-"},s,t);}}.bind(this),this.renderLabel=function(){var s=' \u00B7 ',t=this.props.result,u="_53ad"+(this.props.valign&&this.props.token&&this.props.token.props&&this.props.token.props.text.length>0?' '+"_55y-":'')+(!t.category&&!t.subtext?' '+"_2vzo":'')+(!t.category&&!!t.subtext||t.category&&t.category.toString().indexOf(s)<0&&!t.subtext?' '+"_2vzp":'')+(t.category&&!!t.subtext||t.category&&t.category.toString().indexOf(s)>0?' '+"_2vzq":''),v=this.renderUnseenPosts(),w=c('React').createElement('span',{className:u},this.renderText(),this.props.hideBadge?null:this.renderBadge(),v,this.props.token),x="_7gk"+(this.props.message?' '+"_5byz":'');return (c('React').createElement('span',{className:x},w,this.props.message));}.bind(this),this.renderMain=function(){var s=c('React').createElement('a',{className:"_6i1",href:this.props.result.uri},c('React').createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel(),this.renderSecondaryIcon()));if(this.props.result.isAsync)s=c('React').createElement('a',{className:"_6i1",href:'#',ajaxify:this.props.result.asyncURI,rel:'async'},c('React').createElement('span',null,this.props.icon||this.renderIcon(),this.renderLabel(),this.renderSecondaryIcon()));return (c('React').createElement('span',{className:"_205",rel:'ignore'},this.renderActivityLogXButton(),s));}.bind(this),this.renderActivityLogXButton=function(){if(this.props.result.keywordBootstrapType!==c('FacebarJSConstants').keywordBootstrapTypes.recent)return null;var s=new (c('URI'))('/me/allactivity');s.setQueryData({privacy_source:'activity_log',log_filter:c('TimelineFilterOptions').SEARCH});return (c('React').createElement(c('XUICloseButton.react'),{size:'medium',className:"_2d9t",href:s}));}.bind(this),this.renderDebug=function(){return this.props.result.debug?c('React').createElement(c('FacebarTypeaheadDebugPane.react'),{result:this.props.result}):null;}.bind(this),n;}m.prototype.render=function(){'use strict';var n="_202"+(' '+"_5bl2")+(' '+"_6_k")+(c('FacebarGlobalOptions').graphSearchV2?' '+"_1et7":'')+(c('FacebarGlobalOptions').renderKeywordSnippets?' '+"_28vg":'')+(this.props.result.isCelebrity?' '+"_5g-n":'')+(this.props.result.isSeeMore?' '+"_qbs":'')+(this.props.result.isInjectedSuggestion?' '+"_3kxm":'')+(this.props.result.isTrending||this.props.result.isHappeningNow?' '+"_5g-o":'')+(this.props.result.isRecent?' '+"_jsd":'')+(this.props.result.isLocal&&!c('FacebarGlobalOptions').useBlueLocalIcon?' '+"_1821":'')+(this.props.result.isLocal&&c('FacebarGlobalOptions').useBlueLocalIcon?' '+"_xui":'')+(this.props.result.isFootball?' '+"_1822":'')+(this.props.result.isHashtag?' '+"_4z1b":'')+(this.props.result.isPersonSERP?' '+"_4xfx":'')+(this.props.result.isPhotos?' '+"_4z1c":'')+(this.props.result.isVideos?' '+"_4z1d":'')+(this.props.result.isInvalidated?' '+"_44vm":'');return (c('React').createElement('li',{className:c('joinClasses')(n,this.props.className),onClick:this.props.onClick,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,role:'option'},this.renderMain(),this.renderDebug()));};m.propTypes={result:k.object.isRequired,className:k.string,icon:k.object,token:k.object,highlight:k.array,prefix:k.string,message:k.object,valign:k.bool,recentSearchItem:k.bool};m.defaultProps={valign:true};f.exports=m;},null);
__d('FacebarTypeaheadToken.react',['cx','FacebarTypeaheadHighlightedText.react','React'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=' \u00B7 ';i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){'use strict';var n=this.props.text;if(this.props.limit)n.splice(this.props.limit);n.forEach(function(r,s){if(s!==0||this.props.leadingMiddot)n[s]=l+r;}.bind(this));var o=c('React').createElement(c('FacebarTypeaheadHighlightedText.react'),{className:this.props.mainClass,tokens:this.props.highlight,text:n.shift()}),p=n.length?c('React').createElement(c('FacebarTypeaheadHighlightedText.react'),{tokens:this.props.highlight,className:"_53ab",text:n.join('')}):null,q=this.props.innerClass||"_53aa";return (c('React').createElement('span',{className:"_53a9"},c('React').createElement('span',{className:q},o,p)));};function m(){'use strict';i.apply(this,arguments);}m.propTypes={text:k.array.isRequired,highlight:k.array,limit:k.number,mainClass:k.string,innerClass:k.string,leadingMiddot:k.bool,category:k.string};f.exports=m;},null);
__d('FacebarTypeaheadTokenText',['HTML','FbtResult','getElementText'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='\u00B7';function i(m){if(m instanceof c('FbtResult')){return m.toString();}else if(typeof m==='object'){return c('getElementText')(c('HTML')(m).getRootNode());}else return m||'';}function j(m){return i(m).split(h).map(function(n){return n.trim();});}function k(m){var n={};return m.filter(function(o){var p=!n[o];n[o]=true;return p&&o;});}var l={textForEntity:function(m,n){var o=m.category||n[m.type]||'',p=m.subtext||'',q=m.boldedSubtext||'',r=j(o).concat(j(q)).concat(j(p));return k(r);},text:function(m){return k(j(m));}};f.exports=l;},null);
__d('FacebarTypeaheadEntityItem.react',['cx','FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','Image.react','React','TypeaheadFacepileX.react','joinClasses'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=j.constructor).call.apply(m,[this].concat(o)),this.renderToken=function(){return (c('React').createElement(c('FacebarTypeaheadToken.react'),{highlight:this.getHighlightTokens(),text:c('FacebarTypeaheadTokenText').textForEntity(this.props.result,{}),category:this.props.result.category}));}.bind(this),this.renderIcon=function(){if(this.props.result.isNullState){var q=this.props.result.icon_class?c('React').createElement('span',{className:this.props.result.icon_class}):c('React').createElement(c('Image.react'),{className:"_20h",src:this.props.result.photo});return (c('React').createElement('span',{className:!c('FacebarGlobalOptions').renderKeywordSnippets?"_k83":''},q));}if(this.props.result.size>1&&this.props.result.photos){return (c('React').createElement(c('TypeaheadFacepileX.react'),{className:"_51l_",photos:this.props.result.photos,size:this.props.result.size}));}else if(this.props.result.photo)return (c('React').createElement(c('Image.react'),{className:"_20h",alt:'',src:this.props.result.photo}));}.bind(this),this.getHighlightTokens=function(){if(this.props.result.original_query){var q=this.props.result.original_query.toString().trim(),r=q.split(' '),s=r.length>1?[q].concat(r):[q];return s.filter(function(t){return t!=='';});}}.bind(this),l;}k.prototype.render=function(){'use strict';var l=this.props.className;if(this.props.result.isNullState)l=c('joinClasses')(this.props.className,!c('FacebarGlobalOptions').renderKeywordSnippets?"_207":'');return (c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{className:l,icon:this.renderIcon(),token:this.renderToken(),highlight:this.getHighlightTokens(),valign:true})));};f.exports=k;},null);
__d('FacebarTypeaheadGrammarItem.react',['cx','fbt','React','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','joinClasses'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l={user:i._("Person")};j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.renderToken=function(){var s=this.props.result.decoration,t=this.props.result.ambiguity,u=t&&t.text,v=s&&s.entity||t&&t.entity;if(this.props.result.isRecent){var w=i._("Recent search");return (c('React').createElement(c('FacebarTypeaheadToken.react'),{text:[w],innerClass:"_53ab"}));}else if(u){return (c('React').createElement(c('FacebarTypeaheadToken.react'),{text:c('FacebarTypeaheadTokenText').text(u)}));}else if(v)return (c('React').createElement(c('FacebarTypeaheadToken.react'),{text:c('FacebarTypeaheadTokenText').textForEntity(v,l),limit:2,leadingMiddot:true}));}.bind(this),this.getClassName=function(){var s=this.props.result;if(s.isPeopleAndPagesSuggestion)return "_2enu";if(s.tags&&s.tags.displayedSeeMore)return "_10gs";return "_207";}.bind(this),n;}m.prototype.render=function(){'use strict';var n=this.renderToken(),o=n&&!n.props.leadingMiddot;return (c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,this.getClassName()),valign:o,token:n})));};f.exports=m;},null);
__d('FacebarTypeaheadKeywordItem.react',['cx','fbt','FacebarGlobalOptions','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','FacebarTypeaheadTokenText','React','joinClasses'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;l.prototype.render=function(){'use strict';var m=[i._("Search Facebook")];if(this.props.result.isTrending){m.push(i._("Trending"));}else if(this.props.result.type=='related')m=[i._("Related search")];if(c('FacebarGlobalOptions').renderKeywordSnippets){var n=c('FacebarTypeaheadTokenText').textForEntity(this.props.result,{});if(n&&n.length)m=n;}var o=c('FacebarGlobalOptions').renderKeywordSnippets&&n!=null&&(n.length>1||this.props.result.boldedSubtext!=null),p=this.props.result.isSeeMore,q=p?null:c('React').createElement(c('FacebarTypeaheadToken.react'),{text:m,mainClass:(o?"_4jt7":'')+(o&&this.props.result.isSpecialIntent&&!this.props.result.isLocal?' '+"_21z1":'')+(o&&this.props.result.isLocal&&!c('FacebarGlobalOptions').useBlueLocalIcon?' '+"_2xfl":'')+(o&&this.props.result.isLocal&&c('FacebarGlobalOptions').useBlueLocalIcon?' '+"_2t_t":'')+(o&&this.props.result.isPersonSERP?' '+"_46_o":'')+(o&&this.props.result.isPhotos?' '+"_21z2":'')+(o&&this.props.result.isVideos?' '+"_21z4":'')+(o&&this.props.result.isSingleState&&this.props.result.exactMatchKeyword&&!this.props.result.isLocal?' '+"_21z5":''),innerClass:"_53ab"});return (c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,(!c('FacebarGlobalOptions').renderKeywordSnippets?"_207":'')+(' '+"_5d77")),token:q,prefix:this.props.result.query_string.toLowerCase(),showSecondaryIcon:c('FacebarGlobalOptions').showKeywordSuggestionPhotos})));};function l(){'use strict';j.apply(this,arguments);}f.exports=l;},null);
__d('FacebarTypeaheadKeywordOnlyItem.react',['cx','FacebarTypeaheadItem.react','FacebarURI','KeywordsSearchResultConfig','React','URI','joinClasses'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){'use strict';var l=this.props.result.structure.toString(),m=c('FacebarURI').getQualifiedURI(new (c('URI'))(c('KeywordsSearchResultConfig').seo_top_url).addQueryData('q',l.toLowerCase()));return (c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{result:babelHelpers['extends']({},this.props.result,{photo:null,icon_class:null,uri:m}),className:c('joinClasses')(this.props.className,"_207"+(' '+"_5d77")+(' '+"_260s")),prefix:this.props.result.query_string.toLowerCase(),hideBadge:true})));};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('FacebarTypeaheadNodeItem.react',['React','ReactDOM','DOM','isElementNode'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;function j(){var k,l;'use strict';for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return k=(l=i.constructor).call.apply(l,[this].concat(n)),this.attachNode=function(p){var q=this.props.result.node;if(c('isElementNode')(q))c('DOM').setContent(p,q);}.bind(this),k;}j.prototype.render=function(){'use strict';var k=this.props.result.node;return c('React').createElement('li',this.props,!c('isElementNode')(k)?k:null);};j.prototype.componentDidMount=function(){'use strict';this.attachNode(c('ReactDOM').findDOMNode(this));};j.prototype.componentDidUpdate=function(k,l,m){'use strict';this.attachNode(c('ReactDOM').findDOMNode(this));};j.prototype.shouldComponentUpdate=function(k){'use strict';return this.props.result.node!==k.result.node;};f.exports=j;},null);
__d('FacebarTypeaheadRecentItem.react',['cx','FacebarGlobalOptions','FacebarTypeaheadItem.react','Image.react','React','joinClasses'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=j.constructor).call.apply(m,[this].concat(o)),this.renderIcon=function(){var q=this.props.result;if(!c('FacebarGlobalOptions').allowGrammar)return (c('React').createElement(c('Image.react'),{className:"_20h",src:q.photo}));var r=q.icon_class?c('React').createElement('span',{className:q.icon_class}):c('React').createElement(c('Image.react'),{className:"_20h",src:q.photo});return (c('React').createElement('span',{className:!c('FacebarGlobalOptions').renderKeywordSnippets||q.icon_class&&c('FacebarGlobalOptions').renderKeywordSnippets?"_k83":''},r));}.bind(this),l;}k.prototype.render=function(){'use strict';return c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,!c('FacebarGlobalOptions').renderKeywordSnippets?"_207":''),icon:this.renderIcon(),recentSearchItem:true}));};f.exports=k;},null);
__d('FacebarTypeaheadTrendingItem.react',['cx','FacebarTypeaheadItem.react','FacebarTypeaheadToken.react','React','joinClasses'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){'use strict';var l=this.props.result.articleTitle||'',m=c('React').createElement(c('FacebarTypeaheadToken.react'),{text:[l],innerClass:"_53ab",leadingMiddot:true});return (c('React').createElement(c('FacebarTypeaheadItem.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_207"),token:m,valign:false})));};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('FacebarTypeaheadList.react',['csx','cx','fbt','ARIA','CSS','FacebarGlobalOptions','FacebarJSConstants','FacebarTypeaheadEntityItem.react','FacebarTypeaheadGrammarItem.react','FacebarTypeaheadKeywordItem.react','FacebarTypeaheadKeywordOnlyItem.react','FacebarTypeaheadNodeItem.react','FacebarTypeaheadRecentItem.react','FacebarTypeaheadTrendingItem.react','React','ReactDOM','StaticContainer.react'],function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n={grammar:c('FacebarTypeaheadGrammarItem.react'),trending:c('FacebarTypeaheadTrendingItem.react'),related:c('FacebarTypeaheadKeywordItem.react')};n[c('FacebarJSConstants').browseTypes.keyword]=c('FacebarTypeaheadKeywordItem.react');n[c('FacebarJSConstants').keywordType]=c('FacebarTypeaheadKeywordItem.react');k=babelHelpers.inherits(o,c('React').Component);l=k&&k.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=l.constructor).call.apply(q,[this].concat(s)),this.getItemComponentConstructor=function(u,v){if(u.node)return c('FacebarTypeaheadNodeItem.react');if(c('FacebarGlobalOptions').hasKeywordOnlyTypeahead)return c('FacebarTypeaheadKeywordOnlyItem.react');if(u.isRecent)return c('FacebarTypeaheadRecentItem.react');if(u.results_set_type===c('FacebarJSConstants').browseTypes.keyword)return c('FacebarTypeaheadKeywordItem.react');if(u.type&&n[u.type])return n[u.type];return c('FacebarTypeaheadEntityItem.react');},this.renderItem=function(u,v){var w=this.getItemComponentConstructor(u),x;if(u.type===c('FacebarJSConstants').keywordType){x=u.query_string+u.semantic+u.boldedSubtext+u.subtext+u.fromCache+(u.isSeeMore?'see_more':'')+(u.keywordBootstrapType?u.keywordBootstrapType:'')+(u.uid!=null?u.uid:'')+u.isInvalidated;}else{x=u.semantic||u.uid||u.tuid;x=x+u.isNullState+u.category+u.subtext;}if(c('FacebarGlobalOptions').dymOnEchoOnly)if(u.query_string!==u.text){u.uri.addQueryData({em:'1'});}else u.uri.removeQueryData('em');if(c('FacebarGlobalOptions').noDymOnSingleState)if(u.isSingleState)u.uri.addQueryData({em:'1'});if(c('FacebarGlobalOptions').noDymOnNullState)if(u.isNullState)u.uri.addQueryData({em:'1'});return (c('React').createElement(c('StaticContainer.react'),{key:x},c('React').createElement(w,{result:u,onClick:this.handleClick.bind(null,u),onMouseEnter:this.handleMouseEnter.bind(null,u)})));}.bind(this),this.renderFooter=function(){var u="_3su"+(!this.props.loading?' '+"hidden_elem":'');return (c('React').createElement('li',{className:u},c('React').createElement('div',{className:"_21f"},j._("Finding results"))));}.bind(this),this.hasValidRecentSearches=function(){if(!c('FacebarGlobalOptions').hasRecentSearchNullState||!this.props.results)return false;return this.props.results.some(function(u){return u.isRecent;});}.bind(this),this.handleClick=function(u,v){if(c('CSS').matchesSelector(v.target,"._2d9t"))return;if(!v.nativeEvent.isMiddleClick()&&!v.nativeEvent.getModifiers().any){this.props.onSelect(u);v.preventDefault();}}.bind(this),this.handleMouseEnter=function(u){this.props.onHighlight(u);}.bind(this),this.handleMouseLeave=function(){if(c('FacebarGlobalOptions').facebarTypeaheadMouseoutHighlight)this.props.onClearHighlight();}.bind(this),p;}o.prototype.componentDidMount=function(){'use strict';var p=c('ReactDOM').findDOMNode(this);c('ARIA').owns(this.props.accessibilityElement,p);};o.prototype.render=function(){'use strict';var p=this.props.results,q=[];if(p)p.forEach(function(r){q.push(this.renderItem(r));},this);return c('React').createElement('div',null,c('React').createElement('ul',{id:'facebar_typeahead_view_list',className:"_21c"+(this.props.isKeywordList?' '+"_2yob":''),'data-click':'Search',onMouseLeave:this.handleMouseLeave,role:'listbox'},q,this.renderFooter()));};o.prototype.componentDidUpdate=function(p,q,r){'use strict';this.props.onRender();};o.prototype.shouldComponentUpdate=function(p){'use strict';return this.props.loading!==p.loading||this.props.results!==p.results;};o.propTypes={results:m.array,onRender:m.func,onSelect:m.func.isRequired,onHighlight:m.func.isRequired,isKeywordList:m.bool};f.exports=o;},null);
__d('FacebarTypeaheadView',['csx','cx','fbt','Arbiter','CSS','ContextualLayer','ContextualLayerUpdateOnScroll','DOM','FacebarGlobalOptions','FacebarJSConstants','FacebarStructuredText','FacebarTypeaheadList.react','Link.react','Parent','React','ReactDOM','ScriptPath','Style','TypeaheadView','URI','performanceNow'],function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();var m='unimplemented';k=babelHelpers.inherits(n,c('TypeaheadView'));l=k&&k.prototype;function n(o,p){'use strict';l.constructor.call(this,o,p);this.element=o;this.sid='';this.index=-1;this.warningShown=false;this.autoSelect=false;this.flipCount=0;this.loading=false;this.handleClearHighlight=this.handleClearHighlight.bind(this);this.handleHighlight=this.handleHighlight.bind(this);this.handleRender=this.handleRender.bind(this);this.handleSelect=this.handleSelect.bind(this);this.events=['highlight','render','filter','show'];}n.prototype.init=function(){'use strict';this.initializeElements();};n.prototype.initGSV2Elements=function(){'use strict';var o=this.element;this.contentKeyword=c('DOM').find(o,"._f7s");this.contentEntity=c('DOM').find(o,"._2pda");this.contentRecent=c('DOM').find(o,"._mn8");this.contentSuggestion=c('DOM').find(o,"._2pl-");this.contentSeeMore=c('DOM').find(o,"._3-xd");this.keywordResultsContainer=c('DOM').create('div');this.entityResultsContainer=c('DOM').create('div');this.recentSearchContainer=c('DOM').create('div');this.seeMoreContainer=c('DOM').create('div');this.results=[];this.keywordResults=[];this.entityResults=[];};n.prototype.initGSV2Construct=function(){'use strict';this.currentKeywordContainer=this.contentKeyword;this.currentEntityContainer=this.contentEntity;this.contentKeyword.appendChild(this.keywordResultsContainer);this.contentEntity.appendChild(this.entityResultsContainer);this.contentRecent.appendChild(this.recentSearchContainer);this.contentSeeMore.appendChild(this.seeMoreContainer);if(this.isNullState()){if(c('FacebarGlobalOptions').hasRecentOnTopNullState){this.resultsContainer.appendChild(this.contentRecent);this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentRecent);this.resultsContainer.appendChild(this.contentEntity);}return;}if(this.entityTop){this.resultsContainer.appendChild(this.contentEntity);this.resultsContainer.appendChild(this.contentKeyword);}else{this.resultsContainer.appendChild(this.contentKeyword);this.resultsContainer.appendChild(this.contentEntity);}if(!this.isNullState())this.resultsContainer.appendChild(this.contentSeeMore);};n.prototype.initializeElements=function(){'use strict';var o=this.element;this.isGSV2=c('FacebarGlobalOptions').graphSearchV2;this.dynamicRank=this.isGSV2;this.fixedBlendingOrder=c('FacebarGlobalOptions').blendingOrderKeywordFirst||c('FacebarGlobalOptions').blendingOrderEntityFirst;this.entityTop=c('FacebarGlobalOptions').blendingOrderEntityFirst&&!c('FacebarGlobalOptions').renderKeywordsFirst;this.content=c('DOM').find(o,"._21r");this.warningNode=c('DOM').find(o,"._553e");this.blockNotificationNode=c('DOM').find(o,"._2hh");this.resultsContainer=c('DOM').create('div');if(this.isGSV2)this.initGSV2Elements();};n.prototype.initializeList=function(){'use strict';this.renderTypeaheadList();this.content.appendChild(this.resultsContainer);if(this.isGSV2)this.initGSV2Construct();};n.prototype.initializeLayer=function(){'use strict';this.layer=new (c('ContextualLayer'))({context:c('Parent').bySelector(this.causalElement,"._585-"),position:'below',causalElement:this.causalElement},this.element).enableBehavior(c('ContextualLayerUpdateOnScroll'));var o=this.layer.getContentRoot();this.root=c('DOM').find(o,"._50c9");c('CSS').addClass(o,"_5tlx");if(this.isGSV2)c('CSS').addClass(o,"_5xzd");this.wrapper=o;};n.prototype.setInputElement=function(o){'use strict';this.setAccessibilityControlElement(o);this.causalElement=o;this.initializeLayer();this.initializeList();};n.prototype.setAutoSelect=function(o){'use strict';this.autoSelect=o;if(this.index===-1&&o)this.first();};n.prototype.getIndexOf=function(o,p){'use strict';for(var q=0;q<p.length;q++)if(o.semantic===p[q].semantic&&o.isSeeMore===p[q].isSeeMore&&o.text===p[q].text)return q;return -1;};n.prototype.handleClearHighlight=function(){'use strict';this.highlight(-1,false);};n.prototype.handleHighlight=function(o){'use strict';this.highlight(this.getIndexOf(o,this.results),false);};n.prototype.handleSelect=function(o){'use strict';this.handleHighlight(o);this.select(true);};n.prototype.show=function(o){'use strict';if(!this.visible){this.inform('beforeShow',this.layer);c('Style').set(this.wrapper,'minWidth',o+'px');var p=l.show.call(this);this.first();this.layer.show();this.layer.updatePosition();this.inform('show');c('Arbiter').inform('layer_shown',{type:'FacebarTypeahead'});return p;}};n.prototype.hide=function(){'use strict';if(this.visible){this.layer.hide();l.hide.call(this);this.inform('hide');c('Arbiter').inform('layer_hidden',{type:'FacebarTypeahead'});this.flipCount=0;}return this;};n.prototype.select=function(o){'use strict';var p=this.results&&this.results[this.index];if(!p){this.inform('quickSelect');return;}var q=this.inform('beforeSelect',{index:this.index,selected:p});if(q!==false){c('ScriptPath').setClickPointInfo({click:'Search'});l.select.call(this,o);}};n.prototype.doesResultBelongToEntitySection=function(o){'use strict';switch(o.type){case c('FacebarJSConstants').keywordType:return !!o.isRecent;case c('FacebarJSConstants').grammarType:return o.tags&&o.tags.displayedSeeMore;default:return !c('FacebarGlobalOptions').hasKeywordOnlyTypeahead;}};n.prototype.processGSV2Results=function(o){'use strict';this.keywordResults=[];this.entityResults=[];var p=[],q=[],r=[],s=o.some(function(t){return t.isSingleState;});o.forEach(function(t){if(this.doesResultBelongToEntitySection(t)){this.entityResults.push(t);}else if(s){if(t.alternateSemantic){q.push(t);}else if(t.exactMatchKeyword){r.push(t);}else p.push(t);}else this.keywordResults.push(t);}.bind(this));if(s)this.keywordResults=r.concat(q.concat(p));if(this.entityTop)return this.entityResults.concat(this.keywordResults);return this.keywordResults.concat(this.entityResults);};n.prototype.reGenerateContainer=function(o){'use strict';var p=c('DOM').create('div');if(this.isNullState()){if(c('FacebarGlobalOptions').hasRecentOnTopNullState){p.appendChild(this.contentRecent);p.appendChild(this.currentKeywordContainer);p.appendChild(this.currentEntityContainer);}else{p.appendChild(this.currentKeywordContainer);p.appendChild(this.contentRecent);p.appendChild(this.currentEntityContainer);}return p;}if(this.entityTop){p.appendChild(this.currentEntityContainer);p.appendChild(this.currentKeywordContainer);}else{p.appendChild(this.currentKeywordContainer);p.appendChild(this.currentEntityContainer);}if(!this.isNullState()&&!o)p.appendChild(this.contentSeeMore);return p;};n.prototype.buildResultsNoRegeneration=function(o,p){'use strict';if(this.dynamicRank&&o.length>0&&!this.fixedBlendingOrder&&!c('FacebarGlobalOptions').renderKeywordsFirst&&this.flipCount<2){var q=o[0].type!==c('FacebarJSConstants').keywordType;if(c('FacebarGlobalOptions').hasFlipOnce&&this.value.toString()&&this.entityTop!=q)this.flipCount++;this.entityTop=q;}var r=String(this.value);o.forEach(function(u){u.query_string=r;});this.results=o;if(this.isGSV2){if(c('FacebarGlobalOptions').disableKeywords)o=o.filter(function(u){return u.semantic!=null&&u.semantic.match(/^[0-9]+$/)!=null;});this.results=this.processGSV2Results(o);if(this.seeMoreResult){var s=this.results.indexOf(this.seeMoreResult);if(s>-1)this.results.splice(s,1);this.seeMoreResult=null;}if(!this.isNullState()&&!p){this.seeMoreResult=this.inform('seeMore',{value:r,results:this.results});if(this.seeMoreResult){this.results.push(this.seeMoreResult);this.inform('afterSeeMore',{results:this.results});}}}var t=c('performanceNow')();this.renderTypeaheadList({results:this.results,loading:this.loading});this.inform('logPerformanceTiming',{field:'build_results_set_props_duration',value:c('performanceNow')()-t});};n.prototype.buildResults=function(o){'use strict';var p=o.some(function(q){return q.isSingleState;});this.buildResultsNoRegeneration(o,p);if(this.dynamicRank)this.resultsContainer=this.reGenerateContainer(p);return this.resultsContainer;};n.prototype.getGSV2Items=function(){'use strict';return l.getItems.call(this).filter(function(o){return !c('CSS').matchesSelector(o,"._3su");});};n.prototype.getItems=function(){'use strict';if(this.isGSV2)return this.getGSV2Items();return l.getItems.call(this).slice(0,-1);};n.prototype.handleRender=function(){'use strict';this.items=this.getItems();};n.prototype.render=function(o,p,q,r){'use strict';this.inform('filter',{results:p,value:o});var s=!o||o instanceof c('FacebarStructuredText')&&o.isEmptyOrWhitespace();c('CSS').conditionClass(this.wrapper,"_5qz2",!p.length&&s&&!this.getMegaphone());var t=p[0];if(r&&!s){if(!this.isGSV2)this.showWarning(j._("There are no results for '{query}'",[j.param('query',o.toString())]));}else if(t&&t.results_set_type===m){if(!t.error_info.suppress)this.showWarning(t.error_info.errorMessage||j._("This search isn't currently supported."));}else this.hideWarning();if(this.inform('removeUnimplementedGrammar')!==false)p=p.filter(function(u){return u.results_set_type!==m;}.bind(this));l.render.call(this,o,p,q);};n.prototype.reset=function(){'use strict';this.index=-1;this.items=[];this.results=[];this.value='';this.buildResults([]);this.inform('reset');return this;};n.prototype.resetIndex=function(){'use strict';this.index=-1;};n.prototype.getMegaphone=function(){'use strict';return c('DOM').scry(this.element,'.megaphone_location_gsv2_typeahead')[0];};n.prototype.showBlockNotification=function(o){'use strict';var p=new (c('URI'))('https://www.facebook.com').setPath('/settings').addQueryData('tab','blocking'),q=c('React').createElement('div',null,j._("You've blocked {fullName}. For more info on privacy and blocking, go to your {settings}.",[j.param('fullName',o),j.param('settings',c('React').createElement(c('Link.react'),{href:{url:p}},j._("settings")))]));c('CSS').show(this.blockNotificationNode);c('ReactDOM').render(q,this.blockNotificationNode);};n.prototype.hideBlockNotification=function(){'use strict';c('CSS').hide(this.blockNotificationNode);c('DOM').setContent(this.blockNotificationNode,'');};n.prototype.showWarning=function(o){'use strict';c('CSS').show(this.warningNode);c('DOM').setContent(this.warningNode,o);this.warningShown=true;this.highlight(-1,false);};n.prototype.hideWarning=function(){'use strict';c('CSS').hide(this.warningNode);this.warningShown=false;this.highlight(this.index,false);};n.prototype.setLoading=function(o){'use strict';if(this.loading!=o){this.loading=o;this.renderTypeaheadList({results:this.results,loading:o});}};n.prototype.first=function(){'use strict';this.index=this.autoSelect?0:-1;this.highlight(this.index);};n.prototype.prev=function(){'use strict';if(this.isGSV2){if(this.index<0||this.index===0&&this.autoSelect)this.index=this.items.length;}else if(this.index<=0)this.index=this.items.length;this.ignoreMouseover=true;l.prev.call(this);};n.prototype.next=function(){'use strict';if(this.isGSV2&&this.autoSelect&&this.index>=this.items.length-1)this.index=-1;if(!this.isGSV2&&this.index+1>=this.items.length)this.index=-1;this.ignoreMouseover=true;l.next.call(this);};n.prototype.highlight=function(o,p){'use strict';p=p!==false&&this.index!=o;if(!p||this.inform('beforeHighlight')!==false){var q=this.warningShown||!this.autoSelect?-1:0;l.highlight.call(this,Math.max(q,o),p);}};n.prototype.isNullState=function(){'use strict';return !String(this.value).trim();};n.prototype.updateCurrentKeywordContainer=function(){'use strict';var o=this.currentKeywordContainer;if(this.isNullState()){this.currentKeywordContainer=this.contentSuggestion;}else this.currentKeywordContainer=this.contentKeyword;if(o&&o!==this.currentKeywordContainer){c('CSS').hide(o);o.removeChild(this.keywordResultsContainer);this.currentKeywordContainer.appendChild(this.keywordResultsContainer);}};n.prototype.updateCurrentEntityContainer=function(){'use strict';var o=this.currentEntityContainer,p=!String(this.value).trim();if(p&&this.entityResults){this.currentEntityContainer=this.contentEntity;}else this.currentEntityContainer=this.contentEntity;if(o&&o!=this.currentEntityContainer){c('CSS').hide(o);o.removeChild(this.entityResultsContainer);this.currentEntityContainer.appendChild(this.entityResultsContainer);}};n.prototype.hasValidRecentSearches=function(){'use strict';if(!c('FacebarGlobalOptions').hasRecentSearchNullState||!this.keywordResults)return false;return this.keywordResults.some(function(o){return o.isRecent;});};n.prototype.copyProps=function(o){'use strict';return babelHelpers['extends']({accessibilityElement:this.accessibilityElement,onClearHighlight:this.handleClearHighlight,onHighlight:this.handleHighlight,onRender:this.handleRender,onSelect:this.handleSelect},o);};n.prototype.renderList=function(o,p){'use strict';c('ReactDOM').render(c('React').createElement(c('FacebarTypeaheadList.react'),this.copyProps(o)),p);};n.prototype.renderGSV2TypeaheadList=function(o){'use strict';var p=this.copyProps(Object.assign({},o,{isKeywordList:true})),q=this.copyProps(o),r=this.copyProps(Object.assign({},o,{isKeywordList:true}));p.results=this.isNullState()?this.keywordResults.filter(function(v){return !v.isRecent;}):this.keywordResults;r.results=this.isNullState()?[]:this.results.filter(function(v){return v.isSeeMore;});q.results=this.entityResults.filter(function(v){return !v.isRecent;});if(r.results.length>0||this.isNullState()){p.loading=false;q.loading=false;}else if(this.entityTop||q.results.length===0){q.loading=false;}else p.loading=false;var s=!!q.results.length,t=!!p.results.length;this.renderList(p,this.keywordResultsContainer);this.renderList(q,this.entityResultsContainer);var u=false;if(this.isNullState()){q.results=this.entityResults.filter(function(v){return !!v.isRecent;});this.renderList(q,this.recentSearchContainer);u=!!q.results.length;}this.updateCurrentKeywordContainer();this.updateCurrentEntityContainer();this.renderList(r,this.seeMoreContainer);c('CSS').conditionShow(this.currentKeywordContainer,t);c('CSS').conditionShow(this.contentRecent,u);c('CSS').conditionShow(this.currentEntityContainer,s);c('CSS').conditionShow(this.contentSeeMore,this.seeMoreResult!=null&&!this.isNullState());};n.prototype.renderTypeaheadList=function(o){'use strict';o=o||{};if(this.isGSV2){this.renderGSV2TypeaheadList(o);}else this.renderList(o,this.resultsContainer);};f.exports=n;},null);
__d('DismissNUXOnFocus',['Arbiter','NavigationMessage','Run','SubscriptionsHandler'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.view=i.getCore().view;this.subscriptionsHandler=new (c('SubscriptionsHandler'))();}h.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,function(){this.disable();}.bind(this)));c('Run').onLeave(function(){this.disable();}.bind(this));this.setup();};h.prototype.disable=function(){'use strict';this.teardown();};h.prototype.setup=function(){'use strict';this.subscriptionsHandler.addSubscriptions(this.view.subscribe('show',this.onViewShow.bind(this)));};h.prototype.teardown=function(){'use strict';this.subscriptionsHandler.release();};h.prototype.onViewShow=function(){'use strict';c('Arbiter').inform('SearchAwareness.weakDismissUnit');};f.exports=h;},null);
__d("XWarmUserRequestArgsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/search\/browse\/warm\/requestargs\/",{query:{type:"String"},csid:{type:"String"}});},null);
__d('FacebarTypeaheadBrowsePreload',['AsyncRequest','XWarmUserRequestArgsController','emptyFunction'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._core=i.core;this._typeahead=i;}h.prototype.enable=function(){'use strict';this._core.subscribe('execute',this.preloadOnNavigate.bind(this));};h.prototype.preloadOnNavigate=function(i,j){'use strict';if(j.type==='keyword'){var k=c('XWarmUserRequestArgsController').getURIBuilder().setString('query',String(j.text));if(j.csid)k.setString('csid',String(j.csid));new (c('AsyncRequest'))().setURI(k.getURI()).setAllowCrossPageTransition(true).send();}};h.prototype.disable=function(){'use strict';c('emptyFunction')();};f.exports=h;},null);
__d('FacebarTypeaheadInjectedSuggestion',['csx','cx','fbt','Arbiter','DOM'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=3,l=0,m;function n(o){'use strict';this.core=o.getCore();this.$FacebarTypeaheadInjectedSuggestion1=this.core.view;}n.prototype.enable=function(){'use strict';c('Arbiter').subscribe('FacebarTypeahead.injectedSuggestion',function(){return this.addSuggestionTextToSearchBox();}.bind(this));c('Arbiter').subscribe('FacebarTypeahead.removeInjectedSuggestion',function(){return this.removeSuggestionTextToSearchBox();}.bind(this));c('Arbiter').subscribe('FacebarTypeahead.showSuggestionBadge',function(){return this.showSuggestionBadge(true);}.bind(this));c('Arbiter').subscribe('FacebarTypeahead.hideSuggestionBadge',function(){return this.showSuggestionBadge(false);}.bind(this));};n.prototype.disable=function(){'use strict';this.$FacebarTypeaheadInjectedSuggestion2.unsubscribe();};n.prototype.showSuggestionBadge=function(o){'use strict';var p=c('DOM').scry(this.core.getElement(),"._5861")[0];if(p){var q=p.getElementsByClassName('injectedSearchSuggestion')[0];if(!q)return;if(o){q.style.visibility='visible';}else q.style.visibility='hidden';}};n.prototype.removeSuggestionTextToSearchBox=function(){'use strict';if(!l)return;--l;if(!l){var o=c('DOM').scry(this.core.getElement(),"._5861")[0],p=o.getElementsByClassName('injectedSearchSuggestion')[0];o.removeChild(p);}else if(m){var q=j._({"suggestion":"{suggestionCount} new suggestion","suggestions":"{suggestionCount} new suggestions"},[j.param('suggestionCount',l),j['enum'](l===1?'suggestion':'suggestions',{suggestion:'suggestion',suggestions:'suggestions'})]);m.innerText=q;}};n.prototype.addSuggestionTextToSearchBox=function(){'use strict';if(l){if(m&&l<k)m.innerText=l+1+' new suggestions';}else{var o=c('DOM').scry(this.core.getElement(),"._5861")[0];if(o){m=document.createElement('DIV');var p=document.createTextNode('1 new suggestion');m.style.cssFloat='right';m.appendChild(p);var q=document.createElement('DIV');q.className="_586j injectedSearchSuggestion";q.appendChild(m);o.appendChild(q);}}l+=1;};f.exports=n;},null);
__d('FacebarTypeaheadNavigation',['Arbiter','FacebarNavigation','emptyFunction'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._core=i.core;this._preserveQuery=false;this._typeahead=i;}h.prototype.enable=function(){'use strict';c('FacebarNavigation').registerBehavior(this);this._core.subscribe('execute',this.executedUserQuery.bind(this));};h.prototype.executedUserQuery=function(i,j){'use strict';this._preserveQuery=true;};h.prototype.pageTransition=function(){'use strict';if(!this._preserveQuery){this._core.close();this._core.reset();}else this._preserveQuery=false;};h.prototype.setPageQuery=function(i){'use strict';i=this._core.setPageQuery(i);this._typeahead.inform('navigation',i,c('Arbiter').BEHAVIOR_PERSISTENT);};Object.assign(h.prototype,{disable:c('emptyFunction')});f.exports=h;},null);
__d('FacebarTypeaheadPrefixLengthOrderedCache',['emptyFunction','Arbiter'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._typeahead=i;}h.prototype.enable=function(){'use strict';this._typeahead.data.inform('setSortFunction',function(i,j){if((i.keyword_type==='local'||i.keyword_type==='local_category')&&(j.keyword_type==='local'||j.keyword_type==='local_category'))return 0;if(i.cache_id_length!==j.cache_id_length)return i.cache_id_length-j.cache_id_length;var k=(i.cost||0)-(j.cost||0);if(k!==0)return k;return (i.semantic||'').localeCompare(j.semantic||'');},c('Arbiter').BEHAVIOR_STATE);};Object.assign(h.prototype,{disable:c('emptyFunction')});f.exports=h;},null);
__d('FacebarTypeaheadQuickSelect',['FacebarStructuredText','URI'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='/search/web/direct_search.php';function i(j){'use strict';this._core=j.getCore();this._view=j.getView();this._input=this._core.input;this._beforeSelectListener=null;this._quickSelectListener=null;}i.prototype.enable=function(){'use strict';this._beforeSelectListener=this._view.subscribe('beforeSelect',this._quickSelect.bind(this));this._quickSelectListener=this._view.subscribe('quickSelect',this._quickSelect.bind(this));};i.prototype._quickSelect=function(j,k){'use strict';if(k&&k.selected)return true;var l=this._input.getValue().toArray(),m=new (c('FacebarStructuredText'))(l),n=m.toString();if(!n)return true;var o=new (c('URI'))(h).addQueryData('q',n),p={input_query:n,type:'quickselect',text:n,position:0,with_mouse:0,semantic:'quickselect('+o.toString()+')',extra_uri_params:{source:'quickselect',sid:this._core.getSessionID()},uri:o};this._core.inform('quickSelectRedirect',p);this._core.executeQuery(p);return false;};i.prototype.disable=function(){'use strict';this._beforeSelectListener&&this._view.unsubscribe(this._beforeSelectListener);this._quickSelectListener&&this._view.unsubscribe(this._quickSelectListener);};f.exports=i;},null);
__d('FacebarTypeaheadRecorderBasic',['FacebarTypeaheadRecorder'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._typeahead=i;}h.prototype.enable=function(){'use strict';var i=this._typeahead;this._recorder=new (c('FacebarTypeaheadRecorder'))(i);};h.prototype.disable=function(){'use strict';this._typeahead.unsubscribe(this._subscription);this._recorder=null;this._subscription=null;};Object.assign(h.prototype,{_subscription:null});f.exports=h;},null);
__d('FacebarTypeaheadSeeMore',['cx','fbt','FacebarGSv2Echo','FacebarJSConstants','FacebarKeywordSearchUtils','FacebarStructuredText'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this.$FacebarTypeaheadSeeMore1=k.getCore();this.$FacebarTypeaheadSeeMore2=this.$FacebarTypeaheadSeeMore1.view;}j.prototype.enable=function(){'use strict';this.$FacebarTypeaheadSeeMore3=this.$FacebarTypeaheadSeeMore2.subscribe('seeMore',this.$FacebarTypeaheadSeeMore4.bind(this));};j.prototype.disable=function(){'use strict';this.$FacebarTypeaheadSeeMore3.unsubscribe();};j.prototype.$FacebarTypeaheadSeeMore4=function(k,l){'use strict';var m=l.value.toString().trim();m=c('FacebarGSv2Echo').normalizeValue(m);var n=c('FacebarKeywordSearchUtils').makeFacebarEntry(m),o=i._("See all results for \"{query}\"",[i.param('query',m)]);return babelHelpers['extends']({},n,{query_string:m,icon_class:"_5b1w",isSeeMore:true,structure:c('FacebarStructuredText').fromString(m),displayStructure:c('FacebarStructuredText').fromString(String(o)),uri:n.uri,tags:{},isSingleState:this.$FacebarTypeaheadSeeMore1.data.getSingleState(),keywordType:c('FacebarJSConstants').keywordTypes.escape,keywordSource:c('FacebarJSConstants').keywordTypes.escape});};f.exports=j;},null);
__d('FacebarTypeaheadSelectAll',['requestAnimationFrame'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._core=i.getCore();this._listener=null;}h.prototype.enable=function(){'use strict';var i=this._core.input;this._listener=this._core.subscribe('focus',function(j,k){var l=k&&k.catchup;l||c('requestAnimationFrame')(function(){i.selectInput();});});};h.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=h;},null);
__d('FacebarTypeaheadShortcut',['KeyEventController','Run','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._input=i.core.input;this._view=i.view;this._listener=null;}h.prototype.enable=function(){'use strict';this._registerListener();};h.prototype.disable=function(){'use strict';};h.prototype._registerListener=function(){'use strict';this._listener&&this._listener.remove();this._listener=c('KeyEventController').registerKey('SLASH',this._handleKeydown.bind(this));c('Run').onLeave(function(){c('setTimeoutAcrossTransitions')(this._registerListener.bind(this),0);}.bind(this));};h.prototype._handleKeydown=function(i){'use strict';var j=i.getModifiers().shift;if(j)return;this._selectInput();return false;};h.prototype._selectInput=function(){'use strict';this._view.setAutoSelect(true);this._input.focus();this._input.selectInput();this._input.inform('shortcut',{shift:false});};f.exports=h;},null);
__d('FacebarTypeaheadStickyFilters',['Arbiter','NavigationMessage','Run','SubscriptionsHandler','enumerate','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=false,i=5000,j='/search/top';function k(l){'use strict';this.core=l.getCore();this.filters={};this.subscriptionsHandler=new (c('SubscriptionsHandler'))();this.view=this.core.view;}k.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(c('Arbiter').subscribe('SearchLHCFilters.initStickyFilters',function(l,m){for(var n=c('enumerate')(this.filters),o=Array.isArray(n),p=0,n=o?n:n[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var q;if(o){if(p>=n.length)break;q=n[p++];}else{p=n.next();if(p.done)break;q=p.value;}var r=q,s=r[0],t=r[1];if(!(s in m))t.active=false;}for(var u=c('enumerate')(m),v=Array.isArray(u),w=0,u=v?u:u[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var x;if(v){if(w>=u.length)break;x=u[w++];}else{w=u.next();if(w.done)break;x=w.value;}var y=x,z=y[0],aa=y[1],ba={value:aa,active:true};this.filters[z]=ba;}}.bind(this)),c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,function(event,l){this.resetFiltersIfNotSearching();}.bind(this)),this.view.subscribe('filter',this.handleFilter.bind(this)),this.core.subscribe('magSearch',this.handleSearch.bind(this)),this.view.subscribe('afterSeeMore',this.handleSeeMore.bind(this)));c('Run').onLeave(function(){this.resetFiltersIfNotSearching();}.bind(this));};k.prototype.disable=function(){'use strict';this.teardown();};k.prototype.teardown=function(){'use strict';this.subscriptionsHandler.release();};k.prototype.handleFilter=function(l,m){'use strict';var n=m.results.filter(function(o){return !o.isNullState&&!o.isTrending;});this.updateResultData(n);};k.prototype.handleSearch=function(l,m){'use strict';this.updateResultData([m]);};k.prototype.handleSeeMore=function(l,m){'use strict';var n=m.results.filter(function(o){return o.isSeeMore;});this.updateResultData(n);};k.prototype.resetFiltersIfNotSearching=function(){'use strict';if(h)return;h=true;c('setTimeoutAcrossTransitions')(function(){var l=window.location.pathname;if(l.indexOf(j)===-1)for(var m=c('enumerate')(this.filters),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++];}else{o=m.next();if(o.done)break;p=o.value;}var q=p,r=q[1];r.active=false;}h=false;c('Run').onLeave(function(){this.resetFiltersIfNotSearching();}.bind(this));}.bind(this),i);};k.prototype.updateResultData=function(l){'use strict';for(var m=0;m<l.length;m++){var n=l[m];if(n.type==='keyword'){var o=n.uri.getQueryData();for(var p=c('enumerate')(this.filters),q=Array.isArray(p),r=0,p=q?p:p[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var s;if(q){if(r>=p.length)break;s=p[r++];}else{r=p.next();if(r.done)break;s=r.value;}var t=s,u=t[0],v=t[1];if(v.active){o[u]=v.value;}else n.uri.removeQueryData(u);}}}};f.exports=k;},null);
__d('SearchAwarenessLearningNUX',['csx','cx','Arbiter','CSS','DOM','FunnelLogger','NavigationMessage','Run','SearchAwarenessDispatcher','SearchAwarenessWebConfig','SearchPivotType','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='WWW_SEARCH_AWARENESS_LEARNING_NUX_FUNNEL';function k(l){'use strict';this.core=l.getCore();this.view=this.core.view;this.data=this.core.data;this.debug=false;this.subscriptionsHandler=new (c('SubscriptionsHandler'))();this.showingFirstStep=true;this.setupComplete=false;this.setupSecondStepComplete=false;this.hasSpaceForToolTip=true;this.secondStepPivot=c('SearchPivotType').LEARNING_NUX_SECOND_STEP;this.config={aw_id:null,ghost_text:null,block_ta_entity_clicks:null,activation_window:0,encoded_query:null,actor_id:null,story_id:null,global_share_id:null,search_suggestion_unit_style:null,show_second_step:null};this.firstStepPivot=c('SearchPivotType').LEARNING_NUX_STANDALONE;}k.prototype.enable=function(){'use strict';var l=this.core.getValue()!=null?this.core.getValue().toString():null;if(l==null||l.length>0&&!this.data.getSingleState())return;this.subscriptionsHandler.addSubscriptions(c('Arbiter').subscribe('SearchAwareness.triggerLearningNUX',function(m,n){if(n.origin===c('SearchPivotType').LEARNING_NUX||n.origin===c('SearchPivotType').LEARNING_NUX_STANDALONE||n.origin===c('SearchPivotType').TRIGGERED_LEARNING_NUX){this.firstStepPivot=n.origin;this.setup();}else this.setupSecondStep();}.bind(this)),c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,function(){this.disable();}.bind(this)),c('Arbiter').subscribe('SearchAwareness.dismissUnit',function(){c('FunnelLogger').appendAction(j,'clicked_dismiss_button');if(this.config.search_suggestion_unit_style==='typeahead_tooltip')c('CSS').removeClass(this.view.getElement(),"_55mg");}.bind(this)),this.core.subscribe('change',function(){if(this.config.search_suggestion_unit_style==='typeahead_tooltip'){c('CSS').removeClass(this.view.getElement(),"_55mf");c('CSS').removeClass(this.view.getElement(),"_55mg");}}.bind(this)),c('Arbiter').subscribe('SearchAwarenessTriggeredLearningNUX.dismiss',function(){this.disable();}.bind(this)));c('Run').onLeave(function(){this.disable();}.bind(this));this.setup();};k.prototype.disable=function(){'use strict';this.teardown();};k.prototype.setup=function(){'use strict';if(this.setupComplete)return;var l=this.getHiddenAwarenessUnit(this.firstStepPivot),m=this.core.getValue()!=null?this.core.getValue().toString():null;if(l==null||m==null||m.length>0&&!this.data.getSingleState())return;this.config=JSON.parse(l.getAttribute('data-config'));if(this.config.search_suggestion_unit_style==='null_state_nux')this.secondStepPivot=c('SearchPivotType').TYPEAHEAD_TOOLTIP;if(this.config.ghost_text!=null){var n=c('DOM').scry(document.body,"._586i")[0];if(n==null)n=c('DOM').scry(document.body,"._1frb")[0];if(n){c('CSS').addClass(n,"_55me");n.setAttribute('data-ghost-text',this.config.ghost_text);}}this.firstStep=c('DOM').create('div',{'class':"_1qs6"},l);c('DOM').prependContent(this.view.getElement(),this.firstStep);this.mask=c('DOM').create('div',{className:"_3lif"});c('DOM').appendContent(document.body,this.mask);this.subscriptionsHandler.addSubscriptions(this.view.subscribe('show',this.onViewShow.bind(this)),this.view.subscribe('hide',this.onViewHide.bind(this)),this.view.subscribe('filter',this.onViewFilter.bind(this)),this.view.subscribe('beforeSelect',this.onViewBeforeSelect.bind(this)),this.core.subscribe('magSearch',this.onCoreMagSearch.bind(this)));if(this.view.visible)this.onViewShow();this.showSecondStepAwarenessUnit();this.activationWindowTimer=setTimeout(function(){this.disable();}.bind(this),this.config.activation_window);this.setupComplete=true;};k.prototype.teardown=function(){'use strict';if(this.mask)c('CSS').removeClass(this.mask,"_3lih");c('CSS').removeClass(this.view.getElement(),"_3lii");c('CSS').removeClass(this.view.getElement(),"_1qs7");c('CSS').removeClass(this.view.getElement(),"_55mf");c('CSS').removeClass(this.view.getElement(),"_55mg");c('CSS').removeClass(this.core.getElement(),"_55mh");if(this.debug)return;if(this.mask){c('DOM').remove(this.mask);this.mask=null;}if(this.firstStep){c('DOM').remove(this.firstStep);this.firstStep=null;}if(this.secondStep){c('DOM').remove(this.secondStep);this.secondStep=null;}this.subscriptionsHandler.release();};k.prototype.setupSecondStep=function(){'use strict';if(this.setupSecondStepComplete||!this.setupComplete)return;var l=this.getHiddenAwarenessUnit(this.secondStepPivot);if(l==null){this.setupSecondStepComplete=true;return;}var m=JSON.parse(l.getAttribute('data-config'));if(m.search_suggestion_unit_style!=null)this.config.search_suggestion_unit_style=m.search_suggestion_unit_style;this.config.show_second_step=m.show_second_step;this.secondStep=c('DOM').create('div',{className:"_3lig"},l);c('DOM').prependContent(this.view.getElement(),this.secondStep);this.setupSecondStepComplete=true;};k.prototype.getHiddenAwarenessUnit=function(l){'use strict';var m=c('DOM').scry(document.body,"._3lik"),n=void 0;for(var o=m,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r,t=s.getAttribute('data-origin');if(t===l&&s.firstChild!=null)n=s;}if(n==null)return undefined;var u=n.firstChild;c('DOM').remove(n);return u;};k.prototype.onViewShow=function(){'use strict';c('FunnelLogger').startFunnel(j);this.showOrHideFirstStep();clearTimeout(this.activationWindowTimer);var l=c('DOM').scry(document.body,"._18vg")[0];if(l!=null)c('CSS').hide(l);c('CSS').addClass(this.mask,"_3lih");c('CSS').addClass(this.view.getElement(),"_3lii");};k.prototype.onViewHide=function(){'use strict';c('FunnelLogger').endFunnel(j);this.disable();};k.prototype.onViewFilter=function(l,m){'use strict';this.showOrHideFirstStep();var n=0;for(var o=0;o<m.results.length;o++){var p=m.results[o];if(p.type==='keyword'){n++;this.updateResultQuery(p);}else p.unselectable=true;}if(this.config.search_suggestion_unit_style==='typeahead_tooltip'&&(m.results.length<9||n>4)){this.hasSpaceForToolTip=false;}else this.hasSpaceForToolTip=true;var q=this.core.getValue()!=null?this.core.getValue().toString():null,r=q!=null&&q.length>0&&q.length<3&&n<3;c('CSS').conditionClass(this.core.getElement(),"_55mh",r);if((this.config.block_ta_entity_clicks==null||this.config.block_ta_entity_clicks===false)&&q!=null&&q.length>=1)c('CSS').addClass(this.view.getElement(),"_55mf");};k.prototype.onViewBeforeSelect=function(l,m){'use strict';c('FunnelLogger').appendAction(j,m.selected.type==='keyword'?'clicked_on_keyword':'clicked_on_entity');if(this.blockedClick||this.config.block_ta_entity_clicks!==true||this.config.show_second_step!==true)return true;if(m.selected.type!=='keyword'&&this.hasSpaceForToolTip){this.blockedClick=true;c('CSS').addClass(this.view.getElement(),"_55mf");c('CSS').addClass(this.view.getElement(),"_55mg");if(this.config.search_suggestion_unit_style==='typeahead_tooltip'){var n=10000;setTimeout(function(){c('CSS').removeClass(this.view.getElement(),"_55mg");}.bind(this),n);setTimeout(function(){c('CSS').removeClass(this.view.getElement(),"_55mf");}.bind(this),n);}else setTimeout(function(){c('CSS').removeClass(this.view.getElement(),"_55mg");}.bind(this),5000);return false;}return true;};k.prototype.showSecondStepAwarenessUnit=function(){'use strict';c('SearchAwarenessDispatcher').triggerLearningNUX(this.secondStepPivot,this.config.encoded_query,this.config.actor_id,this.config.story_id,this.config.global_share_id);};k.prototype.showOrHideFirstStep=function(){'use strict';c('CSS').conditionClass(this.view.getElement(),"_1qs7",this.core.isNullState()||this.data.getSingleState());if(this.config.show_second_step!==true)c('CSS').conditionClass(this.mask,"_3lih",this.core.isNullState()||this.data.getSingleState());};k.prototype.onCoreMagSearch=function(l,m){'use strict';c('FunnelLogger').appendAction(j,'hit_enter_or_mag_glass_without_selection');this.updateResultQuery(m);};k.prototype.updateResultQuery=function(l){'use strict';var m=l.uri.getQueryData();m[c('SearchAwarenessWebConfig').url_param_nux_trigger_key]=this.config.aw_id;l.uri.setQueryData(m);};f.exports=k;},null);
__d('SearchAwarenessSERPSurvey',['Arbiter','SearchAwarenessWebConfig','SubscriptionsHandler'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.core=i.getCore();this.view=this.core.view;this.subscriptionsHandler=new (c('SubscriptionsHandler'))();}h.prototype.enable=function(){'use strict';this.subscriptionsHandler.addSubscriptions(c('Arbiter').subscribe('SearchAwareness.setupSurveyTriggers',function(i,j){this.urlParamvalue=j.url_param_value;}.bind(this)),this.view.subscribe('hide',this.onViewHide.bind(this)),this.view.subscribe('filter',this.onViewFilter.bind(this)),this.core.subscribe('magSearch',this.onCoreMagSearch.bind(this)));};h.prototype.disable=function(){'use strict';this.teardown();};h.prototype.teardown=function(){'use strict';this.subscriptionsHandler.release();};h.prototype.onViewHide=function(){'use strict';if(this.urlParamvalue!=null)this.disable();};h.prototype.onViewFilter=function(i,j){'use strict';if(this.urlParamvalue==null)return;for(var k=0;k<j.results.length;k++){var l=j.results[k];if(l.type==='keyword')this.updateResultQuery(l);}};h.prototype.onCoreMagSearch=function(i,j){'use strict';this.updateResultQuery(j);};h.prototype.updateResultQuery=function(i){'use strict';var j=i.uri.getQueryData();j[c('SearchAwarenessWebConfig').url_param_survey_trigger_key]=this.urlParamvalue;i.uri.setQueryData(j);};f.exports=h;},null);
__d('TypeaheadEarlyUserRequest',['AsyncRequest','FacebarGlobalOptions','XWarmUserRequestArgsController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this._core=i.getCore();this._listener=null;}h.prototype.enable=function(){'use strict';this._listener=this._core.subscribe('focus',function(i,j){new (c('AsyncRequest'))().setURI(c('XWarmUserRequestArgsController').getURIBuilder().getURI()).send();if(c('FacebarGlobalOptions').multiPreload)return;this.disable();}.bind(this));};h.prototype.disable=function(){'use strict';this._listener&&this._core.unsubscribe(this._listener);};f.exports=h;},null);
__d('TypeaheadSearchMegaphone',['AsyncRequest','DOM','DOMQuery','Event','Parent'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.$TypeaheadSearchMegaphone1=i;}h.prototype.enable=function(){'use strict';var i=c('DOMQuery').scry(this.$TypeaheadSearchMegaphone1.getView().getElement(),'.megaphone_location_gsv2_typeahead')[0];if(!i)return;this.ajaxify=c('DOMQuery').scry(i,'a.megaphone_hide_link[ajaxify]')[0].getAttribute('ajaxify');c('DOMQuery').scry(i,'a').forEach(this.processLink,this);c('Event').listen(i,'click',this.onClick.bind(this));};h.prototype.disable=function(){'use strict';};h.prototype.processLink=function(i){'use strict';if(i.getAttribute('ajaxify'))return;c('DOM').setAttributes(i,{target:'_blank'});};h.prototype.onClick=function(event){'use strict';var i=c('Parent').byTag(event.target,'a');if(!i||i.getAttribute('ajaxify'))return;c('AsyncRequest').bootstrap(this.ajaxify,i);};f.exports=h;},null);