if (self.CavalryLogger) { CavalryLogger.start_js(["Jj18m"]); }

__d('Stickers2Dispatcher',['ExplicitRegistrationDispatcher'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new (c('ExplicitRegistrationDispatcher'))({strict:false});},null);
__d('Stickers2Actions',['Stickers2Dispatcher','keyMirror'],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('keyMirror')({ADD_RECENT_STICKER:null,HIDE_FLYOUT:null,LOAD_RECENT_STICKERS:null,SELECT_STORE_PACK:null,SELECT_TRAY_PACK:null,SHOW_FLYOUT:null,TRAY_LOADED:null}),i={Types:h,addRecentSticker:function(j){c('Stickers2Dispatcher').dispatch({type:h.ADD_RECENT_STICKER,sticker:j});},hideStickerFlyout:function(){c('Stickers2Dispatcher').dispatch({type:h.HIDE_FLYOUT});},loadRecentStickers:function(j){c('Stickers2Dispatcher').dispatch({type:h.LOAD_RECENT_STICKERS,stickers:j});},selectStorePack:function(j){c('Stickers2Dispatcher').dispatch({type:h.SELECT_STORE_PACK,packID:j});},selectTrayPack:function(j){c('Stickers2Dispatcher').dispatch({type:h.SELECT_TRAY_PACK,packID:j});},showStickerFlyout:function(j){c('Stickers2Dispatcher').dispatch({type:h.SHOW_FLYOUT,threadID:j});},trayLoaded:function(){c('Stickers2Dispatcher').dispatch({type:h.TRAY_LOADED});}};f.exports=i;},null);
__d('Stickers2StateStore',['FluxReduceStore','immutable','PresenceState','Stickers2Actions','Stickers2Config','Stickers2Dispatcher'],function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){var k=c('PresenceState').get();return new (c('immutable').Map)({recentStickers:[],recentStickersLoaded:false,showFlyout:false,storePackID:null,threadID:null,trayLoaded:false,trayPackID:k?k.tray_pack_id:null});};j.prototype.reduce=function(k,l){var m=l,n=c('Stickers2Actions').Types;switch(m.type){case n.ADD_RECENT_STICKER:var o=[m.sticker];k.get('recentStickers').forEach(function(p){if(p.id===m.sticker.id)return;o.push(p);});return k.set('recentStickers',o.splice(0,c('Stickers2Config').max_mru_stickers));case n.HIDE_FLYOUT:return k.set('showFlyout',false);case n.LOAD_RECENT_STICKERS:return k.set('recentStickersLoaded',true).set('recentStickers',m.stickers);case n.SELECT_STORE_PACK:return k.set('storePackID',m.packID);case n.SELECT_TRAY_PACK:return k.set('trayPackID',m.packID).set('trayLoaded',true);case n.SHOW_FLYOUT:return k.set('showFlyout',true).set('threadID',m.threadID);case n.TRAY_LOADED:return k.set('trayLoaded',true);default:return k;}};function j(){h.apply(this,arguments);}f.exports=new j(c('Stickers2Dispatcher'));},null);
__d('ChatStickerButton2.react',['cx','fbt','BootloadedComponent.react','JSResource','Link.react','React','StickerContextualDialog.react','Stickers2Actions','Stickers2StateStore','XUISpinner.react','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=278;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.state={shown:false},this.$ChatStickerButton21=false,this.$ChatStickerButton22=undefined,this.renderLayers=function(){if(!this.state.shown)return null;var t=this.props.ContextualDialogClass;return (c('React').createElement(t,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBeforeHide:this.$ChatStickerButton25,onBlur:this.$ChatStickerButton23,position:'above',shown:this.state.shown,width:this.props.flyoutWidth,key:'contextualDialog'},c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{padding:'30px',textAlign:'center'}},c('React').createElement(c('XUISpinner.react'),{size:'large'})),bootloadLoader:c('JSResource')('Stickers2Flyout.react').__setRef('ChatStickerButton2.react'),className:this.props.flyoutClassName,onShown:function(u){if(this.props.onFlyoutShown)this.props.onFlyoutShown(u);}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this.$ChatStickerButton23,onStickerSelect:this.$ChatStickerButton26,onEmoticonSelect:this.$ChatStickerButton27,shown:this.state.shown})));}.bind(this),this.$ChatStickerButton24=function(){this.$ChatStickerButton21=this.state.shown;}.bind(this),this.showFlyout=function(t){t&&t.stopPropagation();if(this.$ChatStickerButton21||this.props.disabled){this.$ChatStickerButton21=false;return;}c('Stickers2Actions').showStickerFlyout(this.props.threadID);}.bind(this),this.$ChatStickerButton25=function(){if(this.state.shown)this.$ChatStickerButton23();}.bind(this),this.$ChatStickerButton23=function(){c('Stickers2Actions').hideStickerFlyout();},this.$ChatStickerButton26=function(t){this.props.onStickerSelect(t);}.bind(this),this.$ChatStickerButton27=function(t){this.$ChatStickerButton23();this.props.onEmoticonSelect(t);}.bind(this),o;}n.prototype.componentDidMount=function(){this.props.onLoad&&this.props.onLoad(this);this.$ChatStickerButton22=c('Stickers2StateStore').addListener(function(){var o=c('Stickers2StateStore').getState();if(o.get('showFlyout')&&o.get('threadID')===this.props.threadID){if(this.$ChatStickerButton21||this.props.disabled){this.$ChatStickerButton21=false;return;}this.setState({shown:true});}else{var p=this.props.getInput&&this.props.getInput();p&&p.focus&&p.focus();this.setState({shown:false});}}.bind(this));};n.prototype.componentWillUnmount=function(){if(this.state.shown)this.$ChatStickerButton23();this.$ChatStickerButton22&&this.$ChatStickerButton22.remove();};n.prototype.render=function(){return c('React').createElement('span',null,c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onClick:this.showFlyout,onMouseDown:this.$ChatStickerButton24,role:'button',title:i._("Choose a sticker"),ref:'link'}),this.renderLayers());};n.propTypes={className:l.string,ContextualDialogClass:l.func.isRequired,disabled:l.bool,flyoutClassName:l.string,flyoutWidth:l.number,getInput:l.func,onLoad:l.func,onStickerSelect:l.func.isRequired,onEmoticonSelect:l.func.isRequired,onFlyoutShown:l.func,onFlyoutHidden:l.func,threadID:l.string};n.defaultProps={ContextualDialogClass:c('StickerContextualDialog.react'),disabled:false,flyoutWidth:m,onStickerSelect:c('emptyFunction'),onEmoticonSelect:c('emptyFunction')};f.exports=n;},null);