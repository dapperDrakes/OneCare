if (self.CavalryLogger) { CavalryLogger.start_js(["pBGyP"]); }

__d("VideoPlayerStreamSwitchReasons",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={BANDWIDTH:"bandwidth",FORCED:"forced",PREFER_QUALITY_CLASS:"prefer_quality_class",USER:"user"};},null);
__d('TaggedTimeRanges',['sprintf'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.$TaggedTimeRanges1=[];this.$TaggedTimeRanges2=0;this.$TaggedTimeRanges3=0;this.$TaggedTimeRanges4=i?i:function(j,k){return j===k;};}h.prototype.add=function(i,j,k){'use strict';if(j<i)return;if(j===i)return;if(this.$TaggedTimeRanges1.length===0){this.$TaggedTimeRanges1.push({start:i,end:j,tag:k});return;}var l=0,m=0;for(var n=0;n<this.$TaggedTimeRanges1.length;n++){if(i>=this.$TaggedTimeRanges1[n].start)l=n+1;if(j<=this.$TaggedTimeRanges1[n].end)m=n;if(j<this.$TaggedTimeRanges1[n].start)break;}this.$TaggedTimeRanges1.splice(l,m-l,{start:i,end:j,tag:k});this.$TaggedTimeRanges5(l);};h.prototype.$TaggedTimeRanges5=function(i){'use strict';var j=this.$TaggedTimeRanges1[i],k=null;if(i!==0)k=this.$TaggedTimeRanges1[i-1];if(k!==null)if(this.$TaggedTimeRanges4(k.tag,j.tag)){if(k.end>=j.start){this.$TaggedTimeRanges1.splice(i-1,2,{start:k.start,end:Math.max(j.end,k.end),tag:j.tag});i--;}}else{if(k.end>=j.start)this.$TaggedTimeRanges1.splice(i-1,1,{start:k.start,end:j.start,tag:k.tag});if(k.end>j.end)this.$TaggedTimeRanges1.splice(i+1,0,{start:j.end,end:k.end,tag:k.tag});}var l=null;if(i!==this.$TaggedTimeRanges1.length-1)l=this.$TaggedTimeRanges1[i+1];if(l)if(this.$TaggedTimeRanges4(l.tag,j.tag)){if(l.start<=j.end)this.$TaggedTimeRanges1.splice(i,2,{start:j.start,end:Math.max(l.end,j.end),tag:j.tag});}else if(l.start<=j.end)if(l.end<j.end){this.$TaggedTimeRanges1.splice(i,1,{start:j.start,end:l.start,tag:j.tag});this.$TaggedTimeRanges1.push({start:l.end,end:j.end,tag:j.tag});}else this.$TaggedTimeRanges1.splice(i+1,1,{start:j.end,end:l.end,tag:l.tag});};h.prototype.get=function(i){'use strict';var j=i>=this.$TaggedTimeRanges3?this.$TaggedTimeRanges2:0,k=null;for(var l=j;l<this.$TaggedTimeRanges1.length;l++)if(this.$TaggedTimeRanges1[l].start<=i&&i<this.$TaggedTimeRanges1[l].end){k=l;break;}this.$TaggedTimeRanges2=k===null?0:k;this.$TaggedTimeRanges3=i;return k===null?null:this.$TaggedTimeRanges1[k].tag;};h.prototype.getLength=function(){'use strict';return this.$TaggedTimeRanges1.length;};f.exports=h;},null);
__d("Shaka",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();var h={};(function(i){var j,k=this;function l(fm,gm){var hm=fm.split("."),im=k;hm[0] in im||!im.execScript||im.execScript("var "+hm[0]);for(var jm;hm.length&&(jm=hm.shift());)hm.length||void 0===gm?im[jm]?im=im[jm]:im=im[jm]={}:im[jm]=gm;}function m(fm,gm){function hm(){}hm.prototype=gm.prototype;fm.Tb=gm.prototype;fm.prototype=new hm();fm.prototype.constructor=fm;fm.Sb=function(im,jm,km){return gm.prototype[jm].apply(im,Array.prototype.slice.call(arguments,2));};}function n(){}function o(fm){var gm=console[fm];gm?gm.bind||(console[fm]=function(){gm.apply(console,arguments);}):console[fm]=function(){};}o("error");o("warn");o("info");o("log");o("debug");function p(fm){t[fm]={fa:s(),end:NaN};}function q(fm){if(fm=t[fm])fm.end=s();}function r(fm){return (fm=t[fm])&&fm.end?fm.end-fm.fa:NaN;}var s=i.performance&&i.performance.now?i.performance.now.bind(i.performance):Date.now,t={};function u(fm,gm,hm,im){this.id=fm;this.bandwidth=gm||0;this.lang=hm||"unknown";this.streamInfoID=im;this.active=false;}l("shaka.player.AudioTrack.compare",function(fm,gm){return fm.lang<gm.lang?-1:fm.lang>gm.lang?1:fm.bandwidth<gm.bandwidth?-1:fm.bandwidth>gm.bandwidth?1:0;});function v(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null;}v.prototype.clone=function(){var fm=new v();fm.maxHeight=this.maxHeight;fm.minHeight=this.minHeight;fm.maxWidth=this.maxWidth;fm.maxBandwidth=this.maxBandwidth;fm.minBandwidth=this.minBandwidth;return fm;};function w(){this.fontSize="100%";this.fontColor=z;this.fontOpacity=ba;this.backgroundColor=aa;this.backgroundOpacity=ba;this.fontEdge=ca;}l("shaka.player.TextStyle",w);function x(fm){var gm=[];gm.push("font-size: "+fm.fontSize);gm.push("color: "+y(fm.fontColor,fm.fontOpacity));gm.push("background-color: "+y(fm.backgroundColor,fm.backgroundOpacity));for(var hm=[],im=0;im<fm.fontEdge.length;++im){var jm=fm.fontEdge[im].slice(3,6);hm.push(y(fm.fontEdge[im].slice(0,3),fm.fontOpacity)+" "+jm.join("px ")+"px");}gm.push("text-shadow: "+hm.join(","));return gm.join("; ");}function y(fm,gm){return "rgba("+fm.concat(gm).join(",")+")";}var z=[255,255,255],aa=[0,0,0];w.StandardColors={WHITE:z,BLACK:aa,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var ba=1;w.StandardOpacities={OPAQUE:ba,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var ca=[];w.EdgeStyles={NONE:ca,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function da(fm,gm){this.id=fm;this.lang=gm||"unknown";this.enabled=this.active=false;}l("shaka.player.TextTrack.compare",function(fm,gm){return fm.lang<gm.lang?-1:fm.lang>gm.lang?1:0;});function ea(fm,gm,hm,im,jm,km,lm){this.id=fm;this.bandwidth=gm||0;this.width=hm||0;this.height=im||0;this.streamInfoID=jm;this.fbQualityLabel=km;this.fbQualityClass=lm;this.active=false;}function fa(fm,gm){var hm=fm.width*fm.height,im=gm.width*gm.height;return hm<im?-1:hm>im?1:fm.bandwidth<gm.bandwidth?-1:fm.bandwidth>gm.bandwidth?1:0;}l("shaka.player.VideoTrack.compare",fa);function ga(){var fm="CustomEvent" in i;if(fm)try{new CustomEvent("");}catch(gm){fm=false;}fm||(i.CustomEvent=ha);}l("shaka.polyfill.CustomEvent.install",ga);function ha(fm,gm){var hm=document.createEvent("CustomEvent"),im=gm||{bubbles:false,cancelable:false,detail:null};hm.initCustomEvent(fm,!!im.bubbles,!!im.cancelable,im.detail);return hm;}function ia(){var fm=Element.prototype;fm.requestFullscreen=fm.requestFullscreen||fm.mozRequestFullScreen||fm.msRequestFullscreen||fm.webkitRequestFullscreen;fm=Document.prototype;fm.exitFullscreen=fm.exitFullscreen||fm.mozCancelFullScreen||fm.msExitFullscreen||fm.webkitExitFullscreen;"fullscreenElement" in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement;}});document.addEventListener("webkitfullscreenchange",ja);document.addEventListener("webkitfullscreenerror",ja);document.addEventListener("mozfullscreenchange",ja);document.addEventListener("mozfullscreenerror",ja);document.addEventListener("MSFullscreenChange",ja);document.addEventListener("MSFullscreenError",ja);}l("shaka.polyfill.Fullscreen.install",ia);function ja(fm){var gm=fm.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),gm=new Event(gm,fm);fm.target.dispatchEvent(gm);}function ka(){return Promise.reject(Error("The key system specified is not supported."));}function la(fm){return null==fm?Promise.resolve():Promise.reject(Error("MediaKeys not supported."));}function ma(){throw new TypeError("Illegal constructor.");}ma.prototype.createSession=function(){};ma.prototype.setServerCertificate=function(){};function na(){throw new TypeError("Illegal constructor.");}na.prototype.getConfiguration=function(){};na.prototype.createMediaKeys=function(){};function oa(fm){this.c=[];this.b=[];this.Z=pa;if(fm)try{fm(this.X.bind(this),this.a.bind(this));}catch(gm){this.a(gm);}}var pa=0;function qa(){i.Promise||(i.Promise=oa,i.Promise.resolve=ra,i.Promise.reject=sa,i.Promise.all=ta,i.Promise.race=ua,i.setImmediate?(xa=function(fm){return i.setImmediate(fm);},ya=function(fm){return i.clearImmediate(fm);}):(xa=function(fm){return i.setTimeout(fm,0);},ya=function(fm){return i.clearTimeout(fm);}));}l("shaka.polyfill.Promise.install",qa);function ra(fm){var gm=new oa();gm.X(fm);return gm;}function sa(fm){var gm=new oa();gm.a(fm);return gm;}function ta(fm){function gm(mm,nm,om){mm.Z==pa&&(jm[nm]=om,im++,im==jm.length&&mm.X(jm));}var hm=new oa();if(!fm.length)return hm.X([]),hm;for(var im=0,jm=Array(fm.length),km=hm.a.bind(hm),lm=0;lm<fm.length;++lm)fm[lm]&&fm[lm].then?fm[lm].then(gm.bind(null,hm,lm),km):gm(hm,lm,fm[lm]);return hm;}function ua(fm){for(var gm=new oa(),hm=gm.X.bind(gm),im=gm.a.bind(gm),jm=0;jm<fm.length;++jm)fm[jm]&&fm[jm].then?fm[jm].then(hm,im):hm(fm[jm]);return gm;}oa.prototype.then=function(fm,gm){var hm=new oa();switch(this.Z){case 1:va(this,hm,fm);break;case 2:va(this,hm,gm);break;case pa:this.c.push({Ga:hm,ya:fm}),this.b.push({Ga:hm,ya:gm});}return hm;};oa.prototype.then=oa.prototype.then;oa.prototype.catch=function(fm){return this.then(void 0,fm);};oa.prototype["catch"]=oa.prototype.catch;oa.prototype.X=function(fm){if(this.Z==pa){this.ua=fm;this.Z=1;for(fm=0;fm<this.c.length;++fm)va(this,this.c[fm].Ga,this.c[fm].ya);this.c=[];this.b=[];}};oa.prototype.a=function(fm){if(this.Z==pa){this.ua=fm;this.Z=2;for(fm=0;fm<this.b.length;++fm)va(this,this.b[fm].Ga,this.b[fm].ya);this.c=[];this.b=[];}};function va(fm,gm,hm){ab.push(function(){if(hm&&"function"==typeof hm){try{var jm=hm(this.ua);}catch(im){gm.a(im);return;}jm instanceof oa?jm==gm?gm.a(new TypeError("Chaining cycle detected")):jm.then(gm.X.bind(gm),gm.a.bind(gm)):gm.X(jm);}else 1==this.Z?gm.X(this.ua):gm.a(this.ua);}.bind(fm));null==za&&(za=xa(wa));}function wa(){for(;ab.length;){null!=za&&(ya(za),za=null);var fm=ab;ab=[];for(var gm=0;gm<fm.length;++gm)fm[gm]();}}function xa(){return 0;}function ya(){}var za=null,ab=[];function bb(){var fm=HTMLVideoElement.prototype;!fm.getVideoPlaybackQuality&&"webkitDroppedFrameCount" in fm&&(fm.getVideoPlaybackQuality=cb);}l("shaka.polyfill.VideoPlaybackQuality.install",bb);function cb(){return {droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0};}function db(fm,gm){for(var hm=[],im=0;im<fm.length;++im){for(var jm=false,km=0;km<hm.length&&!(jm=gm?gm(fm[im],hm[km]):fm[im]===hm[km]);++km);jm||hm.push(fm[im]);}return hm;}function eb(){return Date.now()+fb;}var fb=0;function gb(fm){this.b=fm;this.c=0==hb;this.a=0;}var hb=1;function ib(fm){return fm.a<fm.b.byteLength;}function jb(fm){var gm=fm.b.getUint8(fm.a);fm.a+=1;return gm;}function kb(fm){var gm=fm.b.getUint32(fm.a,fm.c);fm.a+=4;return gm;}function lb(fm){var gm,hm;fm.c?(gm=fm.b.getUint32(fm.a,true),hm=fm.b.getUint32(fm.a+4,true)):(hm=fm.b.getUint32(fm.a,false),gm=fm.b.getUint32(fm.a+4,false));if(2097151<hm)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");fm.a+=8;return hm*Math.pow(2,32)+gm;}function mb(fm){if(fm.a+16>fm.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var gm=new Uint8Array(fm.b.buffer,fm.a,16);fm.a+=16;return gm;}function nb(fm,gm){if(fm.a+gm>fm.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");fm.a+=gm;}function ob(fm){this.b=fm;this.a=new gb(fm);pb||(pb=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]);}var pb;function qb(fm){var gm;gm=rb(fm);if(7<gm.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var hm=0,im=0;im<gm.length;im++)hm=256*hm+gm[im];gm=hm;hm=rb(fm);fm:{for(im=0;im<pb.length;im++)if(ud(hm,pb[im])){im=true;break fm;}im=false;};if(im){hm=fm.b.byteLength-fm.a.a;}else{if(8==hm.length&&hm[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var im=hm[0]&(1<<8-hm.length)-1,jm=1;jm<hm.length;jm++)im=256*im+hm[jm];hm=im;}hm=fm.a.a+hm<=fm.b.byteLength?hm:fm.b.byteLength-fm.a.a;im=new DataView(fm.b.buffer,fm.b.byteOffset+fm.a.a,hm);nb(fm.a,hm);return new sb(gm,im);}function rb(fm){var gm=jb(fm.a),hm;for(hm=1;8>=hm&&!(gm&1<<8-hm);hm++);if(8<hm)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var im=new Uint8Array(hm);im[0]=gm;for(gm=1;gm<hm;gm++)im[gm]=jb(fm.a);return im;}function sb(fm,gm){this.id=fm;this.a=gm;}function tb(fm){if(8<fm.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==fm.a.byteLength&&fm.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var gm=0,hm=0;hm<fm.a.byteLength;hm++)var im=fm.a.getUint8(hm),gm=256*gm+im;return gm;}var ub={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function vb(fm){this.c=Math.exp(Math.log(.5)/fm);this.a=this.b=0;}vb.prototype.sample=function(fm,gm){var hm=Math.pow(this.c,fm);this.b=gm*(1-hm)+hm*this.b;this.a+=fm;};function wb(fm){return fm.b/(1-Math.pow(fm.c,fm.a));}function xb(fm){var gm=new CustomEvent(fm.type,{detail:fm.detail,bubbles:!!fm.bubbles}),hm;for(hm in fm)hm in gm||(gm[hm]=fm[hm]);return gm;}function yb(fm){return new CustomEvent("error",{detail:fm,bubbles:true});}function zb(fm,gm,hm){cc(gm);cc(hm);return hm==gm||fm>=ac&&hm==gm.split("-")[0]||fm>=bc&&hm.split("-")[0]==gm.split("-")[0]?true:false;}var ac=1,bc=2;function cc(fm){fm=fm.toLowerCase().split("-");var gm=dc[fm[0]];gm&&(fm[0]=gm);return fm.join("-");}var dc={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function ec(fm){return Object.keys(fm).map(function(gm){return fm[gm];});}function fc(fm,gm){return ic(fm,gm,"boolean");}function gc(fm,gm,hm){fm=ic(fm,gm,"number");if(null==fm)return null;if(isNaN(fm)||fm==Number.NEGATIVE_INFINITY||fm==Number.POSITIVE_INFINITY)throw new RangeError("'"+gm+"' must be finite.");if(null!=hm&&fm<hm)throw new RangeError("'"+gm+"' must be >= "+hm);return fm;}function hc(fm,gm){return ic(fm,gm,"string");}function ic(fm,gm,hm){fm=fm[gm];if(null==fm)return null;if(typeof fm!=hm)throw new TypeError("'"+gm+"' must be a "+hm+".");return fm;}function jc(fm,gm,hm){fm=fm[gm];if(null==fm)return null;if(!(fm instanceof hm))throw new TypeError("'"+gm+"' must be an instance of "+hm.name+".");return fm;}function kc(){this.a={};}kc.prototype.push=function(fm,gm){this.a.hasOwnProperty(fm)?this.a[fm].push(gm):this.a[fm]=[gm];};kc.prototype.set=function(fm,gm){this.a[fm]=gm;};kc.prototype.get=function(fm){return (fm=this.a[fm])?fm.slice():null;};function lc(fm){var gm=[],hm;for(hm in fm.a)gm.push.apply(gm,fm.a[hm]);return gm;}function mc(fm,gm,hm){if(fm=fm.a[gm])for(gm=0;gm<fm.length;++gm)fm[gm]==hm&&(fm.splice(gm,1),--gm);}function nc(fm){var gm=[],hm;for(hm in fm.a)gm.push(hm);return gm;}function oc(){this.a=new kc();}oc.prototype.destroy=function(){qc(this);this.a=null;};function pc(fm,gm,hm,im){gm=new rc(gm,hm,im);fm.a.push(hm,gm);}oc.prototype.ra=function(fm,gm){for(var hm=this.a.get(gm)||[],im=0;im<hm.length;++im){var jm=hm[im];jm.target==fm&&(jm.ra(),mc(this.a,gm,jm));}};function qc(fm){for(var gm=lc(fm.a),hm=0;hm<gm.length;++hm)gm[hm].ra();fm.a.a={};}function rc(fm,gm,hm){this.target=fm;this.type=gm;this.a=hm;this.target.addEventListener(gm,hm,false);}rc.prototype.ra=function(){this.target&&(this.target.removeEventListener(this.type,this.a,false),this.a=this.target=null);};function sc(fm){this.va=new kc();this.S=fm;}l("shaka.util.FakeEventTarget",sc);sc.prototype.addEventListener=function(fm,gm,hm){hm||this.va.push(fm,gm);};sc.prototype.removeEventListener=function(fm,gm,hm){hm||mc(this.va,fm,gm);};sc.prototype.dispatchEvent=function(fm){fm.hasOwnProperty("srcElement")||(delete fm.srcElement,Object.defineProperty(fm,"srcElement",{get:function(){return null;}}));if(fm.hasOwnProperty("target")){fm.target=this;}else{delete fm.target;var gm=this;Object.defineProperty(fm,"target",{get:function(){return gm;},set:function(im){gm=im;}});}if(fm.hasOwnProperty("currentTarget")){fm.currentTarget=null;}else{delete fm.currentTarget;var hm=null;Object.defineProperty(fm,"currentTarget",{get:function(){return hm;},set:function(im){hm=im;}});}return tc(this,fm);};function tc(fm,gm){gm.currentTarget=fm;for(var hm=fm.va.get(gm.type)||[],im=0;im<hm.length;++im){var jm=hm[im];try{jm.handleEvent?jm.handleEvent(gm):jm.call(fm,gm);}catch(km){}}fm.S&&gm.bubbles&&tc(fm.S,gm);return gm.defaultPrevented;}function uc(fm){sc.call(this,null);this.a=new vb(3);this.g=new vb(10);this.h=fm||500000;this.f=0;}m(uc,sc);l("shaka.util.EWMABandwidthEstimator",uc);uc.prototype.sample=function(fm,gm){if(!(65536>gm)){fm=Math.max(fm,50);var hm=8000*gm/fm,im=fm/1000;this.a.sample(im,hm);this.g.sample(im,hm);this.dispatchEvent(xb({type:"bandwidth"}));this.f=Date.now();}};uc.prototype.getBandwidth=function(){return .5>this.a.a?this.h:Math.min(wb(this.a),wb(this.g));};uc.prototype.getDataAge=function(){return (Date.now()-this.f)/1000;};uc.prototype.supportsCaching=function(){return false;};function vc(fm,gm,hm){uc.call(this,hm);this.c=fm||0;this.b=void 0===gm?Infinity:gm;}m(vc,uc);l("shaka.util.EWMACacheBandwidthEstimator",vc);vc.prototype.sample=function(fm,gm){fm<=this.c&&8000*gm/fm>this.b||uc.prototype.sample.call(this,fm,gm);};vc.prototype.supportsCaching=function(){return Infinity!==this.b&&!!this.c;};function wc(){uc.call(this);}m(wc,uc);l("shaka.util.EWMASignedURLBandwidthEstimator",wc);wc.prototype.supportsCaching=function(){return true;};function xc(){var fm,gm,hm=new Promise(function(im,jm){fm=im;gm=jm;});hm.resolve=fm;hm.reject=gm;hm.destroy=xc.prototype.destroy;return hm;}xc.prototype.destroy=function(){this.catch(function(){});var fm=Error("Destroyed!");fm.type="destroy";this.reject(fm);};function yc(fm){fm.split("").reduce(function(gm,hm,im){return gm+(im&&0==im%4?" "+hm:hm);});}function zc(){this.g=new xc();this.f=false;this.a=null;this.b=[];this.c=null;}function ad(fm,gm){if(fm.f)throw Error("Cannot append to a running task!");fm.b.push(gm);}zc.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=true;this.b.unshift(function(){});bd(this,void 0);};zc.prototype.end=function(){this.b.splice(1);};function bd(fm,gm){var hm=fm.b[0](gm),im;hm?(im=hm[0],fm.c=hm[1]):(im=Promise.resolve(),fm.c=null);im.then(dd(fm,function(jm){this.a?(this.b=[],this.c=null,cd(this)):(this.b.shift(),this.b.length?bd(this,jm):(this.g.resolve(jm),this.c=null));})).catch(dd(fm,function(jm){this.b=[];this.c=null;this.a?cd(this):this.g.reject(jm);}));}function cd(fm){var gm=Error("Task aborted.");gm.type="aborted";fm.g.reject(gm);i.setTimeout(function(){this.a.resolve();this.a=null;}.bind(fm),5);}function dd(fm,gm){return gm.bind(fm);}function ed(fm,gm,hm){MediaSource.isTypeSupported(gm);gm=fm.addSourceBuffer(gm);this.h=fm;this.c=gm;this.l=hm;this.i=new oc();this.v=null;this.b=[];this.s=0;this.f=this.a=null;this.m=0;pc(this.i,this.c,"updateend",this.A.bind(this));}var fd=1/60;ed.prototype.destroy=function(){ld(this).catch(function(){});this.f&&this.f.destroy();this.b=this.a=this.f=null;this.i.destroy();this.h=this.c=this.i=null;};function gd(fm,gm){for(var hm=fm.c.buffered,im=0;im<hm.length;++im){var jm=hm.start(im)-fd,km=hm.end(im)+fd;if(gm>=jm&&gm<=km)return hm.end(im)-gm;}return 0;}function hd(fm,gm,hm){gm=gm.a?gm.a-gm.b:1;var im=new bh();im.a=3;im.i=1000*gm;im.c=1000*fm.m;im.m=fm.v;im.j=hm;return im;}function id(fm,gm,hm,im,jm){if(fm.a)return fm=Error("Cannot fetch ("+fm.j+"): previous operation not complete."),fm.type="stream",Promise.reject(fm);fm.a=new zc();hm!=fm.c.timestampOffset&&(fm.c.timestampOffset=hm);hm=hd(fm,gm,jm);var km=mh(gm.url,hm,fm.l),lm=jh.prototype.f.bind(gm.url),mm=0;im&&ad(fm.a,function(){return [im.then(function(pm){pm.ha>mm&&(mm=pm.ha);return od(this,pm);}.bind(this)),this.g.bind(this)];}.bind(fm));ad(fm.a,dd(fm,function(){return [km.then(function(pm){pm.ha>mm&&(mm=pm.ha);this.l.getBandwidth();return od(this,pm);}.bind(this)),function(){lm();this.g();}.bind(this)];}));var nm=0==fm.c.buffered.length&&0==fm.b.length,om=null;ad(fm.a,function(){if(0==this.c.buffered.length){var pm=Error("Failed to buffer segment ("+this.j+").");pm.type="stream";return [Promise.reject(pm)];}nm&&(pm=gm.b,om=this.c.buffered.start(0)-pm);pm=yh(this.b,gm.b);0<=pm?this.b.splice(pm+1,0,gm):this.b.push(gm);}.bind(fm));return nd(fm).then(function(){return Promise.resolve({W:om,nb:mm});}.bind(fm));}function jd(fm){if(fm.a)return fm=Error("Cannot clear ("+fm.j+"): previous operation not complete."),fm.type="stream",Promise.reject(fm);fm.a=new zc();ad(fm.a,function(){var gm;gm:if(0==this.c.buffered.length){gm=Promise.resolve();}else{try{this.c.remove(0,this.h.duration);}catch(hm){gm=Promise.reject(hm);break gm;}this.b=[];gm=this.f=new xc();};return [gm,this.g.bind(this)];}.bind(fm));return nd(fm);}function kd(fm,gm){if(fm.a){var hm=Error("Cannot clearAfter ("+fm.j+"): previous operation not complete.");hm.type="stream";return Promise.reject(hm);}fm.a=new zc();ad(fm.a,function(){return [pd(this,gm),this.g.bind(this)];}.bind(fm));return nd(fm);}function ld(fm){fm.a?(fm=fm.a,fm.a?fm=fm.a:fm.f?(fm.c&&fm.c(),fm.a=new xc(),fm=fm.a):(fm.f=true,fm=Promise.resolve())):fm=Promise.resolve();return fm;}function md(fm,gm){for(var hm=fm.c.buffered,im=gm,jm=0;jm<hm.length;jm++)if(gm<=hm.start(jm)){im=hm.start(jm);break;}return im;}function nd(fm){fm.a.start();return fm.a.g.then(dd(fm,function(){this.a=null;})).catch(dd(fm,function(gm){this.a=null;return Promise.reject(gm);}));}function od(fm,gm){try{fm.c.appendBuffer(gm);}catch(hm){return Promise.reject(hm);}fm.f=new xc();return fm.f;}function pd(fm,gm){if(0==fm.c.buffered.length)return Promise.resolve();var hm=yh(fm.b,gm);if(-1==hm||hm==fm.b.length-1)return Promise.resolve();try{fm.c.remove(fm.b[hm+1].b,fm.h.duration);}catch(im){return Promise.reject(im);}fm.b=fm.b.slice(0,hm+1);fm.f=new xc();return fm.f;}ed.prototype.g=function(){this.f&&"open"==this.h.readyState&&this.c.abort();};ed.prototype.A=function(){this.f&&(this.f.resolve(),this.f=null);};function qd(fm){return String.fromCharCode.apply(null,fm);}l("shaka.util.Uint8ArrayUtils.toString",qd);function rd(fm){for(var gm=new Uint8Array(fm.length),hm=0;hm<fm.length;++hm)gm[hm]=fm.charCodeAt(hm);return gm;}l("shaka.util.Uint8ArrayUtils.fromString",rd);l("shaka.util.Uint8ArrayUtils.toBase64",function(fm,gm){var hm=void 0==gm?true:gm,im=i.btoa(qd(fm)).replace(/\+/g,"-").replace(/\//g,"_");return hm?im:im.replace(/=*$/,"");});function sd(fm){return rd(i.atob(fm.replace(/-/g,"+").replace(/_/g,"/")));}l("shaka.util.Uint8ArrayUtils.fromBase64",sd);l("shaka.util.Uint8ArrayUtils.fromHex",function(fm){for(var gm=new Uint8Array(fm.length/2),hm=0;hm<fm.length;hm+=2)gm[hm/2]=i.parseInt(fm.substr(hm,2),16);return gm;});function td(fm){for(var gm="",hm=0;hm<fm.length;++hm){var im=fm[hm].toString(16);1==im.length&&(im="0"+im);gm+=im;}return gm;}l("shaka.util.Uint8ArrayUtils.toHex",td);function ud(fm,gm){if(!fm&&!gm)return true;if(!fm||!gm||fm.length!=gm.length)return false;for(var hm=0;hm<fm.length;++hm)if(fm[hm]!=gm[hm])return false;return true;}function vd(){this.h=this.a="";this.l=false;this.s=this.m=null;this.i=this.g=false;this.j=this.f="";this.c=null;this.b=[];}function wd(fm,gm){var hm=new vd();hm.a=fm.a;hm.h=fm.h;hm.l=fm.l;hm.m=fm.m;hm.s=fm.s;hm.g=fm.g;hm.i=fm.i;hm.f=fm.f;hm.j=fm.j;hm.c=fm.c?new Uint8Array(fm.c.buffer):null;xd(hm,fm.b);xd(hm,gm.b);return hm;}function xd(fm,gm){var hm=fm.b.concat(gm.map(function(im){return {initData:new Uint8Array(im.initData.buffer),initDataType:im.initDataType};}));fm.b=db(hm,yd);}function yd(fm,gm){return fm.initDataType==gm.initDataType&&ud(fm.initData,gm.initData);}function zd(fm,gm,hm,im){this.a=[];im&&this.a.push(im);}l("shaka.player.DrmSchemeInfo",zd);zd.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:1};zd.PersistentState={OPTIONAL:0,REQUIRED:1};zd.createUnencrypted=function(){return new zd(0,0,0,null);};function ae(fm,gm){try{var im=new ce(fm,gm);return Promise.resolve(im);}catch(hm){return Promise.reject(hm);}}function be(fm){var gm=this.mediaKeys;gm&&gm!=fm&&ee(gm,null);delete this.mediaKeys;(this.mediaKeys=fm)&&ee(fm,this);return Promise.resolve();}function ce(fm,gm){this.a=this.keySystem=fm;var hm=true;"org.w3.clearkey"==fm&&(this.a="webkit-org.w3.clearkey",hm=false);var im=false,jm;jm=document.getElementsByTagName("video");jm=jm.length?jm[0]:document.createElement("video");for(var km=0;km<gm.length;++km){var lm=gm[km],mm={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:lm.initDataTypes,sessionTypes:["temporary"]},nm=false;if(lm.audioCapabilities)for(var om=0;om<lm.audioCapabilities.length;++om){var pm=lm.audioCapabilities[om];pm.contentType&&(nm=true,jm.canPlayType(pm.contentType.split(";")[0],this.a)&&(mm.audioCapabilities.push(pm),im=true));}if(lm.videoCapabilities)for(om=0;om<lm.videoCapabilities.length;++om)pm=lm.videoCapabilities[om],pm.contentType&&(nm=true,jm.canPlayType(pm.contentType,this.a)&&(mm.videoCapabilities.push(pm),im=true));nm||(im=jm.canPlayType("video/mp4",this.a)||jm.canPlayType("video/webm",this.a));"required"==lm.persistentState&&(hm?(mm.persistentState="required",mm.sessionTypes=["persistent-license"]):im=false);if(im){this.b=mm;return;}}hm="Unsupported keySystem";if("org.w3.clearkey"==fm||"com.widevine.alpha"==fm)hm="None of the requested configurations were supported.";hm=Error(hm);hm.name="NotSupportedError";hm.code=DOMException.NOT_SUPPORTED_ERR;throw hm;}ce.prototype.createMediaKeys=function(){var fm=new de(this.a);return Promise.resolve(fm);};ce.prototype.getConfiguration=function(){return this.b;};function de(fm){this.g=fm;this.b=null;this.a=new oc();this.c=[];this.f={};}function ee(fm,gm){fm.b=gm;qc(fm.a);gm&&(pc(fm.a,gm,"webkitneedkey",fm.Jb.bind(fm)),pc(fm.a,gm,"webkitkeymessage",fm.Ib.bind(fm)),pc(fm.a,gm,"webkitkeyadded",fm.Gb.bind(fm)),pc(fm.a,gm,"webkitkeyerror",fm.Hb.bind(fm)));}j=de.prototype;j.createSession=function(fm){var gm=fm||"temporary";if("temporary"!=gm&&"persistent-license"!=gm)throw new TypeError("Session type "+fm+" is unsupported on this platform.");fm=this.b||document.createElement("video");fm.src||(fm.src="about:blank");gm=new ge(fm,this.g,gm);this.c.push(gm);return gm;};j.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."));};j.Jb=function(fm){fm=xb({type:"encrypted",initDataType:"webm",initData:fm.initData});this.b.dispatchEvent(fm);};j.Ib=function(fm){var gm=fe(this,fm.sessionId);gm&&(fm=xb({type:"message",messageType:void 0==gm.keyStatuses.Da()?"licenserequest":"licenserenewal",message:fm.message}),gm.b&&(gm.b.resolve(),gm.b=null),gm.dispatchEvent(fm));};j.Gb=function(fm){if(fm=fe(this,fm.sessionId))ie(fm,"usable"),fm.a&&fm.a.resolve(),fm.a=null;};j.Hb=function(fm){var gm=fe(this,fm.sessionId);if(gm){var hm=Error("EME v0.1b key error");hm.errorCode=fm.errorCode;hm.errorCode.systemCode=fm.systemCode;!fm.sessionId&&gm.b?(hm.method="generateRequest",45==fm.systemCode&&(hm.message="Unsupported session type."),gm.b.reject(hm),gm.b=null):fm.sessionId&&gm.a?(hm.method="update",gm.a.reject(hm),gm.a=null):(hm=fm.systemCode,fm.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?ie(gm,"output-restricted"):1==hm?ie(gm,"expired"):ie(gm,"internal-error"));}};function fe(fm,gm){var hm=fm.f[gm];return hm?hm:(hm=fm.c.shift())?(hm.sessionId=gm,fm.f[gm]=hm):null;}function ge(fm,gm,hm){sc.call(this,null);this.f=fm;this.h=false;this.a=this.b=null;this.c=gm;this.g=hm;this.sessionId="";this.expiration=NaN;this.closed=new xc();this.keyStatuses=new je();}m(ge,sc);function he(fm,gm,hm){if(fm.h)return Promise.reject(Error("The session is already initialized."));fm.h=true;var im;try{if("persistent-license"==fm.g){if(hm){im=rd("LOAD_SESSION|"+hm);}else{var km=new Uint8Array(gm);im=rd("PERSISTENT|"+qd(km));}}else im=new Uint8Array(gm);}catch(jm){return Promise.reject(jm);}fm.b=new xc();try{fm.f.webkitGenerateKeyRequest(fm.c,im);}catch(lm){if("InvalidStateError"!=lm.name)return fm.b=null,Promise.reject(lm);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,im);}catch(mm){this.b.reject(mm),this.b=null;}}.bind(fm),10);}return fm.b;}j=ge.prototype;j.La=function(fm,gm){if(this.a){this.a.then(this.La.bind(this,fm,gm)).catch(this.La.bind(this,fm,gm));}else{this.a=fm;var hm,im;"webkit-org.w3.clearkey"==this.c?(hm=qd(new Uint8Array(gm)),im=JSON.parse(hm),"oct"!=im.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),hm=sd(im.keys[0].k),im=sd(im.keys[0].kid)):(hm=new Uint8Array(gm),im=null);try{this.f.webkitAddKey(this.c,hm,im,this.sessionId);}catch(jm){this.a.reject(jm),this.a=null;}}};function ie(fm,gm){fm.keyStatuses.Ia(gm);var hm=xb({type:"keystatuseschange"});fm.dispatchEvent(hm);}j.generateRequest=function(fm,gm){return he(this,gm,null);};j.load=function(fm){return "persistent-license"==this.g?he(this,null,fm):Promise.reject(Error("Not a persistent session."));};j.update=function(fm){var gm=new xc();this.La(gm,fm);return gm;};j.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId);}this.closed.resolve();return this.closed;};j.remove=function(){return "persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close();};function je(){this.size=0;this.a=void 0;}var ke;j=je.prototype;j.Ia=function(fm){this.size=void 0==fm?0:1;this.a=fm;};j.Da=function(){return this.a;};j.forEach=function(fm){this.a&&fm(ke,this.a);};j.get=function(fm){if(this.has(fm))return this.a;};j.has=function(fm){var gm=ke;return this.a&&ud(new Uint8Array(fm),new Uint8Array(gm))?true:false;};function le(fm){this.systemIds=[];this.cencKeyIds=[];this.a=[];fm=new gb(new DataView(fm.buffer));try{for(;ib(fm);){var hm=fm.a,im=kb(fm),jm=kb(fm);1==im?im=lb(fm):0==im&&(im=fm.b.byteLength-hm);if(1886614376!=jm){nb(fm,im-(fm.a-hm));}else{var km=jb(fm);if(1<km){nb(fm,im-(fm.a-hm));}else{nb(fm,3);var lm=td(mb(fm)),mm=[];if(0<km)for(var nm=kb(fm),om=0;om<nm;++om){var pm=td(mb(fm));mm.push(pm);}var qm=kb(fm);nb(fm,qm);this.cencKeyIds.push.apply(this.cencKeyIds,mm);this.systemIds.push(lm);this.a.push({start:hm,end:fm.a-1});fm.a!=hm+im&&nb(fm,im-(fm.a-hm));}}}}catch(gm){}}function me(fm,gm){try{var im=new ne(fm,gm);return Promise.resolve(im);}catch(hm){return Promise.reject(hm);}}function ne(fm,gm){this.keySystem=fm;for(var hm=false,im=0;im<gm.length;++im){var jm=gm[im],km={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:jm.initDataTypes,sessionTypes:["temporary"]},lm=false;if(jm.audioCapabilities)for(var mm=0;mm<jm.audioCapabilities.length;++mm){var nm=jm.audioCapabilities[mm];if(nm.contentType){var lm=true,om=nm.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,om)&&(km.audioCapabilities.push(nm),hm=true);}}if(jm.videoCapabilities)for(mm=0;mm<jm.videoCapabilities.length;++mm)nm=jm.videoCapabilities[mm],nm.contentType&&(lm=true,om=nm.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,om)&&(km.videoCapabilities.push(nm),hm=true));lm||(hm=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==jm.persistentState&&(km.persistentState="required",km.sessionTypes=["persistent-license"]);if(hm){this.a=km;return;}}hm=Error("Unsupported keySystem");hm.name="NotSupportedError";hm.code=DOMException.NOT_SUPPORTED_ERR;throw hm;}ne.prototype.createMediaKeys=function(){var fm=new pe(this.keySystem);return Promise.resolve(fm);};ne.prototype.getConfiguration=function(){return this.a;};function oe(fm){var gm=this.mediaKeys;gm&&gm!=fm&&qe(gm,null);delete this.mediaKeys;return (this.mediaKeys=fm)?qe(fm,this):Promise.resolve();}function pe(fm){this.a=new MSMediaKeys(fm);this.b=new oc();}pe.prototype.createSession=function(fm){if("temporary"!=(fm||"temporary"))throw new TypeError("Session type "+fm+" is unsupported on this platform.");return new re(this.a);};pe.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."));};function qe(fm,gm){function hm(){gm.msSetMediaKeys(im.a);gm.removeEventListener("loadedmetadata",hm);}qc(fm.b);if(!gm)return Promise.resolve();pc(fm.b,gm,"msneedkey",se);var im=fm;try{return 1<=gm.readyState?gm.msSetMediaKeys(fm.a):gm.addEventListener("loadedmetadata",hm),Promise.resolve();}catch(jm){return Promise.reject(jm);}}function re(fm){sc.call(this,null);this.c=null;this.g=fm;this.b=this.a=null;this.f=new oc();this.sessionId="";this.expiration=NaN;this.closed=new xc();this.keyStatuses=new ve();}m(re,sc);j=re.prototype;j.generateRequest=function(fm,gm){this.a=new xc();try{this.c=this.g.createSession("video/mp4",new Uint8Array(gm),null),pc(this.f,this.c,"mskeymessage",this.yb.bind(this)),pc(this.f,this.c,"mskeyadded",this.wb.bind(this)),pc(this.f,this.c,"mskeyerror",this.xb.bind(this)),ue(this,"status-pending");}catch(hm){this.a.reject(hm);}return this.a;};j.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"));};j.update=function(fm){this.b=new xc();try{this.c.update(new Uint8Array(fm));}catch(gm){this.b.reject(gm);}return this.b;};j.close=function(){try{this.c.close(),this.closed.resolve(),qc(this.f);}catch(fm){this.closed.reject(fm);}return this.closed;};j.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"));};function se(fm){var gm=fm.initData;if(gm){var hm=new le(gm);if(1>=hm.a.length){fm=gm;}else{var im=[];for(fm=0;fm<hm.a.length;fm++)im.push(gm.subarray(hm.a[fm].start,hm.a[fm].end+1));gm=db(im,te);for(fm=hm=0;fm<gm.length;fm++)hm+=gm[fm].length;hm=new Uint8Array(hm);for(fm=im=0;fm<gm.length;fm++)hm.set(gm[fm],im),im+=gm[fm].length;fm=hm;}}else fm=gm;fm=xb({type:"encrypted",initDataType:"cenc",initData:fm});this.dispatchEvent(fm);}function te(fm,gm){return ud(fm,gm);}j.yb=function(fm){this.a&&(this.a.resolve(),this.a=null);fm=xb({type:"message",messageType:void 0==this.keyStatuses.Da()?"licenserequest":"licenserenewal",message:fm.message.buffer});this.dispatchEvent(fm);};j.wb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(ue(this,"usable"),this.b.resolve(),this.b=null);};j.xb=function(){var fm=Error("EME v20140218 key error");fm.errorCode=this.c.error;if(null!=this.a){this.a.reject(fm),this.a=null;}else if(null!=this.b){this.b.reject(fm),this.b=null;}else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:ue(this,"output-not-allowed");default:ue(this,"internal-error");}};function ue(fm,gm){fm.keyStatuses.Ia(gm);var hm=xb({type:"keystatuseschange"});fm.dispatchEvent(hm);}function ve(){this.size=0;this.a=void 0;}var we;j=ve.prototype;j.Ia=function(fm){this.size=void 0==fm?0:1;this.a=fm;};j.Da=function(){return this.a;};j.forEach=function(fm){this.a&&fm(we,this.a);};j.get=function(fm){if(this.has(fm))return this.a;};j.has=function(fm){var gm=we;return this.a&&ud(new Uint8Array(fm),new Uint8Array(gm))?true:false;};function xe(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(ke=(new Uint8Array([0])).buffer,Navigator.prototype.requestMediaKeySystemAccess=ae,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=be,i.MediaKeys=de,i.MediaKeySystemAccess=ce):i.MSMediaKeys?(we=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=oe,i.MediaKeys=pe,i.MediaKeySystemAccess=ne,Navigator.prototype.requestMediaKeySystemAccess=me):(Navigator.prototype.requestMediaKeySystemAccess=ka,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=la,i.MediaKeys=ma,i.MediaKeySystemAccess=na));}l("shaka.polyfill.MediaKeys.install",xe);l("shaka.polyfill.installAll",function(){ga();ia();bb();qa();xe();});var ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function ze(fm){var gm;fm instanceof ze?(af(this,fm.V),this.$=fm.$,this.L=fm.L,bf(this,fm.ga),this.R=fm.R,cf(this,fm.a.clone()),this.Y=fm.Y):fm&&(gm=String(fm).match(ye))?(af(this,gm[1]||"",true),this.$=df(gm[2]||""),this.L=df(gm[3]||"",true),bf(this,gm[4]),this.R=df(gm[5]||"",true),cf(this,gm[6]||"",true),this.Y=df(gm[7]||"")):this.a=new mf(null);}j=ze.prototype;j.V="";j.$="";j.L="";j.ga=null;j.R="";j.Y="";j.toString=function(){var fm=[],gm=this.V;gm&&fm.push(ef(gm,gf,true),":");if(gm=this.L){fm.push("//");var hm=this.$;hm&&fm.push(ef(hm,gf,true),"@");fm.push(encodeURIComponent(gm).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));gm=this.ga;null!=gm&&fm.push(":",String(gm));}if(gm=this.R)this.L&&"/"!=gm.charAt(0)&&fm.push("/"),fm.push(ef(gm,"/"==gm.charAt(0)?jf:hf,true));(gm=this.a.toString())&&fm.push("?",gm);(gm=this.Y)&&fm.push("#",ef(gm,lf));return fm.join("");};j.resolve=function(fm){var gm=this.clone();"data"===gm.V&&(gm=new ze());var hm=!!fm.V;hm?af(gm,fm.V):hm=!!fm.$;hm?gm.$=fm.$:hm=!!fm.L;hm?gm.L=fm.L:hm=null!=fm.ga;var im=fm.R;if(hm){bf(gm,fm.ga);}else if(hm=!!fm.R){if("/"!=im.charAt(0))if(this.L&&!this.R){im="/"+im;}else{var jm=gm.R.lastIndexOf("/");-1!=jm&&(im=gm.R.substr(0,jm+1)+im);}if(".."==im||"."==im){im="";}else if(-1!=im.indexOf("./")||-1!=im.indexOf("/.")){for(var jm=0==im.lastIndexOf("/",0),im=im.split("/"),km=[],lm=0;lm<im.length;){var mm=im[lm++];"."==mm?jm&&lm==im.length&&km.push(""):".."==mm?((1<km.length||1==km.length&&""!=km[0])&&km.pop(),jm&&lm==im.length&&km.push("")):(km.push(mm),jm=true);}im=km.join("/");}}hm?gm.R=im:hm=""!==fm.a.toString();hm?cf(gm,fm.a.clone()):hm=!!fm.Y;hm&&(gm.Y=fm.Y);return gm;};j.clone=function(){return new ze(this);};function af(fm,gm,hm){fm.V=hm?df(gm,true):gm;fm.V&&(fm.V=fm.V.replace(/:$/,""));}function bf(fm,gm){if(gm){gm=Number(gm);if(isNaN(gm)||0>gm)throw Error("Bad port number "+gm);fm.ga=gm;}else fm.ga=null;}function cf(fm,gm,hm){gm instanceof mf?fm.a=gm:(hm||(gm=ef(gm,kf)),fm.a=new mf(gm));}function df(fm,gm){return fm?gm?decodeURI(fm):decodeURIComponent(fm):"";}function ef(fm,gm,hm){return "string"==typeof fm?(fm=encodeURI(fm).replace(gm,ff),hm&&(fm=fm.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),fm):null;}function ff(fm){fm=fm.charCodeAt(0);return "%"+(fm>>4&15).toString(16)+(fm&15).toString(16);}var gf=/[#\/\?@]/g,hf=/[\#\?:]/g,jf=/[\#\?]/g,kf=/[\#\?@]/g,lf=/#/g;function mf(fm){this.b=fm||null;}mf.prototype.a=null;mf.prototype.c=null;function nf(fm,gm,hm){if(!fm.a&&(fm.a={},fm.c=0,fm.b))for(var im=fm.b.split("&"),jm=0;jm<im.length;jm++){var km=im[jm].indexOf("="),lm=null,mm=null;0<=km?(lm=im[jm].substring(0,km),mm=im[jm].substring(km+1)):lm=im[jm];lm=decodeURIComponent(lm.replace(/\+/g," "));mm=mm||"";nf(fm,lm,decodeURIComponent(mm.replace(/\+/g," ")));}fm.b=null;(im=fm.a.hasOwnProperty(gm)&&fm.a[gm])||(fm.a[gm]=im=[]);im.push(hm);fm.c++;}mf.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return "";var fm=[],gm;for(gm in this.a)for(var hm=encodeURIComponent(gm),im=this.a[gm],jm=0;jm<im.length;jm++){var km=hm;""!==im[jm]&&(km+="="+encodeURIComponent(im[jm]));fm.push(km);}return this.b=fm.join("&");};mf.prototype.clone=function(){var fm=new mf();fm.b=this.b;if(this.a){var gm={},hm;for(hm in this.a)gm[hm]=this.a[hm].concat();fm.a=gm;fm.c=this.c;}return fm;};function of(fm,gm,hm){fm=(new DOMParser()).parseFromString(fm,"text/xml");if(!fm)return null;gm=gm||[new ze("")];hm=hm||[new ze("")];return mg({hb:gm,u:hm},fm,pf);}l("shaka.dash.mpd.parseMpd",of);function pf(){this.id=this.url=null;this.type="static";this.b=this.j=this.u=this.hb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[];}function qf(){this.g=this.f=this.c=this.u=this.a=this.start=this.id=null;this.b=[];}function rf(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=false;this.h=this.g=this.f=this.u=null;this.j=[];this.a=[];}function sf(){this.value=null;}function tf(){this.contentType=this.lang=this.id=null;}function uf(){this.a=this.b=this.g=this.u=this.fbQualityClass=this.fbQualityLabel=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[];}function vf(){this.b=this.a=this.c=this.f=null;}function wf(){this.parsedPssh=this.psshBox=null;}function xf(){this.url=null;}function yf(){this.url=null;}function zf(){this.u=null;this.h=1;this.c=this.b=this.f=this.a=this.g=null;}zf.prototype.clone=function(){var fm=new zf();fm.u=qg(this.u);fm.h=this.h;fm.g=this.g;fm.a=rg(this.a);fm.f=rg(this.f);fm.b=rg(this.b);fm.c=rg(this.c);return fm;};function ag(){this.a=this.url=null;}ag.prototype.clone=function(){var fm=new ag();fm.url=qg(this.url);fm.a=rg(this.a);return fm;};function bg(){this.a=this.url=null;}bg.prototype.clone=function(){var fm=new bg();fm.url=qg(this.url);fm.a=rg(this.a);return fm;};function cg(){this.u=null;this.a=1;this.c=this.g=null;this.i=0;this.h=null;this.b=[];this.f=null;}cg.prototype.clone=function(){var fm=new cg();fm.u=qg(this.u);fm.a=this.a;fm.g=this.g;fm.c=this.c;fm.i=this.i;fm.h=rg(this.h);fm.b=qg(this.b)||[];fm.f=rg(this.f);return fm;};function dg(){this.a=this.b=null;}dg.prototype.clone=function(){var fm=new dg();fm.b=qg(this.b);fm.a=rg(this.a);return fm;};function eg(){this.a=1;this.b=this.i=null;this.j=0;this.c=this.g=this.f=this.h=null;}eg.prototype.clone=function(){var fm=new eg();fm.a=this.a;fm.i=this.i;fm.b=this.b;fm.j=this.j;fm.h=this.h;fm.f=this.f;fm.g=this.g;fm.c=rg(this.c);return fm;};function fg(){this.a=[];}fg.prototype.clone=function(){var fm=new fg();fm.a=qg(this.a)||[];return fm;};function gg(){this.c=this.a=this.b=null;}gg.prototype.clone=function(){var fm=new gg();fm.b=this.b;fm.a=this.a;fm.c=this.c;return fm;};function hg(fm,gm){this.fa=fm;this.end=gm;}hg.prototype.clone=function(){return new hg(this.fa,this.end);};pf.TAG_NAME="MPD";qf.TAG_NAME="Period";rf.TAG_NAME="AdaptationSet";sf.TAG_NAME="Role";tf.TAG_NAME="ContentComponent";uf.TAG_NAME="Representation";vf.TAG_NAME="ContentProtection";wf.TAG_NAME="cenc:pssh";xf.TAG_NAME="BaseURL";yf.TAG_NAME="Location";zf.TAG_NAME="SegmentBase";ag.TAG_NAME="RepresentationIndex";bg.TAG_NAME="Initialization";cg.TAG_NAME="SegmentList";dg.TAG_NAME="SegmentURL";eg.TAG_NAME="SegmentTemplate";fg.TAG_NAME="SegmentTimeline";gg.TAG_NAME="S";pf.prototype.parse=function(fm,gm){this.url=fm.hb;this.id=sg(gm,"id",zg);this.type=sg(gm,"type",zg)||"static";this.b=sg(gm,"mediaPresentationDuration",ug);this.h=sg(gm,"minBufferTime",ug,this.h);this.g=sg(gm,"minimumUpdatePeriod",ug,this.g);this.c=sg(gm,"availabilityStartTime",tg,this.c);this.f=sg(gm,"timeShiftBufferDepth",ug,this.f);this.f=null;this.i=sg(gm,"suggestedPresentationDelay",ug,this.i);var hm=fm.u,im=og(this,gm,xf);this.u=jg(hm,im);if(im=mg(this,gm,yf))this.j=kg(hm,im.url);this.a=og(this,gm,qf);};qf.prototype.parse=function(fm,gm){this.id=sg(gm,"id",zg);this.start=sg(gm,"start",ug);this.a=sg(gm,"duration",ug);var hm=og(this,gm,xf);this.u=jg(fm.u,hm);this.c=mg(this,gm,zf);this.f=mg(this,gm,cg);this.g=mg(this,gm,eg);this.b=og(this,gm,rf);ig(this);};function ig(fm){for(var gm=[],hm=0;hm<fm.b.length;++hm){var im=fm.b[hm];null!=im.group&&(gm[im.group]=true);}for(hm=0;hm<fm.b.length;++hm)if(im=fm.b[hm],null==im.group){for(var jm=1;1==gm[jm];)++jm;gm[jm]=true;im.group=jm;}}rf.prototype.parse=function(fm,gm){var hm=mg(this,gm,tf)||{},im=mg(this,gm,sf);this.id=sg(gm,"id",zg);this.group=sg(gm,"group",yg);this.lang=sg(gm,"lang",zg,hm.lang);this.contentType=sg(gm,"contentType",zg,hm.contentType);this.width=sg(gm,"width",xg);this.height=sg(gm,"height",xg);this.b=sg(gm,"mimeType",zg);this.i=sg(gm,"codecs",zg);this.c=im&&"main"==im.value;this.lang&&(this.lang=cc(this.lang));hm=og(this,gm,xf);this.u=jg(fm.u,hm);this.j=og(this,gm,vf);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=fm.c?lg(this,gm,fm.c):mg(this,gm,zf);this.g=fm.f?lg(this,gm,fm.f):mg(this,gm,cg);this.h=fm.g?lg(this,gm,fm.g):mg(this,gm,eg);this.a=og(this,gm,uf);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]));};sf.prototype.parse=function(fm,gm){this.value=sg(gm,"value",zg);};tf.prototype.parse=function(fm,gm){this.id=sg(gm,"id",zg);this.lang=sg(gm,"lang",zg);this.contentType=sg(gm,"contentType",zg);this.lang&&(this.lang=cc(this.lang));};uf.prototype.parse=function(fm,gm){this.id=sg(gm,"id",zg);this.bandwidth=sg(gm,"bandwidth",xg);this.width=sg(gm,"width",xg,fm.width);this.height=sg(gm,"height",xg,fm.height);this.f=sg(gm,"mimeType",zg,fm.b);this.h=sg(gm,"codecs",zg,fm.i);this.fbQualityLabel=sg(gm,"FBQualityLabel",zg);this.fbQualityClass=sg(gm,"FBQualityClass",zg);this.lang=fm.lang;var hm=og(this,gm,xf);this.u=jg(fm.u,hm);this.c=og(this,gm,vf);this.g=fm.f?lg(this,gm,fm.f):mg(this,gm,zf);this.b=fm.g?lg(this,gm,fm.g):mg(this,gm,cg);this.a=fm.h?lg(this,gm,fm.h):mg(this,gm,eg);this.c=this.c.concat(fm.j);};vf.prototype.parse=function(fm,gm){this.f=gm;this.c=sg(gm,"schemeIdUri",zg);var hm=sg(gm,"cenc:default_KID",zg);hm&&(this.b=hm.replace(/[-]/g,""));this.a=mg(this,gm,wf);};wf.prototype.parse=function(fm,gm){var hm=pg(gm);if(hm){this.psshBox=sd(hm);try{this.parsedPssh=new le(this.psshBox);}catch(im){if(!(im instanceof RangeError))throw im;}}};xf.prototype.parse=function(fm,gm){this.url=pg(gm);};yf.prototype.parse=function(fm,gm){this.url=pg(gm);};zf.prototype.parse=function(fm,gm){this.u=fm.u||this.u;this.h=sg(gm,"timescale",xg,this.h);this.g=sg(gm,"presentationTimeOffset",yg,this.g);this.a=sg(gm,"indexRange",vg,this.a);this.f=sg(gm,"FBFirstSegmentRange",vg,this.f);this.b=mg(this,gm,ag)||this.b;this.c=mg(this,gm,bg)||this.c;};ag.prototype.parse=function(fm,gm){var hm=sg(gm,"sourceURL",zg);this.url=kg(fm.u,hm);this.a=sg(gm,"range",vg,rg(fm.a));};bg.prototype.parse=function(fm,gm){var hm=sg(gm,"sourceURL",zg);this.url=kg(fm.u,hm);this.a=sg(gm,"range",vg);};cg.prototype.parse=function(fm,gm){this.u=fm.u||this.u;this.a=sg(gm,"timescale",xg,this.a);this.g=sg(gm,"presentationTimeOffset",yg,this.g);this.c=sg(gm,"duration",xg,this.c);var hm=sg(gm,"startNumber",xg);null!=hm&&(this.i=hm);this.h=mg(this,gm,bg)||this.h;this.b=(hm=og(this,gm,dg))&&0<hm.length?hm:this.b;this.f=mg(this,gm,fg)||this.f;};dg.prototype.parse=function(fm,gm){var hm=sg(gm,"media",zg);this.b=kg(fm.u,hm);this.a=sg(gm,"mediaRange",vg);};eg.prototype.parse=function(fm,gm){this.a=sg(gm,"timescale",xg,this.a);this.i=sg(gm,"presentationTimeOffset",yg,this.i);this.b=sg(gm,"duration",xg,this.b);var hm=sg(gm,"startNumber",yg);null!=hm&&(this.j=hm);this.h=sg(gm,"media",zg,this.h);this.f=sg(gm,"index",zg,this.f);this.g=sg(gm,"initialization",zg,this.g);this.c=mg(this,gm,fg)||this.c;};fg.prototype.parse=function(fm,gm){this.a=og(this,gm,gg);};gg.prototype.parse=function(fm,gm){this.b=sg(gm,"t",yg);this.a=sg(gm,"d",yg);this.c=sg(gm,"r",wg);};function jg(fm,gm){if(!gm||0===gm.length)return fm;for(var hm=[],im=0;im<gm.length;im++){var jm=gm[im].url;null==fm||0===fm.length?hm.push(new ze(jm)):(jm=kg(fm.slice(0,1),jm),hm.push(jm[0]));}return hm;}function kg(fm,gm){if(!gm)return fm;var hm=new ze(gm);return fm?fm.map(function(im){return im.resolve(hm);}):[hm];}function lg(fm,gm,hm){var im=rg(hm);(gm=ng(gm,hm.constructor.TAG_NAME))&&im.parse(fm,gm);return im;}function mg(fm,gm,hm){var im=null;if(gm=ng(gm,hm.TAG_NAME))im=new hm(),im.parse(fm,gm);return im;}function ng(fm,gm){for(var hm=null,im=0;im<fm.childNodes.length;im++)if(fm.childNodes[im].tagName==gm){if(hm)return null;hm=fm.childNodes[im];}return hm;}function og(fm,gm,hm){for(var im=[],jm=0;jm<gm.childNodes.length;jm++)if(gm.childNodes[jm].tagName==hm.TAG_NAME){var km=new hm();km.parse.call(km,fm,gm.childNodes[jm]);im.push(km);}return im;}function pg(fm){fm=fm.firstChild;return fm.nodeType!=Node.TEXT_NODE?null:fm.nodeValue;}function qg(fm){return fm?fm.map(function(gm){return gm.clone();}):null;}function rg(fm){return fm?fm.clone():null;}function sg(fm,gm,hm,im){fm=hm(fm.getAttribute(gm));return null!=fm?fm:void 0!==im?im:null;}function tg(fm){if(!fm)return null;fm=Date.parse(fm);return isNaN(fm)?null:Math.floor(fm/1000);}function ug(fm){if(!fm)return null;var gm=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(fm);if(!gm)return null;fm=0;var hm=yg(gm[1]);hm&&(fm+=31536000*hm);(hm=yg(gm[2]))&&(fm+=2592000*hm);(hm=yg(gm[3]))&&(fm+=86400*hm);(hm=yg(gm[4]))&&(fm+=3600*hm);(hm=yg(gm[5]))&&(fm+=60*hm);gm=i.parseFloat(gm[6]);(gm=isNaN(gm)?null:gm)&&(fm+=gm);return fm;}function vg(fm){var gm=/([0-9]+)-([0-9]+)/.exec(fm);if(!gm)return null;fm=yg(gm[1]);if(null==fm)return null;gm=yg(gm[2]);return null==gm?null:new hg(fm,gm);}function wg(fm){fm=i.parseInt(fm,10);return isNaN(fm)?null:fm;}function xg(fm){fm=i.parseInt(fm,10);return 0<fm?fm:null;}function yg(fm){fm=i.parseInt(fm,10);return 0<=fm?fm:null;}function zg(fm){return fm;}function ah(fm,gm){this.url=fm;this.b=gm||new bh();this.g=this.j=this.h=0;this.a=null;this.c=new xc();this.f=null;}l("shaka.util.AjaxRequest",ah);function bh(){this.body=null;this.a=1;this.i=1000;this.c=0;this.method="GET";this.g="arraybuffer";this.b={};this.h=this.l=false;this.f=this.m=null;this.j=false;}var ch=true;function dh(fm){eh(fm);fm.b.body=null;fm.c.destroy();fm.c=null;fm.f=null;}function eh(fm){fm.a&&(fm.a.onload=null,fm.a.onreadystatechange=null,fm.a.onerror=null,fm.a.ontimeout=null);fm.a=null;}var fh=/(.*)\.(xx|fna)\.fbcdn\.net/,gh=/livestream-lookaside\.facebook\.com$/;ah.prototype.i=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var fm=this.url.split(":")[1].split(";").pop().split(","),gm=fm.pop(),gm="base64"==fm.pop()?i.atob(gm.replace(/-/g,"+").replace(/_/g,"/")):i.decodeURIComponent(gm);"arraybuffer"==this.b.g&&(gm=rd(gm).buffer);fm=JSON.parse(JSON.stringify(new XMLHttpRequest()));fm.response=gm;fm.responseText=gm.toString();gm=this.c;gm.resolve(fm);dh(this);return gm;}if(0==this.url.lastIndexOf("idb:",0))return this.A();this.h++;this.j=Date.now();this.g||(this.g=this.b.i);this.a=new XMLHttpRequest();var hm=this.url,fm=new ze(hm);ch&&(this.f&&!this.f.supportsCaching()||this.b.h)&&nf(fm.a,"_",Date.now());hm=fh.test(hm);if(null!=this.b.f&&hm){var im=this.b.f,jm=fm.a;nf(jm,"_nc_p_n",im.c);null!=im.b?nf(jm,"_nc_p_ts",im.b):null!=im.a&&nf(jm,"_nc_p_o",im.a);}1==this.b.j&&hm&&nf(fm.a,"_nc_playing",1);hm=fm.toString();fm=gh.test(fm.L);this.a.open(this.b.method,hm,true);this.a.responseType=this.b.g;this.a.timeout=this.b.c;this.a.withCredentials=this.b.l||fm;this.a.onload=this.l.bind(this);this.a.onreadystatechange=this.m.bind(this);this.a.onerror=this.v.bind(this);this.a.ontimeout=this.s.bind(this);for(gm in this.b.b)this.a.setRequestHeader(gm,this.b.b[gm]);this.a.send(this.b.body);return this.c;};ah.prototype.send=ah.prototype.i;function hh(fm,gm,hm){gm=Error(gm);gm.type=hm;gm.status=fm.a.status;gm.url=fm.url;gm.method=fm.b.method;gm.body=fm.b.body;gm.Rb=fm.a;return gm;}ah.prototype.l=function(fm){this.f&&this.f.sample(Date.now()-this.j,fm.loaded);fm=[403];200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),dh(this)):this.h<this.b.a&&-1===fm.indexOf(this.a.status)?ih(this):(fm=hh(this,"HTTP error.","net"),this.c.reject(fm),dh(this));};ah.prototype.m=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED&&(this.a.ha=Date.now()-this.j,this.b.h)){var fm=Date.parse(this.a.getResponseHeader("Date"));fm&&(fb=fm-Date.now());}};ah.prototype.v=function(){var fm=hh(this,"Network failure.","net");this.c.reject(fm);dh(this);};ah.prototype.s=function(){if(this.h<this.b.a){ih(this);}else{var fm=hh(this,"Request timed out.","net");this.c.reject(fm);dh(this);}};function ih(fm){eh(fm);i.setTimeout(fm.i.bind(fm),fm.g*(1+.5*(2*Math.random()-1)));fm.g*=2;}function jh(fm,gm,hm,im){this.b=gm;this.h=hm||0;this.g=null!=im?im:null;this.c=this.a=null;this.j=fm;this.i=null;}var kh;l("shaka.util.FailoverUri",jh);function lh(fm,gm){return fm&&0!==fm.length?fm.map(function(hm){return hm.resolve(gm);}):[gm];}jh.setPrefetchCacheValueGetter=function(fm){kh=fm;};function mh(fm,gm,hm){if(fm.a)return fm.a;fm.a=nh(fm,0,gm||new bh(),hm);return fm.a;}jh.prototype.f=function(){if(this.c){this.a=null;var fm=this.c;if(fm.a&&fm.a.readyState!=XMLHttpRequest.DONE){fm.a.abort();var gm=hh(fm,"Request aborted.","aborted");fm.c.reject(gm);dh(fm);}this.i=this.c=null;}};function nh(fm,gm,hm,im){var jm=fm.b[gm].toString();if(fm.h||fm.g){var km=fm.b[gm].L;!km.endsWith("fbcdn.net")||km.startsWith("interncache")||km.endsWith("ak.fbcdn.net")?hm.b.Range="bytes="+(fm.h+"-"+(null!=fm.g?fm.g:"")):jm+="&bytestart="+fm.h+"&byteend="+fm.g;}fm.j&&(jm=fm.j(jm,hm.b)||jm);km=null;kh&&(km=kh(jm));km||(fm.c=new ah(jm,hm),im&&(fm.c.f=im),km=fm.c.i());jm=km.then(dd(fm,function(lm){this.i=this.c=this.a=null;this.i=lm.a?new ze(lm.a):this.b[gm];lm.response.ha=lm.ha;return Promise.resolve(lm.response);}));return jm=jm.catch(dd(fm,function(lm){if(this.a&&gm+1<this.b.length)return this.a=nh(this,gm+1,hm,im);this.a=this.c=null;return Promise.reject(lm);}));}jh.prototype.clone=function(){return new jh(this.j,this.b.map(function(fm){return fm.clone();}),this.h,this.g);};jh.prototype.toString=function(){return this.b[0].toString();};function oh(fm){this.c=fm;this.a=this.b=null;}function ph(fm,gm,hm){this.a=new bh();this.a.g="text";this.a.a=3;this.a.c=1000*(null!=gm?gm:0);hm&&(this.a.f=hm);this.a.h=true;this.b=fm;}function qh(fm){var gm=fm.b;return mh(gm,fm.a).then(function(hm){if(hm=of(hm,gm.b,[gm.i]))return Promise.resolve(hm);hm=Error("MPD parse failure.");hm.type="dash";return Promise.reject(hm);});}function rh(fm,gm,hm,im){for(var jm=gm.a,km=[],lm=0;lm<im;++lm){var mm=lm+hm,nm=(mm-1)*jm.b,om=nm/jm.a,pm=(nm+jm.b)/jm.a,mm=sh(fm,gm,jm.j+mm-1,nm);if(!mm)return null;km.push(new wh(om,pm,mm,nm));}return km;}function sh(fm,gm,hm,im){if(!gm.a)return null;var jm=gm.a.h;if(!jm)return gm.u?new jh(fm,gm.u,0,null):null;hm=th(jm,gm.id,hm,gm.bandwidth,im);if(!hm)return null;gm=lh(gm.u,hm);return new jh(fm,gm,0,null);}function th(fm,gm,hm,im,jm){var km={RepresentationID:gm,Number:hm,Bandwidth:im,Time:jm};fm=fm.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(mm,nm,om){if("$$"==mm)return "$";var pm=km[nm];if(null==pm)return mm;"RepresentationID"==nm&&om&&(om=void 0);mm=pm.toString();om=i.parseInt(om,10)||1;om=Math.max(0,om-mm.length);return Array(om+1).join("0")+mm;});try{return new ze(fm);}catch(lm){if(lm instanceof URIError)return null;throw lm;}}function uh(fm,gm,hm){var im=0;gm*=hm;fm=fm.a;hm=[];for(var jm=0;jm<fm.length&&fm[jm].a;++jm){var km=fm[jm].b,km=null!=km?km:im,lm=fm[jm].c||0;0>lm&&(lm=fm[jm].a,lm=jm+1===fm.length?Math.ceil((fm[0].b+gm-km)/lm)-1:Math.ceil((fm[jm+1].b-km)/lm)-1);0<hm.length&&km!=im&&(hm[hm.length-1].end=km);for(var mm=0;mm<=lm;++mm)im=km+fm[jm].a,hm.push({start:km,end:im}),km=im;}return hm;}function vh(fm,gm){this.a=fm;this.b=gm||null;}vh.prototype.destroy=function(){this.a&&(this.a.f(),this.a=null);this.b=null;};vh.prototype.create=function(){return this.a?mh(this.a):Promise.resolve(this.b);};function wh(fm,gm,hm,im){this.b=fm;this.a=gm;this.url=hm;this.c=null!=im?im:null;}function xh(fm,gm,hm){return new wh(gm,hm,fm.url,null!=fm.c?fm.c:void 0);}function yh(fm,gm){for(var hm=fm.length-1;0<=hm;--hm){var im=fm[hm];if(gm>=im.b&&(null==im.a||gm<im.a))return hm;}return -1;}function zh(fm,gm){return fm.map(function(hm){return xh(hm,hm.b+gm,null!=hm.a?hm.a+gm:null);});}function ai(){}ai.prototype.parse=function(fm,gm,hm,im,jm){var km=null;try{fm:{var mm=[],nm=new gb(fm),om=kb(nm);if(1936286840!=kb(nm)){km=null;}else{1==om&&(om=lb(nm));var pm=jb(nm);nb(nm,3);nb(nm,4);var qm=kb(nm);if(0==qm){km=null;}else{var rm,sm;0==pm?(rm=kb(nm),sm=kb(nm)):(rm=lb(nm),sm=lb(nm));nb(nm,2);var tm=nm.b.getUint16(nm.a,nm.c);nm.a+=2;fm=rm;gm=gm+om+sm;for(sm=om=0;sm<tm;sm++){var um=kb(nm);rm=(um&2147483648)>>>31;var pm=um&2147483647,vm=kb(nm);kb(nm);if(1==rm){km=null;break fm;}var wm;wm=0==sm&&jm?jm:new jh(im,hm,gm,gm+pm-1);rm=fm/qm;var xm=(fm+vm)/qm;0===sm&&(om=rm);mm.push(new wh(rm-om,xm-om,wm));fm+=vm;gm+=pm;}km=mm;}}};}catch(lm){if(!(lm instanceof RangeError))throw lm;}return km;};function bi(fm){this.a=fm;this.W=0;this.j=[];this.Ma=false;}bi.prototype.D=function(){return Math.floor((this.j.length-1-this.j.lastIndexOf(true))/2);};bi.prototype.getConsecutiveUpdatesWithoutChanges=bi.prototype.D;bi.prototype.B=function(){return this.j.length-1-this.j.lastIndexOf(false);};bi.prototype.getConsecutiveUpdatesWithChanges=bi.prototype.B;bi.prototype.destroy=function(){this.a=null;};j=bi.prototype;j.length=function(){return this.a.length;};function ci(fm){if(0==fm.a.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return fm.a[0];}j.w=function(){if(0==this.a.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.a[this.a.length-1];};j.get=function(fm){if(0>fm||fm>=this.a.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.a[fm];};j.ja=function(fm){fm=yh(this.a,fm);return 0<=fm?this.a[fm]:null;};j.Fa=function(fm){di(this,fm);return true;};function di(fm,gm){fm.W!=gm.W&&(gm=new bi(zh(gm.a,fm.W-gm.W)));if(0==fm.length()){fm.a=gm.a.slice(0);}else if(0!=gm.length()&&null!=fm.w().a)if(null!=gm.w().a&&gm.w().a<fm.w().a){fm.Ma=true;}else{fm.Ma=false;if(fm.w().a<=ci(gm).b){var hm=xh(fm.w(),fm.w().b,ci(gm).b),hm=fm.a.slice(0,-1).concat([hm]);}else{var im;for(im=0;im<fm.a.length&&!(fm.a[im].a>=ci(gm).b);++im);fm.a[im].b<ci(gm).b?(hm=xh(fm.a[im],fm.a[im].b,ci(gm).b),hm=fm.a.slice(0,im).concat([hm])):(ci(fm).b>ci(gm).b||ci(gm),hm=fm.a.slice(0,im));}fm.a=hm.concat(gm.a);}}j.ia=function(fm){var gm=fm-this.W;if(0==gm)return 0;this.a=zh(this.a,gm);this.W=fm;return gm;};j.Ba=function(){return 0<this.length()?{start:ci(this).b,end:this.w().a}:{start:0,end:0};};function ei(fm,gm,hm,im){bi.call(this,fm);this.h=gm;this.A=hm;this.g=im;this.i=this.h.b||this.h.a.reduce(function(jm,km){return null==km.a?NaN:jm+km.a;},0)||0;this.b=this.s=this.f=null;fi(this);}m(ei,bi);ei.prototype.destroy=function(){this.A=this.h=null;bi.prototype.destroy.call(this);};ei.prototype.ja=function(fm){hi(this,eb()/1000);return bi.prototype.ja.call(this,fm);};ei.prototype.Fa=function(fm){if(!(fm instanceof ei))return false;di(this,fm);this.i=Math.max(this.i,fm.i);null==this.f?(this.g=fm.g,fi(this)):ii(this);return true;};function fi(fm){ii(fm);if(0!=fm.length()){fm.length();var gm=null!=fm.w().a?fm.w().a:fm.w().b;if(fm.h.c>fm.g){fm.f=gm;}else{var hm=fm.g-(fm.h.c+fm.A.start);0>hm?fm.f=gm:hm<Math.max(fm.w().b,fm.w().a||0)?(fm.w(),fm.f=gm):fm.f=hm;}fm.s=fm.w().b;fm.b=ci(fm).b;}}ei.prototype.ia=function(fm){fm=bi.prototype.ia.call(this,fm);Math.min.apply(null,this.a.filter(function(gm){return null!=gm.a;}).map(function(gm){return gm.a-gm.b;}));null!=this.f&&(this.s+=fm,this.b+=fm,this.f+=fm);return fm;};ei.prototype.Ba=function(){return gi(this,eb()/1000);};function gi(fm,gm){hi(fm,gm);if(null==fm.f||null==fm.s||null==fm.b)return {start:0,end:0};var hm=Number.POSITIVE_INFINITY;fm.i&&(hm=fm.i);var im=gm-fm.g,jm=fm.f+im;null!=fm.h.f&&(jm=jm-fm.b-fm.h.f,0<jm&&(fm.b+=jm));fm.b=Math.min(fm.b,hm);im=fm.s+im;if(im<fm.b)return {start:fm.b,end:fm.b};im=0<fm.length()?null!=fm.w().a?Math.min(im,fm.w().a):im:fm.b;im=Math.max(im,fm.b);im=Math.min(im,hm);return {start:fm.b,end:im};}function hi(fm,gm){ii(fm);if(null!=fm.h.f)if(null==fm.f){fm.length();}else{for(var hm=fm.f+(gm-fm.g),im=0,jm=0;jm<fm.a.length;++jm){var km=null;jm<fm.a.length-1?km=fm.a[jm+1].a:(km=fm.a[jm],km=null!=km.a?km.a+(km.a-km.b):null);if(null!=km&&km<hm-fm.h.f){++im;}else break;}0<im&&fm.a.splice(0,im);}}function ii(fm){if(fm.i){for(var gm=0,hm=fm.a.length-1;0<=hm;--hm)if(fm.a[hm].b>fm.i){++gm;}else break;0<gm&&fm.a.splice(-gm);}}function ji(fm,gm,hm,im,jm){var km=1,lm=0,mm;if(fm.c>im){mm=null;}else{var nm=fm.i||0,om=fm.f||0;mm=hm.a;mm=mm.b/mm.a;var pm=im-(fm.c+gm.start);0>pm?mm=null:(om=pm-2*mm-om,0>om&&(om=0),om=Math.ceil(om/mm)*mm,pm-=mm,0>pm?mm=null:(nm=Math.floor(pm/mm)*mm-nm,0>nm&&(nm=0),nm=Math.floor(nm/mm)*mm,mm={Xa:om/mm+1,current:(nm>=om?nm:om)/mm+1}));}mm&&(km=mm.Xa,lm=mm.current-mm.Xa+1);km=rh(jm,hm,km,lm);if(null==km)throw fm=Error("Failed to generate SegmentReferences."),fm.type="stream",fm;ei.call(this,km,fm,gm,im);this.v=hm;this.m=this.c=0<this.length()?fm.c+gm.start+this.w().a:null;this.l=mm?mm.current+1:null;this.S=jm;}m(ji,ei);ji.prototype.destroy=function(){this.S=this.v=null;ei.prototype.destroy.call(this);};ji.prototype.ja=function(fm){var gm=eb()/1000;ki(this,gm);hi(this,gm);return bi.prototype.ja.call(this,fm);};ji.prototype.Fa=function(fm){if(null!=this.c||!(fm instanceof ji)||null==fm.c)return false;this.c=fm.c;this.m=fm.m;this.l=fm.l;this.g=fm.g;this.i=fm.i;di(this,fm);ki(this,eb()/1000);fi(this);return true;};ji.prototype.ia=function(fm){fm=ei.prototype.ia.call(this,fm);null!=this.c&&(this.c+=fm,this.m+=fm);return fm;};ji.prototype.Ba=function(){var fm=eb()/1000;ki(this,fm);return gi(this,fm);};function ki(fm,gm){if(null!=fm.c&&null!=fm.m&&null!=fm.l){var hm=fm.v.a,hm=hm.b/hm.a,im=Math.floor((fm.m+(gm-fm.g)-fm.c)/hm);if(0!=im){var jm=rh(fm.S,fm.v,fm.l,im);Array.prototype.push.apply(fm.a,zh(jm,fm.W));fm.c+=im*hm;fm.l+=im;}}}function li(fm,gm,hm,im,jm){this.f=fm;this.b=gm;this.c=hm;this.h=im;this.a=null;this.g=jm;}li.prototype.destroy=function(){this.g=this.c=this.b=this.f=null;this.a&&(this.a.destroy(),this.a=null);};li.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.f.type){try{this.a=new ji(this.f,this.b,this.c,this.h,this.g);}catch(fm){return Promise.reject(fm);}}else{var gm;gm=this.c.a;if(gm=rh(this.g,this.c,1,Math.ceil(this.b.a/(gm.b/gm.a)))){if(0<gm.length){var hm=gm[gm.length-1];gm[gm.length-1]=xh(hm,hm.b,this.b.a);}gm=new bi(gm);}else gm=null;this.a=gm;if(!this.a)return gm=Error("Failed to generate SegmentReferences"),gm.type="stream",Promise.reject(gm);}return Promise.resolve(this.a);};function mi(fm,gm,hm,im,jm){this.c=fm;this.b=gm;this.g=hm;this.a=null;this.h=im;this.f=jm;}mi.prototype.destroy=function(){this.f=this.g=this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);};mi.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var fm=this.g.b,gm=[];fm.f&&(gm=uh(fm.f,fm.a||1,this.b.a||0));var hm=0;fm.c&&fm.i?hm=(fm.i-1)*fm.c:0<gm.length&&(hm=gm[0].start-(fm.g||0));var im=hm,jm=fm.b.length;0<gm.length&&gm.length!=fm.b.length&&(jm=Math.min(gm.length,fm.b.length));for(var km=[],lm=0;lm<jm;++lm){var mm=fm.b[lm],nm=hm/fm.a,om=null,pm=null;fm.c?(om=hm+fm.c,pm=om/fm.a):0<gm.length?(om=gm[lm].end-(fm.g||0),pm=om/fm.a):(pm=nm+this.b.a,om=pm*fm.a);var hm=om,om=0,qm=null;mm.a&&(om=mm.a.fa,qm=mm.a.end);pm=Math.min(this.b.a+im/fm.a,pm);km.push(new wh(nm,pm,new jh(this.f,mm.b,om,qm)));}"dynamic"==this.c.type?this.a=new ei(km,this.c,this.b,this.h):this.a=new bi(km);return Promise.resolve(this.a);};function ni(fm,gm,hm,im,jm){this.b=fm;this.c=gm;this.f=hm;this.h=im;this.a=null;this.g=jm;}ni.prototype.destroy=function(){this.g=this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);};ni.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var fm=this.f.a,gm=uh(fm.c,fm.a||1,this.c.a||0),hm=[],im=0;im<gm.length;++im){var jm=gm[im].start,km=jm/fm.a,lm=gm[im].end/fm.a,mm=sh(this.g,this.f,im+fm.j,jm);if(!mm)return fm=Error("Failed to generate media URL."),fm.type="dash",Promise.reject(fm);var nm=(fm.i||0)/fm.a;hm.push(new wh(km-nm,lm-nm,mm,jm));}"dynamic"==this.b.type?this.a=new ei(hm,this.b,this.c,this.h):this.a=new bi(hm);return Promise.resolve(this.a);};function oi(){this.C=pi++;this.id=this.K=this.J=null;this.b=0;this.height=this.width=this.bandwidth=null;this.c=this.a="";this.switchReason=this.fbQualityClass=this.fbQualityLabel=null;this.f=[];this.P=false;this.H=true;}var pi=0;oi.prototype.destroy=function(){this.J&&(this.J.destroy(),this.J=null);this.K&&(this.K.destroy(),this.K=null);};function qi(fm){var gm=fm.a||"";fm.c&&(gm+='; codecs="'+fm.c+'"');return gm;}function ri(){this.C=si++;this.id=null;this.contentType=this.lang="";this.b=false;this.o=[];this.a=[];}var si=0;ri.prototype.destroy=function(){for(var fm=0;fm<this.o.length;++fm)this.o[fm].destroy();this.a=this.o=null;};function ti(fm){for(var gm=[],hm=0;hm<fm.a.length;++hm){var im=new wi();im.id=fm.C;im.a=fm.a[hm];im.contentType=fm.contentType;im.b=fm.o.length?qi(fm.o[0]):"";gm.push(im);}return gm;}function ui(){this.id=null;this.start=0;this.b=null;this.a=[];}ui.prototype.destroy=function(){for(var fm=0;fm<this.a.length;++fm)this.a[fm].destroy();this.a=null;};function vi(){this.b=false;this.h=this.g=this.f=null;this.c=0;this.a=[];this.i=false;}vi.prototype.destroy=function(){for(var fm=0;fm<this.a.length;++fm)this.a[fm].destroy();this.a=null;};function wi(){this.id=0;this.a=null;this.b=this.contentType="";}function xi(fm,gm,hm,im,jm,km){sc.call(this,fm);this.b=gm;this.a=new ed(hm,im,jm);this.O=0;this.A=this.F=this.c=null;this.G=false;this.g=this.v=null;this.m=false;this.j=null;this.i=false;this.h=new xc();this.l=this.f=false;this.s=0;this.M=15;this.U=this.I=false;this.T=km;this.B=this.N=false;}m(xi,sc);xi.prototype.D=function(fm){null!=fm.initialStreamBufferSize&&(this.s=Number(fm.initialStreamBufferSize));null!=fm.streamBufferSize&&(this.M=Number(fm.streamBufferSize));null!=fm.addCdnDebugQueryParameters&&(this.I=Boolean(fm.addCdnDebugQueryParameters));null!=fm.useInitialBufferSizeWhenPaused&&(this.U=Boolean(fm.useInitialBufferSizeWhenPaused));null!=fm.segmentRequestTimeout&&(this.a.m=Number(fm.segmentRequestTimeout));null!=fm.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.N=Boolean(fm.resolveVideoTimeUpdateOnFragmentedTimeRanges));};xi.prototype.destroy=function(){fj(this);this.h.destroy();this.c=this.h=null;this.a.destroy();this.S=this.b=this.a=null;};j=xi.prototype;j.pa=function(){return this.c;};j.Ca=function(){return this.F;};j.lb=function(fm){this.f||fm.then(function(){this.f=true;this.g||ej(this,0);}.bind(this)).catch(function(){});return this.h;};j.Ea=function(){return this.l;};j.qa=function(fm,gm,hm,im){fm!=this.c&&(this.A=fm.K.create(),fm.J.create().then(dd(this,function(jm){if(this.b){var km=this.c;this.c=fm;this.F=jm;this.G=true;this.v=im?im:null;this.m||(km?gm&&yi(this,true,hm):ej(this,0));}})).catch(dd(this,function(jm){"aborted"!=jm.type&&(this.f?(jm=yb(jm),this.dispatchEvent(jm)):this.h.reject(jm));})));};j.ib=function(){return yi(this,false);};function yi(fm,gm,hm){fm.c&&!fm.m&&(fm.m=true,fj(fm),ld(fm.a).then(dd(fm,function(){var im=this.b.currentTime;if(!gm&&0<gd(this.a,im)&&0<=yh(this.a.b,im))return Promise.resolve();if(hm)return kd(this.a,this.b.currentTime+hm);this.B=true;return jd(this.a);})).then(dd(fm,function(){this.m=false;ej(this,0);})).catch(dd(fm,function(im){this.m=false;this.f?(im=yb(im),this.dispatchEvent(im)):this.h.reject(im);})));}j.jb=function(fm){return 0<gd(this.a,fm)&&0<=yh(this.a.b,fm);};j.ta=function(){};j.za=function(){return true;};function zi(fm){var gm=fm.U&&fm.b.paused?fm.s:fm.M;return fm.i?Math.max(fm.s,gm):fm.s;}j.Fb=function(){if(this.i&&!this.f){this.g=null;}else{var fm;if(fm=this.f&&!this.l)fm=1<this.a.c.buffered.length?true:false;if(fm){this.N&&(this.b.currentTime=md(this.a,this.b.currentTime)),yi(this,true);}else{this.g=null;fm=this.c;var gm=this.F,hm=this.b.currentTime;if(gd(this.a,this.i?hm:hm+(this.j||0))>=zi(this)){bj(this),ej(this,1000/(5*(Math.abs(this.b.playbackRate)||1)));}else{var im=aj(this,hm,gm);im?(gm=id(this.a,im,fm.b,this.A,this.I&&!this.b.paused),this.T&&"video"===fm.a.split("/")[0]&&this.T(im.b,im.a,{id:fm.id,reason:this.v}),this.A=null,this.G&&(this.G=false,im=this.v,this.v=null,cj(this,fm,im)),this.l=false,gm.then(dd(this,function(jm){var km=jm.W;jm=jm.nb;this.i||(this.O=jm);null==this.j&&(this.j=km);this.B&&0<gd(this.a,hm)&&(this.B=false,this.b.currentTime+=.001);ej(this,0);})).catch(dd(this,function(jm){if("aborted"!=jm.type){var km=[0,404,410,502,503,504];"net"==jm.type&&-1!=km.indexOf(jm.Rb.status)&&this.c&&ej(this,1000);jm=yb(jm);this.dispatchEvent(jm);}}))):(bj(this),this.f&&!this.l&&(this.l=true,dj(this)),ej(this,200));}}}};function aj(fm,gm,hm){fm=fm.a;var im=fm.b.length;fm=0<im?fm.b[im-1]:null;return null!=fm?null!=fm.a?hm.ja(fm.a):null:hm.ja(gm)||(hm.length()?hm.w():null);}function bj(fm){if(!fm.i&&null!=fm.j){fm.i=true;var gm=fm.a,hm=fm.j,im=hm-gm.s;0!=im&&(gm.b=zh(gm.b,im),gm.s=hm);fm.h.resolve(fm.j);}}function cj(fm,gm,hm){var im=gm.a.split("/")[0];gm=xb({type:"adaptation",bubbles:true,contentType:im,size:"video"!=im?null:{width:gm.width,height:gm.height},bandwidth:gm.bandwidth,reason:hm});fm.dispatchEvent(gm);}function dj(fm){var gm=xb({type:"ended"});fm.dispatchEvent(gm);}function ej(fm,gm){fm.g=i.setTimeout(fm.Fb.bind(fm),gm);}function fj(fm){null!=fm.g&&(i.clearTimeout(fm.g),fm.g=null);}j.Aa=function(){return this.O;};function gj(fm){this.b=fm;this.a=null;}gj.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null);};gj.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var fm=new wh(0,null,this.b);this.a=new bi([fm]);return Promise.resolve(this.a);};function hj(fm,gm){sc.call(this,fm);this.b=gm;this.g=true;this.h=this.f=null;this.c=new xc();this.a=null;}m(hj,sc);hj.prototype.D=function(){};hj.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.S=this.b=this.f=this.h=this.a=this.c=null;};j=hj.prototype;j.pa=function(){return this.f;};j.Ca=function(){return this.h;};j.lb=function(){return this.c;};j.Ea=function(){return true;};j.qa=function(fm){fm.J.create().then(dd(this,function(gm){if(this.b){if(0==gm.length())return Promise.reject(Error("No subtitles URL available."));var hm=this.f;this.f=fm;this.h=gm;gm=ci(gm).url.b[0].toString();var im=this.za();this.a&&(this.ta(false),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=gm;this.ta(im);gm=xb({type:"adaptation",bubbles:true,contentType:"text",size:null,bandwidth:fm.bandwidth});this.dispatchEvent(gm);hm||this.c.resolve(0);}}));};j.ib=function(){};j.jb=function(){return true;};j.ta=function(fm){this.g=fm;this.a&&(this.a.track.mode=fm?"showing":"disabled");};j.za=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g;};function ij(){}ij.prototype.parse=function(fm,gm,hm,im){var jm=null;try{var lm,mm=new ob(gm);if(440786851!=qb(mm).id){lm=null;}else{var nm=qb(mm);if(408125543!=nm.id){lm=null;}else{var om=nm.a.byteOffset,pm,qm=new ob(nm.a);for(gm=null;ib(qm.a);){var rm=qb(qm);if(357149030==rm.id){gm=rm;break;}}if(gm){for(var sm=new ob(gm.a),qm=1e+06;ib(sm.a);){var tm=qb(sm);if(2807729==tm.id){qm=tb(tm);break;}}pm=qm/1e+09;}else pm=null;lm=pm?{Lb:om,Pb:pm}:null;}}if(lm){var um=qb(new ob(fm));if(475249515!=um.id){jm=null;}else{var vm=lm.Lb,wm=lm.Pb;fm=[];var xm=new ob(um.a);for(lm=um=-1;ib(xm.a);){var ym=qb(xm);if(187==ym.id){var zm,an=new ob(ym.a),bn=qb(an);if(179!=bn.id){zm=null;}else{var cn=tb(bn),dn=qb(an);if(183!=dn.id){zm=null;}else{for(var en=new ob(dn.a),om=0;ib(en.a);){var fn=qb(en);if(241==fn.id){om=tb(fn);break;}}zm={Qb:cn,Kb:om};}}if(zm){var gn=wm*zm.Qb,hn=vm+zm.Kb;if(0<=um){var jn=new jh(im,hm,lm,hn-1);fm.push(new wh(um,gn,jn));}um=gn;lm=hn;}}}0<=um&&(jn=new jh(im,hm,lm,null),fm.push(new wh(um,null,jn)));jm=fm;}}else jm=null;}catch(km){if(!(km instanceof RangeError))throw km;}return jm;};function jj(fm,gm,hm,im,jm,km,lm,mm){this.h=fm;this.j=gm;this.f=hm;this.a=im;this.g=jm;this.b=km;this.l=lm;this.c=null;this.i=mm;}jj.prototype.destroy=function(){this.i=this.j=this.h=null;this.a.f();this.a=null;this.b&&(this.b.f(),this.b=null);this.g&&(this.g.f(),this.g=null);this.c=null;};jj.prototype.create=function(){if("webm"==this.f){var fm=Error("WebM is not supported in this build configuration.");fm.type="app";return Promise.reject(fm);}if(this.c)return this.c;fm=[mh(this.a)];"webm"==this.f&&fm.push(mh(this.g));this.b&&mh(this.b);return this.c=Promise.all(fm).then(dd(this,function(gm){var hm=gm[0];gm=gm[1]||null;var im=null;"mp4"==this.f?(im=new ai(),im=im.parse(new DataView(hm),this.a.h,this.a.b,this.i,this.b)):"webm"==this.f&&(im=new ij(),im=im.parse(new DataView(hm),new DataView(gm),this.a.b,this.i));if(!im)return hm=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),hm.type="stream",Promise.reject(hm);var jm;"dynamic"==this.h.type?jm=new ei(im,this.h,this.j,this.l):jm=new bi(im);return Promise.resolve(jm);}));};function kj(fm){this.a=fm;}function lj(fm,gm,hm){for(var im=eb()/1000,jm=0;jm<gm.a.length;++jm)for(var km=gm.a[jm],lm=0;lm<km.b.length;++lm){var mm=km.b[lm];if("text"!=mm.contentType)for(var nm=0;nm<mm.a.length;++nm){var om=mm.a[nm],pm=0,pm=pm+(om.g?1:0),pm=pm+(om.b?1:0),pm=pm+(om.a?1:0);0==pm?(mm.a.splice(nm,1),--nm):1!=pm&&(om.g?(om.b=null,om.a=null):om.b&&(om.a=null));}}mj(gm);for(jm=0;jm<gm.a.length;++jm)for(km=gm.a[jm],lm=0;lm<km.b.length;++lm){nm=mm=km.b[lm];om=null;for(pm=0;pm<nm.a.length;++pm){var qm=nm.a[pm].f||"";om?qm!=om&&(nm.a.splice(pm,1),--pm):om=qm;}0==mm.a.length&&(km.b.splice(lm,1),--lm);}"dynamic"==gm.type&&null==gm.c&&(gm.c=im);jm=new vi();"dynamic"==gm.type&&(jm.b=true,jm.f=gm.g,jm.g=new jh(hm,gm.j||gm.url),jm.h=gm.c);jm.c=gm.h||5;for(km=0;km<gm.a.length;++km){lm=gm.a[km];if(null==lm.start)break;lm=nj(fm,gm,lm,im,hm);jm.a.push(lm);}return jm;}function mj(fm){if(fm.a.length){null==fm.a[0].start&&(fm.a[0].start=0);var gm=function(nm){return 0==nm||!!nm;};"dynamic"==fm.type&&(fm.b=null);gm(fm.b)&&1==fm.a.length&&!gm(fm.a[0].a)&&(fm.a[0].a=fm.b);for(var hm=0,im=true,jm=0;jm<fm.a.length;++jm){var km=fm.a[jm-1],lm=fm.a[jm],mm=fm.a[jm+1]||{start:fm.b};!gm(lm.start)&&km&&gm(km.start)&&gm(km.a)&&(lm.start=km.start+km.a);!gm(lm.a)&&gm(mm.start)&&(lm.a=mm.start-lm.start);null!=lm.start&&null!=lm.a?hm+=lm.a:im=false;}gm(fm.b)||(jm=fm.a[fm.a.length-1],im?fm.b=hm:gm(jm.start)&&gm(jm.a)?fm.b=jm.start+jm.a:"dynamic"!=fm.type&&(fm.b=hm));}}function nj(fm,gm,hm,im,jm){var km=new ui();km.id=hm.id;km.start=hm.start;km.b=hm.a;var lm=new kc();hm.b.forEach(function(vm){lm.push(vm.contentType||"",vm);});for(var mm=nc(lm),nm=0;nm<mm.length;++nm){var om=new kc();lm.get(mm[nm]).forEach(function(vm){om.push(vm.group,vm);});for(var pm=nc(om),qm=0;qm<pm.length;++qm){var rm=new kc();om.get(pm[qm]).forEach(function(vm){rm.push(vm.lang,vm);});for(var sm=nc(rm),tm=0;tm<sm.length;++tm){var um=rm.get(sm[tm]),um=oj(fm,gm,hm,um,im,jm);km.a.push(um);}}}return km;}function oj(fm,gm,hm,im,jm,km){n(im.every(function(tm){return tm.group==im[0].group&&(tm.lang||"")==(im[0].lang||"")&&(tm.contentType||"")==(im[0].contentType||"");}));var lm=new ri(),mm=im.filter(function(tm){return null!=tm.id;});mm.length==im.length&&(lm.id=mm.map(function(tm){return tm.id;}).sort().reduce(function(tm,um){return tm+","+um;}));lm.lang=im[0].lang||"";lm.contentType=im[0].contentType||"";lm.b=im.some(function(tm){return tm.c;});for(var mm={},nm=0;nm<im.length;++nm)for(var om=im[nm],pm=0;pm<om.a.length;++pm){var qm=om.a[pm],rm=rj(fm,qm),sm=lm.a.slice(0);qj(rm,sm);0==sm.length&&0<lm.a.length||!(qm=tj(gm,hm,qm,jm,km))||(lm.o.push(qm),lm.a=sm,mm[qm.C]=om);}if(lm.a.some(function(tm){return ""==tm.a;}))return lm.o.forEach(function(tm){tm.P=true;}),lm;fm=pj(im);for(nm=0;nm<lm.o.length;++nm)qm=lm.o[nm],om=mm[qm.C],om==fm&&(qm.P=true);return lm;}function pj(fm){for(var gm=null,hm=null,im=0;im<fm.length;++im)for(var jm=fm[im],km=0;km<jm.a.length;++km){var lm=jm.a[km],lm=(lm.width||1)*(lm.height||1)*(lm.bandwidth||1);if(null==gm||lm<gm)gm=lm,hm=jm;}return hm;}function qj(fm,gm){if(0==gm.length){Array.prototype.push.apply(gm,fm);}else for(var hm=0;hm<gm.length;++hm){for(var im=false,jm=0;jm<fm.length;++jm){var km=gm[hm],lm=fm[jm];if(km.a==lm.a&&km.h==lm.h&&km.l==lm.l&&km.g==lm.g&&km.i==lm.i&&km.f==lm.f&&km.j==lm.j&&ud(km.c,lm.c)){im=true;xd(gm[hm],fm[jm].b);break;}}im||(gm.splice(hm,1),--hm);}}function rj(fm,gm){var hm=[];if(0==gm.c.length){hm.push(new vd());}else if(fm.a)for(var im=0;im<gm.c.length;++im)hm.push.apply(hm,sj(fm,gm.c[im]));return hm;}function sj(fm,gm){var hm=[];if(2!=fm.a.length)return [];var im=fm.a(gm.c||"",gm.f);if(!(im&&im instanceof Array))return [];for(var jm=0;jm<im.length;++jm){var km,lm=im[jm];km=new vd();if(lm){var mm=hc(lm,"keySystem");if(null!=mm){km.a=mm;}else throw Error("'keySystem' cannot be null.");var nm=hc(lm,"licenseServerUrl");if(null!=nm){km.h=nm;}else if(mm)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");mm=fc(lm,"withCredentials");null!=mm&&(km.l=mm);mm=jc(lm,"licensePostProcessor",Function);null!=mm&&(km.m=mm);mm=jc(lm,"licensePreProcessor",Function);null!=mm&&(km.s=mm);mm=fc(lm,"distinctiveIdentifierRequired");null!=mm&&(km.g=mm);mm=fc(lm,"persistentStateRequired");null!=mm&&(km.i=mm);mm=hc(lm,"audioRobustness");null!=mm&&(km.f=mm);mm=hc(lm,"videoRobustness");null!=mm&&(km.j=mm);mm=jc(lm,"serverCertificate",Uint8Array);null!=mm&&(km.c=mm);if(mm=jc(lm,"initData",Object)){lm=jc(mm,"initData",Uint8Array);if(null==lm)throw Error("'initData.initData' cannot be null.");mm=hc(mm,"initDataType");if(null==mm)throw Error("'initData.initDataType' cannot be null.");km.b.push({initData:new Uint8Array(lm.buffer),initDataType:mm});}}0==km.b.length&&gm.a&&gm.a.psshBox&&xd(km,[{initData:gm.a.psshBox,initDataType:"cenc"}]);hm.push(km);}return hm;}function tj(fm,gm,hm,im,jm){if(!hm.u||0===hm.u.length)return null;var km=null,lm=1,mm=0;if(hm.g){km=hm.f.split("/")[1];if("mp4"!=km&&"webm"!=km){km=null;}else{var nm=hm.g;"webm"!=km||nm.c?nm.a||nm.b&&nm.b.a?(lm=nm.b,lm||(lm=new ag(),lm.url=hm.u,lm.a=nm.a?nm.a.clone():null),mm=vj(lm,jm),lm=nm.c?vj(nm.c,jm):null,nm.f?(nm=nm.f,nm=new jh(jm,hm.u,nm.fa,nm.end)):nm=null,fm=new jj(fm,gm,km,mm,lm,nm,im,jm),gm=new vh(lm),im=new oi(),im.J=fm,im.K=gm,km=im):km=null:km=null;}lm=hm.g.h;mm=hm.g.g;}else if(hm.b){km=hm.b,!km.c&&!km.f&&1<km.b.length?km=null:km.c||gm.a||km.f||1!=km.b.length?km.f&&0===km.f.a.length?km=null:(km=km.h?vj(km.h,jm):null,fm=new mi(fm,gm,hm,im,jm),gm=new vh(km),im=new oi(),im.J=fm,im.K=gm,km=im):km=null,lm=hm.b.a,mm=hm.b.g;}else if(hm.a){fm:if(km=hm.a,lm=0+(km.f?1:0),lm+=km.c?1:0,lm+=km.b?1:0,0==lm?lm=false:(1!=lm&&(km.f?(km.c=null,km.b=null):km.c&&(km.b=null)),lm=true),lm){lm=null;if(km.g&&(lm=(km=hm.a.g)?uj(hm,km,bg):null,!lm)){km=null;break fm;}km=lm?vj(lm,jm):null;lm=hm.a;lm.f?(lm=hm.f.split("/")[1],"mp4"!=lm&&"webm"!=lm?fm=null:"webm"!=lm||km?sh(jm,hm,1,0)?(mm=(mm=hm.a.f)?uj(hm,mm,ag):null)?(mm=vj(mm,jm),fm=new jj(fm,gm,lm,mm,km,null,im,jm)):fm=null:fm=null:fm=null):fm=lm.h?lm.c?new ni(fm,gm,hm,im,jm):lm.b?"dynamic"!=fm.type&&null==gm.a?null:new li(fm,gm,hm,im,jm):null:null;fm?(gm=new vh(km),im=new oi(),im.J=fm,im.K=gm,km=im):km=null;}else km=null;;lm=hm.a.a;mm=hm.a.i;}else "text"==hm.f.split("/")[0]&&(km=new oi(),km.J=new gj(new jh(jm,hm.u)));if(!km)return null;km.id=hm.id;mm&&(km.b=-1*mm/lm);km.bandwidth=hm.bandwidth;km.width=hm.width;km.height=hm.height;km.a=hm.f||"";km.c=hm.h||"";km.fbQualityLabel=hm.fbQualityLabel||null;km.fbQualityClass=hm.fbQualityClass||null;for(fm=0;fm<hm.c.length;++fm)gm=hm.c[fm],gm.b&&km.f.push(gm.b);return km;}function uj(fm,gm,hm){gm=th(gm,fm.id,null,fm.bandwidth,null);if(!gm)return null;hm=new hm();hm.url=lh(fm.u,gm);return hm;}function vj(fm,gm){var hm=fm.url,im=0,jm=null;fm.a&&(im=fm.a.fa,jm=fm.a.end);return new jh(gm,hm,im,jm);}function wj(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[];}function xj(fm,gm){var hm=new yj(gm);fm.streamHistory.push(new zj(hm));if(hm.videoHeight||!fm.streamStats)fm.streamStats=hm;}function yj(fm){this.videoWidth=fm.width;this.videoHeight=fm.height;this.videoMimeType=fm.a;this.videoBandwidth=fm.bandwidth;}function zj(fm){this.timestamp=eb()/1000;this.value=fm;}function ak(fm,gm,hm,im,jm){this.b=new jh(null,[new ze(fm)]);this.a=new bh();this.a.body=gm;this.a.method=hm;this.a.a=3;this.a.l=im;this.a.c=0;fm=jm||{};for(var km in fm)this.a.b[km]=fm[km];}function bk(fm){return mh(fm.b,fm.a).then(function(gm){return Promise.resolve(new Uint8Array(gm));});}function ck(fm,gm,hm){sc.call(this,fm);this.c=gm;this.j=hm;this.a=this.h=null;this.i=new oc();this.b=[];this.f=[];this.m=0;this.g=new xc();this.l=null;}m(ck,sc);ck.prototype.destroy=function(){this.S=null;for(var fm=0;fm<this.f.length;++fm)this.f[fm].close().catch(function(){});this.f=[];this.b=this.a=this.h=null;this.g.destroy();this.g=null;this.i.destroy();this.i=null;this.l&&(i.clearTimeout(this.l),this.l=null);this.c=this.j=null;};ck.prototype.initialize=function(){var fm=new kc(),gm;gm=this.j;if(gm.D){gm=gm.a.a[0];for(var hm=[],im=0;im<gm.a.length;++im)hm.push.apply(hm,ti(gm.a[im]));gm=hm;}else gm=[];for(hm=0;hm<gm.length;++hm)im=gm[hm],im.a.a||im.b&&!kk(im.b)||fm.push(im.contentType,im);for(var hm={},im=false,jm=0;jm<gm.length;++jm){var km=gm[jm];if(km.a.a&&!fm.a.hasOwnProperty(km.contentType)){var lm=km.a.a,mm=hm[lm];mm||(mm=km.a,mm={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:mm.g?"required":"optional",persistentState:mm.i?"required":"optional",sessionTypes:["temporary"]},hm[lm]=mm);if(km.b&&(lm=km.contentType+"Capabilities",lm in mm)){im=true;mm[lm]||(mm[lm]=[]);var nm;"audio"==km.contentType?nm=km.a.f:"video"==km.contentType&&(nm=km.a.j);mm[lm].push({contentType:km.b,robustness:nm});}}}if(!im)if(gm.length){this.a=gm[0].a;}else throw fm=Error("No DrmInfo exists!"),fm.type="drm",fm;if(0==Object.keys(hm).length)return il(this.j,fm),this.g.resolve(),Promise.resolve();nm=new xc();hm=dk(hm,nm);hm=hm.then(this.v.bind(this,gm,fm));nm.reject(null);return hm;};function dk(fm,gm){for(var hm in fm)gm=gm.catch(function(im,jm){return navigator.requestMediaKeySystemAccess(im,[jm]);}.bind(null,hm,fm[hm]));return gm;}ck.prototype.v=function(fm,gm,hm){if(!this.c)return fk();for(var im=hm.keySystem,jm=hm.getConfiguration(),km=["audio","video"],lm=0;lm<km.length;++lm){var mm=km[lm];if(!gm.a.hasOwnProperty(mm)){var nm=jm[mm+"Capabilities"];if(nm){for(var nm=nm[0],om=[],pm={},qm=0;qm<fm.length;++qm){var rm=fm[qm],sm=nm?rm.b==nm.contentType:rm.contentType==mm;rm.a.a!=im||!sm||rm.id in pm||(om.push(rm),pm[rm.id]=true,this.a=this.a?wd(this.a,rm.a):rm.a);}gm.set(mm,om);}}}il(this.j,gm);return hm.createMediaKeys().then(function(tm){this.h=tm;}.bind(this));};function ek(fm){return fm.c?fm.h?fm.c.setMediaKeys(fm.h).then(dd(fm,function(){return this.c?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():fk();})).then(dd(fm,function(){if(!this.c)return fk();for(var gm=0;gm<this.a.b.length;++gm){var hm=this.a.b[gm];this.s({type:"encrypted",initDataType:hm.initDataType,initData:hm.initData});}0==this.a.b.length&&pc(this.i,this.c,"encrypted",this.s.bind(this));})):Promise.resolve():fk();}function fk(){var fm=Error("EmeManager destroyed");fm.type="destroy";return Promise.reject(fm);}ck.prototype.s=function(fm){for(var gm=new Uint8Array(fm.initData),hm=0;hm<this.b.length;++hm)if(ud(gm,this.b[hm].data))return;try{var jm=gk(this);}catch(im){gm=yb(im);this.dispatchEvent(gm);this.g.reject(im);return;}fm=jm.generateRequest(fm.initDataType,fm.initData);this.b.push({data:gm,Ha:jm});fm.catch(dd(this,function(km){if(this.c){for(var lm=0;lm<this.b.length;++lm)if(this.b[lm].Ha==jm){this.b.splice(lm,1);break;}lm=yb(km);this.dispatchEvent(lm);this.g.reject(km);}}));this.f.push(jm);};function gk(fm){var gm=null,gm=fm.h.createSession();pc(fm.i,gm,"message",fm.B.bind(fm));pc(fm.i,gm,"keystatuseschange",fm.A.bind(fm));return gm;}ck.prototype.B=function(fm){hk(this,fm.target,this.a,fm.message);};ck.prototype.A=function(fm){fm=fm.target;var gm={};fm.keyStatuses.forEach(function(im,jm){if("string"==typeof im){var km=im;im=jm;jm=km;}if("com.microsoft.playready"==this.a.a&&16==im.byteLength){var km=new DataView(im),lm=km.getUint32(0,true),mm=km.getUint16(4,true),nm=km.getUint16(6,true);km.setUint32(0,lm,false);km.setUint16(4,mm,false);km.setUint16(6,nm,false);}km=td(new Uint8Array(im));gm[km]=jm;}.bind(this));if(fm.expiration<Date.now()){for(var hm=0;hm<this.b.length;++hm)if(this.b[hm].Ha==fm){this.b.splice(hm,1);break;}fm.close();this.f.splice(this.f.indexOf(fm),1);}ll(this.j,gm);};function hk(fm,gm,hm,im){im=ik(hm,im);bk(new ak(im.url,im.body,im.method,hm.l,im.headers)).then(dd(fm,function(jm){hm.m&&(jm=hm.m(jm));return gm.update(jm);})).then(dd(fm,function(){var jm=xb({type:"sessionReady",detail:gm});this.dispatchEvent(jm);this.m++;this.m>=this.f.length&&this.g.resolve();})).catch(dd(fm,function(jm){jm.Ha=gm;jm=yb(jm);this.dispatchEvent(jm);}));}function ik(fm,gm){var hm={url:fm.h,body:gm.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===fm.a){for(var im=String.fromCharCode.apply(null,new Uint16Array(hm.body)),im=(new DOMParser()).parseFromString(im,"application/xml"),jm=im.getElementsByTagName("name"),km=im.getElementsByTagName("value"),lm=0;lm<jm.length;lm++)hm.headers[jm[lm].childNodes[0].nodeValue]=km[lm].childNodes[0].nodeValue;hm.body=i.atob(im.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue);}if(!fm.s)return hm;fm.s(hm);hm.url=hc(hm,"url");if(null==hm.url)throw Error("'url' cannot be null.");if(!(hm.body instanceof ArrayBuffer||"string"==typeof hm.body||null==hm.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");hm.method=hc(hm,"method");if("GET"!=hm.method&&"POST"!=hm.method)throw Error("'method' must be either 'GET' or 'POST'.");hm.headers=jc(hm,"headers",Object);if(null==hm.headers)throw Error("'headers' cannot be null.");return hm;}function jk(fm){sc.call(this,null);this.a=fm;this.b=null;this.f=new oc();this.i=this.h=null;this.B=0;this.v=null;this.j=false;this.F=this.G=true;this.g=new wj();this.c={enableAdaptation:true,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new v()};this.l=1;this.D=null;this.s=false;}m(jk,sc);l("shaka.player.Player",jk);jk.version="v1.6.4-fb";jk.isBrowserSupported=function(){return !!i.MediaSource&&!!i.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement" in document&&!!i.Uint8Array;};jk.prototype.U=function(fm){this.G=fm;};jk.prototype.setResumeAfterBuffering=jk.prototype.U;function kk(fm){return "text/vtt"==fm?!!i.VTTCue:MediaSource.isTypeSupported(fm);}jk.isTypeSupported=kk;jk.setTextStyle=function(fm){var gm=document.getElementById("ShakaPlayerTextStyle");gm||(gm=document.createElement("style"),gm.id="ShakaPlayerTextStyle",document.head.appendChild(gm));for(gm=gm.sheet;gm.cssRules.length;)gm.deleteRule(0);gm.insertRule("::cue { "+x(fm)+" }",0);};jk.prototype.destroy=function(){return this.m().then(dd(this,function(){this.f.destroy();this.a=this.f=null;})).catch(function(){});};jk.prototype.destroy=jk.prototype.destroy;jk.prototype.m=function(){if(!this.b)return Promise.resolve();this.j&&qk(this);this.a.pause();qc(this.f);pk(this);nk(this);this.h&&(this.h.destroy(),this.h=null);this.a.src="";var fm=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.j=false;this.g=new wj();return fm;};jk.prototype.unload=jk.prototype.m;jk.prototype.la=function(fm){return lk(this,fm,false);};jk.prototype.load=jk.prototype.la;jk.prototype.N=function(fm){return lk(this,fm,true);};jk.prototype.loadWithSilencedErrors=jk.prototype.N;function lk(fm,gm,hm){dl(gm,fm.a);var im=fm.m();fm.a.autoplay&&(p("load"),pc(fm.f,fm.a,"timeupdate",fm.ub.bind(fm)));gm.Za(fm.c);gm.O=fm.D;fm.D=null;im=im.then(dd(fm,function(){return gm.Ja();}));im.catch(dd(fm,function(jm){gm.destroy();return Promise.reject(jm);}));return im.then(dd(fm,function(){if(!this.a)return mk();this.b=gm;pc(this.f,this.b,"seekrangechanged",this.Bb.bind(this));this.h=new ck(this,this.a,this.b);return this.h.initialize();})).then(dd(fm,function(){if(!this.a)return mk();pc(this.f,this.a,"error",this.Nb.bind(this));pc(this.f,this.a,"playing",this.Ab.bind(this));pc(this.f,this.a,"pause",this.zb.bind(this));return el(this.b,this,this.a);})).then(dd(fm,function(){return this.a?ek(this.h):mk();})).then(dd(fm,function(){if(!this.a)return mk();ok(this);})).catch(dd(fm,function(jm){if(!this.a)return mk();if(true!==hm&&"destroy"!=jm.type){var km=yb(jm);this.dispatchEvent(km);}return this.m().then(function(){return Promise.reject(jm);});}));}function mk(){var fm=Error("Player destroyed");fm.type="destroy";return Promise.reject(fm);}j=jk.prototype;j.ub=function(){q("load");this.g.playbackLatency=r("load")/1000;this.f.ra(this.a,"timeupdate");};j.Nb=function(){if(this.a.error){var fm=this.a.error.code;fm!=MediaError.MEDIA_ERR_ABORTED&&(fm=Error(rk[fm]||"Unknown playback error."),fm.type="playback",fm=yb(fm),this.dispatchEvent(fm));}};j.Ab=function(){p("playing");!this.i&&0>this.l&&(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),this.l));this.j&&!this.F&&qk(this);};j.zb=function(){q("playing");var fm=r("playing");if(!isNaN(fm)){var gm=this.g;gm.playTime+=fm/1000;}nk(this);};j.Bb=function(fm){this.B=fm.start;};j.kb=function(){if(!this.a.paused){q("playing");var fm=r("playing");if(!isNaN(fm)){var gm=this.g;gm.playTime+=fm/1000;p("playing");}}fm=this.g;gm=this.a;gm.getVideoPlaybackQuality&&(gm=gm.getVideoPlaybackQuality(),fm.decodedFrames=gm.totalVideoFrames,fm.droppedFrames=gm.droppedVideoFrames);return this.g;};jk.prototype.getStats=jk.prototype.kb;jk.prototype.ka=function(){return this.b?this.b.N():[];};jk.prototype.getVideoTracks=jk.prototype.ka;jk.prototype.ca=function(){return this.b?this.b.ba():[];};jk.prototype.getAudioTracks=jk.prototype.ca;jk.prototype.ea=function(){return this.b?this.b.$a():[];};jk.prototype.getTextTracks=jk.prototype.ea;jk.prototype.selectVideoTrack=function(fm,gm){return this.b?this.b.selectVideoTrack(fm,void 0==gm?true:gm):false;};jk.prototype.selectVideoTrack=jk.prototype.selectVideoTrack;jk.prototype.ma=function(fm,gm,hm){return this.b?nl(this.b,"audio",fm,void 0==gm?true:gm,hm):false;};jk.prototype.selectAudioTrack=jk.prototype.ma;jk.prototype.na=function(fm){return this.b?nl(this.b,"text",fm,false):false;};jk.prototype.selectTextTrack=jk.prototype.na;jk.prototype.ba=function(fm){this.b&&jl(this.b,fm);};jk.prototype.enableTextTrack=jk.prototype.ba;jk.prototype.T=function(fm){nk(this);0<=fm?this.a.playbackRate=fm:this.a.paused||(this.a.playbackRate=0,this.A(this.a.currentTime,Date.now(),fm));this.l=fm;};jk.prototype.setPlaybackRate=jk.prototype.T;jk.prototype.M=function(){return this.l;};jk.prototype.getPlaybackRate=jk.prototype.M;jk.prototype.oa=function(fm){this.D=fm;};jk.prototype.setPlaybackStartTime=jk.prototype.oa;jk.prototype.I=function(){return this.b?this.b.ab():false;};jk.prototype.isLive=jk.prototype.I;jk.prototype.aa=function(fm){if(fm){var gm=fc(fm,"enableAdaptation");null!=gm&&(this.c.enableAdaptation=gm);gm=fc(fm,"endBufferingOnPlaying");null!=gm&&(this.F=gm);gm=fc(fm,"usePlaybackRateForBuffering");null!=gm&&(this.s=gm);gm=gc(fm,"streamBufferSize",0);null!=gm&&(this.c.streamBufferSize=gm);gm=fc(fm,"addCdnDebugQueryParameters");null!=gm&&(this.c.addCdnDebugQueryParameters=gm);gm=gc(fm,"initialStreamBufferSize",0);null!=gm&&(this.c.initialStreamBufferSize=gm);gm=fc(fm,"includeStreamBufferSizeInStartOffset");null!=gm&&(this.c.includeStreamBufferSizeInStartOffset=gm);gm=gc(fm,"liveStreamEndTimeout",0);null!=gm&&(this.c.liveStreamEndTimeout=gm);gm=gc(fm,"licenseRequestTimeout",0);null!=gm&&(this.c.licenseRequestTimeout=gm);gm=gc(fm,"mpdRequestTimeout",0);null!=gm&&(this.c.mpdRequestTimeout=gm);gm=gc(fm,"minMpdRefreshInterval",0);null!=gm&&(this.c.minMpdRefreshInterval=gm);gm=fc(fm,"enableLiveInterruptionDetection");null!=gm&&(this.c.enableLiveInterruptionDetection=gm);gm=fc(fm,"resolveVideoTimeUpdateOnFragmentedTimeRanges");null!=gm&&(this.c.resolveVideoTimeUpdateOnFragmentedTimeRanges=gm);gm=gc(fm,"liveInterruptionConsecutiveUpdatesWithoutChange");null!=gm&&(this.c.liveInterruptionConsecutiveUpdatesWithoutChange=gm);gm=gc(fm,"liveInterruptionConsecutiveUpdatesWithChange");null!=gm&&(this.c.liveInterruptionConsecutiveUpdatesWithChange=gm);gm=fc(fm,"liveSendPushHeaders");null!=gm&&(this.c.liveSendPushHeaders=gm);gm=gc(fm,"liveMaxSegmentsToPush");null!=gm&&(this.c.liveMaxSegmentsToPush=gm);gm=gc(fm,"segmentRequestTimeout",0);null!=gm&&(this.c.segmentRequestTimeout=gm);gm=hc(fm,"preferredLanguage");null!=gm&&(this.c.preferredLanguage=gm);gm=jc(fm,"restrictions",v);null!=gm&&(this.c.restrictions=gm.clone());fm=fc(fm,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=fm&&(ch=!fm);this.b&&this.b.Za(this.c);}};jk.prototype.configure=jk.prototype.aa;jk.prototype.da=function(){return this.c;};jk.prototype.getConfiguration=jk.prototype.da;function nk(fm){fm.i&&(i.clearTimeout(fm.i),fm.i=null);}function ok(fm){pk(fm);fm.v=i.setTimeout(fm.O.bind(fm),100);}function pk(fm){fm.v&&(i.clearTimeout(fm.v),fm.v=null);}jk.prototype.A=function(fm,gm,hm){this.i=null;var im=(Date.now()-gm)/1000*hm;this.a.currentTime<this.B+(this.I()?1:.05)?this.a.pause():(im=Math.max(this.B,fm+im),this.a.currentTime=im,this.i=i.setTimeout(this.A.bind(this,fm,gm,hm),250));};function qk(fm){q("buffering");var gm=fm.g;gm.bufferingTime+=r("buffering")/1000;fm.s&&(fm.a.playbackRate=fm.l);fm.j=false;fm.dispatchEvent(xb({type:"bufferingEnd"}));}jk.prototype.O=function(){ok(this);if(!this.a.ended&&!this.a.seeking){var fm=this.a.buffered,gm=fm.length?fm.end(fm.length-1):0,fm=Math.max(gm-this.a.currentTime,0),hm=this.a.currentTime,im=this.a.duration,im=isNaN(im)?0:Math.max(im-.05,0),gm=gm>=im||hm>=im;if(this.j){if(gm=this.b,fm>(gm.Ra?Number(gm.g.streamBufferSize):Number(gm.g.initialStreamBufferSize))||yl(this.b))qk(this),this.G&&!this.s&&this.a.play();}else !this.a.paused&&!gm&&.5>fm&&(this.j=true,this.s?this.a.playbackRate=0:this.a.pause(),this.g.bufferingHistory.push(eb()/1000),p("buffering"),this.dispatchEvent(xb({type:"bufferingStart"}))),yl(this.b)&&qk(this);}};var rk={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function sk(fm){for(var gm=0;gm<fm.length;++gm)for(var hm=fm[gm],im=0;im<hm.a.length;++im){for(var jm=hm.a[im],km=jm,lm=0;lm<km.o.length;++lm)kk(qi(km.o[lm]))||(km.o.splice(lm,1),--lm);0==jm.o.length&&(hm.a.splice(im,1),--im);}for(gm=0;gm<fm.length;++gm)for(hm=fm[gm],im=0;im<hm.a.length;++im)hm.a[im].o.sort(tk);}function tk(fm,gm){var hm=fm.bandwidth||Number.MAX_VALUE,im=gm.bandwidth||Number.MAX_VALUE;return hm<im?-1:hm>im?1:0;}function uk(fm){this.a=fm;}uk.prototype.destroy=function(){this.a.destroy();this.a=null;};uk.prototype.update=function(fm){var gm=vk(fm),hm=vk(this.a);return Promise.all([gm,hm]).then(dd(this,function(im){var jm=im[0];im=im[1];sk(this.a.a);fm.b&&!this.a.b&&(fm.i=true);fm.f=this.a.f;fm.g=this.a.g?this.a.g.clone():null;fm.c=this.a.c;var km=[];wk(fm,this.a,jm,im,km);sk(fm.a);return Promise.resolve(km);}));};function vk(fm){function gm(im,jm){return im.concat(jm);}var hm=fm.a.map(function(im){return im.a;}).reduce(gm,[]).map(function(im){return im.o;}).reduce(gm,[]);fm=hm.map(function(im){return im.J.create();});return Promise.all(fm).then(function(im){for(var jm={},km=0;km<hm.length;++km)jm[hm[km].C]=im[km];return Promise.resolve(jm);});}function wk(fm,gm,hm,im,jm){var km=new kc();fm.a.forEach(function(om,pm){km.push(om.id||""+pm,om);});var lm=new kc();gm.a.forEach(function(om,pm){lm.push(om.id||""+pm,om);});fm=nc(km);for(gm=0;gm<fm.length;++gm){var mm=fm[gm],nm=km.get(mm);1<nm.length||(mm=lm.get(mm))&&0!=mm.length&&1==mm.length&&(xk(nm[0],mm[0],hm,im,jm),nm[0].b=mm[0].b);}}function xk(fm,gm,hm,im,jm){var km=new kc();fm.a.forEach(function(om,pm){km.push(om.id||""+pm,om);});var lm=new kc();gm.a.forEach(function(om,pm){lm.push(om.id||""+pm,om);});fm=nc(km);for(gm=0;gm<fm.length;++gm){var mm=fm[gm],nm=km.get(mm);1<nm.length||(mm=lm.get(mm))&&0!=mm.length&&1==mm.length&&yk(nm[0],mm[0],hm,im,jm);}}function yk(fm,gm,hm,im,jm){var km=new kc();fm.o.forEach(function(qm,rm){km.push(qm.id||""+rm,qm);});var lm=new kc();gm.o.forEach(function(qm,rm){lm.push(qm.id||""+rm,qm);});gm={};for(var mm=nc(km),nm=0;nm<mm.length;++nm){var om=mm[nm];gm[om]=om;var pm=km.get(om);1<pm.length||((om=lm.get(om))&&0!=om.length?1==om.length&&(zk(pm[0],om[0],hm,im),pm[0].K=om[0].K,om[0].K=null,pm[0].b=om[0].b):(jm.push(pm[0]),fm.o.splice(fm.o.indexOf(pm[0]),1)));}mm=nc(lm);for(nm=0;nm<mm.length;++nm)om=mm[nm],gm[om]||(gm[om]=om,om=lm.get(om),fm.o.push(om[0]));}function zk(fm,gm,hm,im){fm=hm[fm.C];im=im[gm.C];gm=fm.length();fm.Fa(im)&&(im=fm.length(),fm.j.push(gm!==im),50<fm.j.length&&fm.j.shift());}function al(){this.a=this.b=null;this.f=new oc();this.c=Number.POSITIVE_INFINITY;this.i=true;this.g=false;}l("shaka.media.SimpleAbrManager",al);al.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null;};al.prototype.initialize=function(fm,gm){this.b||this.a||(this.b=fm,this.a=gm);};al.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4000,pc(this.f,this.b,"bandwidth",this.l.bind(this)),pc(this.f,this.a,"adaptation",this.j.bind(this)),pc(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=true);};al.prototype.enable=function(fm){this.i=fm;};al.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var fm=bl(this);return fm?fm.id:null;};al.prototype.getInitialSwitchReason=function(){return null;};al.prototype.getInitialAudioTrackId=function(){return null;};al.prototype.selectVideoTrack=function(fm,gm,hm){this.g&&this.a.selectVideoTrack(fm.id,gm,hm);};al.prototype.l=function(){Date.now()<this.c||this.h();};al.prototype.h=function(){if(this.i){var fm=bl(this);if(fm){if(fm.active){this.c=Date.now()+3000;return;}this.selectVideoTrack(fm,false);}this.c=Number.POSITIVE_INFINITY;}};al.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+30000);};function bl(fm){var gm=fm.a.N();if(0==gm.length)return null;gm.sort(fa);var hm;fm:{hm=fm.a.ba();for(var im=0;im<hm.length;++im)if(hm[im].active){hm=hm[im];break fm;}hm=null;};hm=hm?hm.bandwidth:0;fm=fm.b.getBandwidth();for(var im=gm[0],jm=0;jm<gm.length;++jm){var km=gm[jm],lm=jm+1<gm.length?gm[jm+1]:{bandwidth:Number.POSITIVE_INFINITY};if(km.bandwidth&&(lm=(lm.bandwidth+hm)/.85,fm>=(km.bandwidth+hm)/.95&&fm<=lm&&(im=km,im.active)))break;}return im;}function cl(fm,gm,hm){sc.call(this,null);this.a=fm;this.da=gm;this.j=new oc();this.h=new MediaSource();this.f=null;this.xa=0;this.Qa=false;this.wa=0;this.oa=3;this.na=this.Ra=false;this.ma=Infinity;this.c=new kc();this.l=hm;this.l.initialize(gm,this);this.D=false;this.B="en";this.ea=false;this.G=null;this.v=new xc();this.cb=new xc();this.i=new v();this.A=null;this.Wa=1;this.b={};this.U=new xc();this.la=0;this.Va=15;this.s=null;this.Oa=this.Sa=false;this.m={};this.O=this.M=this.I=null;this.g={};this.ca=false;this.bb=null;}m(cl,sc);l("shaka.player.StreamVideoSource",cl);cl.prototype.Za=function(fm){null!=fm.streamBufferSize&&(this.g.streamBufferSize=fm.streamBufferSize);null!=fm.initialStreamBufferSize&&(this.g.initialStreamBufferSize=fm.initialStreamBufferSize);null!=fm.addCdnDebugQueryParameters&&(this.g.addCdnDebugQueryParameters=fm.addCdnDebugQueryParameters);null!=fm.segmentRequestTimeout&&(this.g.segmentRequestTimeout=fm.segmentRequestTimeout);null!=fm.resolveVideoTimeUpdateOnFragmentedTimeRanges&&(this.g.resolveVideoTimeUpdateOnFragmentedTimeRanges=fm.resolveVideoTimeUpdateOnFragmentedTimeRanges);dm(this);null!=fm.includeStreamBufferSizeInStartOffset&&(this.Qa=Boolean(fm.includeStreamBufferSizeInStartOffset));null!=fm.enableAdaptation&&this.l.enable(Boolean(fm.enableAdaptation));null!=fm.mpdRequestTimeout&&(this.wa=Number(fm.mpdRequestTimeout));null!=fm.minMpdRefreshInterval&&(this.oa=Number(fm.minMpdRefreshInterval)/1000);null!=fm.liveStreamEndTimeout&&(this.Va=Number(fm.liveStreamEndTimeout));null!=fm.preferredLanguage&&(this.B=cc(String(fm.preferredLanguage)));null!=fm.liveSendPushHeaders&&(this.na=Boolean(fm.liveSendPushHeaders));null!=fm.liveMaxSegmentsToPush&&(this.ma=Number(fm.liveMaxSegmentsToPush));null!=fm.restrictions&&(this.i=fm.restrictions,this.D&&kl(this));};cl.prototype.destroy=function(){this.v.destroy();this.U.destroy();this.U=this.v=null;this.M&&(i.clearTimeout(this.M),this.M=null);this.I&&(i.clearTimeout(this.I),this.I=null);this.m=null;this.j.destroy();this.j=null;ec(this.b).forEach(function(fm){fm.destroy();});this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);this.l.destroy();this.S=this.i=this.G=this.f=this.h=this.da=this.l=null;};function dl(fm,gm){pc(fm.j,fm.h,"sourceopen",fm.vb.bind(fm));gm.src=i.URL.createObjectURL(fm.h);}function el(fm,gm,hm){if(!fm.D)return fm=Error("Cannot call attach() right now."),fm.type="app",Promise.reject(fm);fm.S=gm;fm.f=hm;fm.G=gm.kb();pc(fm.j,fm.da,"bandwidth",fm.Ob.bind(fm));fm.a.b&&(pc(fm.j,gm,"bufferingStart",fm.tb.bind(fm)),pc(fm.j,gm,"bufferingEnd",fm.sb.bind(fm)));gm=fm.f.setMediaKeys(fm.f.mediaKeys);fm.cb.then(dd(fm,function(){pl(this).then(dd(this,function(){this.v&&this.v.resolve();})).catch(dd(this,function(im){this.v&&this.v.reject(im);}));}));return Promise.all([fm.v,gm]);}j=cl.prototype;j.Ja=function(){if(this.D){var fm=Error("Cannot call load() right now.");fm.type="app";return Promise.reject(fm);}if(!this.a||0==this.a.a.length)return fm=Error("The manifest does not specify any content."),fm.type="stream",Promise.reject(fm);sk(this.a.a);if(0==this.a.a.length||0==this.a.a[0].a.length||!this.a.a[0].a.some(function(gm){return "video"===gm.contentType;}))return fm=Error("The manifest specifies content that cannot be displayed on this browser/platform."),fm.type="stream",Promise.reject(fm);this.D=true;this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);dm(this);kl(this);return Promise.resolve();};function fl(fm){var gm=xb({type:"manifestwrapped",bubbles:true});fm.dispatchEvent(gm);}j.gb=function(fm){var gm=Date.now(),hm=this.I=null,im,jm;if(this.na){im=Math.floor(am(this))+1;im=Math.min(im,this.ma);var km=this.b.video;if(km=km?km.Ca():null)km=km.w(),null!=km.c&&(jm=km.c);if(this.f.paused||this.ca)im=0;}km=this.a.g;(fm?this.eb():this.fb(km,im,jm)).then(dd(this,function(lm){hm=new uk(lm);return hm.update(this.a);})).then(dd(this,function(lm){hm.destroy();hm=null;zl(this).some(function(nm){return nm.Ma;})&&fl(this);var mm=bm(this,zl(this));mm&&this.f.paused&&mm.end>this.f.currentTime+10&&(this.f.currentTime=mm.end);if(yl(this))return this.sa();for(mm=0;mm<lm.length;++mm)hl(this,lm[mm]);this.g.initialStreamBufferSize=Math.max(this.g.initialStreamBufferSize||0,this.a.c);this.g.useInitialBufferSizeWhenPaused=this.a.b;dm(this);kl(this);0==Object.keys(this.b).length?pl(this):gl(this,(Date.now()-gm)/1000);})).catch(dd(this,function(lm){hm&&(hm.destroy(),hm=null);"aborted"!=lm.type&&(lm=yb(lm),this.dispatchEvent(lm),this.a&&gl(this,0));}));};j.fb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.");};j.eb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.");};function gl(fm,gm){if(null!=fm.a.f){var hm=Math.max(fm.a.f,fm.oa),hm=Math.max(hm-gm,0);fm.I=i.setTimeout(fm.gb.bind(fm,false),1000*hm);}}function hl(fm,gm){var hm=gm.a.split("/")[0],im=fm.b[hm];if(im&&im.pa()==gm){var jm=fm.c.get(gm.a.split("/")[0]).map(function(km){return km.o;}).reduce(function(km,lm){return km.concat(lm);},[]).filter(function(km){return km.P&&km.H;});if(0==jm.length){hm=Error("All usable streams have been removed from the manifest.");hm.type="app";hm=yb(hm);fm.dispatchEvent(hm);return;}fm.m[hm].Ka==gm&&delete fm.m[hm];im.qa(jm[0],true);gm.destroy();}gm.destroy();}j.Mb=function(fm){this.bb=fm;};cl.prototype.setTaggedTimeRangesEntryAdder=cl.prototype.Mb;cl.prototype.N=function(){if(!this.c.a.hasOwnProperty("video"))return [];for(var fm=this.b.video,fm=(fm=fm?fm.pa():null)?fm.C:0,gm=[],hm=this.c.get("video"),im=0;im<hm.length;++im)for(var jm=hm[im],km=0;km<jm.o.length;++km){var lm=jm.o[km];if(lm.P&&lm.H){var mm=lm.C,lm=new ea(mm,lm.bandwidth,lm.width,lm.height,lm.id,lm.fbQualityLabel,lm.fbQualityClass);mm==fm&&(lm.active=true);gm.push(lm);}}return gm;};cl.prototype.getVideoTracks=cl.prototype.N;cl.prototype.ba=function(){if(!this.c.a.hasOwnProperty("audio"))return [];for(var fm=this.b.audio,fm=(fm=fm?fm.pa():null)?fm.C:0,gm=[],hm=this.c.get("audio"),im=0;im<hm.length;++im)for(var jm=hm[im],km=jm.lang,lm=0;lm<jm.o.length;++lm){var mm=jm.o[lm];if(mm.P&&mm.H){var nm=mm.C,mm=new u(nm,mm.bandwidth,km,mm.id);nm==fm&&(mm.active=true);gm.push(mm);}}return gm;};cl.prototype.getAudioTracks=cl.prototype.ba;cl.prototype.$a=function(){if(!this.c.a.hasOwnProperty("text"))return [];for(var fm=this.b.text,gm=fm?fm.pa():null,gm=gm?gm.C:0,hm=[],im=this.c.get("text"),jm=0;jm<im.length;++jm)for(var km=im[jm],lm=km.lang,mm=0;mm<km.o.length;++mm){var nm=km.o[mm].C,om=new da(nm,lm);nm==gm&&(om.active=true,om.enabled=fm.za());hm.push(om);}return hm;};cl.prototype.getTextTracks=cl.prototype.$a;function il(fm,gm){if(fm.D){for(var hm={},im=fm.a.a[0],jm=0;jm<im.a.length;++jm){var km=im.a[jm];hm[km.C]=km;}fm.c.a={};im=nc(gm);for(jm=0;jm<im.length;++jm){var km=im[jm],lm=gm.get(km);if("video"==km){var mm=lm[0].id;fm.c.push(km,hm[mm]);}else if("audio"==km){for(var mm=lm[0].b.split(";")[0],nm=0;nm<lm.length;++nm){var om=lm[nm];om.b.split(";")[0]==mm&&fm.c.push(km,hm[om.id]);}}else for(nm=0;nm<lm.length;++nm)mm=lm[nm].id,fm.c.push(km,hm[mm]);}fm.ea=true;if(hm=fm.c.get("audio"))ol(fm,hm),fm.c.set("audio",hm),hm=hm[0].lang||fm.B,zb(2,fm.B,hm)&&(fm.ea=false);if(hm=fm.c.get("text"))ol(fm,hm),fm.c.set("text",hm),hm=hm[0].lang||fm.B,zb(2,fm.B,hm)||(fm.ea=false);}}cl.prototype.selectVideoTrack=function(fm,gm,hm,im){return nl(this,"video",fm,gm,hm,im);};function jl(fm,gm){var hm=fm.b.text;hm&&hm.ta(gm);}function kl(fm){if(fm.i){for(var gm=false,hm=0;hm<fm.a.a.length;++hm)for(var im=fm.a.a[hm],jm=0;jm<im.a.length;++jm){var km=im.a[jm];if("video"==km.contentType)for(var lm=0;lm<km.o.length;++lm){var mm=km.o[lm],nm=mm.H;mm.H=true;fm.i.maxWidth&&mm.width>fm.i.maxWidth&&(mm.H=false);fm.i.maxHeight&&mm.height>fm.i.maxHeight&&(mm.H=false);fm.i.minHeight&&mm.height<fm.i.minHeight&&(mm.H=false);fm.i.maxBandwidth&&mm.bandwidth>fm.i.maxBandwidth&&(mm.H=false);fm.i.minBandwidth&&mm.bandwidth<fm.i.minBandwidth&&(mm.H=false);nm!=mm.H&&(gm=true);}}0!=lc(fm.c).length&&gm&&(ml(fm),0<fm.N().length||(gm=Error("The application has restricted all video tracks!"),gm.type="app",gm=yb(gm),fm.dispatchEvent(gm)));}}cl.prototype.ab=function(){return this.a?this.a.b:false;};cl.prototype.isLive=cl.prototype.ab;cl.prototype.ob=function(fm){this.Ra=fm;};cl.prototype.setIsLiveInterrupted=cl.prototype.ob;function ll(fm,gm){for(var hm,im=false,jm=new kc(),km=lc(fm.c),lm=0;lm<km.length;++lm)for(var mm=km[lm],nm=0;nm<mm.o.length;++nm){var om=mm.o[nm];om.f.forEach(function(pm){jm.push(pm,om);});}for(hm in gm)if(km=ub[gm[hm]]||null,mm=jm.get(hm)){for(lm=0;lm<mm.length;++lm)om=mm[lm],nm=om.P,om.P=!km,nm!=om.P&&(im=true);}else yc(hm);im&&(ml(fm),im=fm.ba(),hm=fm.N(),im=fm.c.a.hasOwnProperty("audio")&&0==im.length,hm=fm.c.a.hasOwnProperty("video")&&0==hm.length,im||hm)&&(hm=Error("The key system has restricted all "+(im&&hm?"audio and video tracks.":im?"audio tracks.":"video tracks.")),hm.type="drm",hm=yb(hm),fm.dispatchEvent(hm));}function ml(fm){var gm=xb({type:"trackschanged",bubbles:true});fm.dispatchEvent(gm);}function nl(fm,gm,hm,im,jm,km){if(!fm.c.a.hasOwnProperty(gm)||!fm.b[gm])return false;for(var lm=fm.c.get(gm),mm=0;mm<lm.length;++mm)for(var nm=lm[mm],om=0;om<nm.o.length;++om){var pm=nm.o[om];if(pm.C==hm){if(!pm.P||!pm.H)return false;if("text"!=gm&&!fm.Oa)return hm=fm.m[gm],fm.m[gm]={Ka:pm,Ta:null!=hm&&hm.Ta||im,Ua:null!=hm&&hm.Ua||jm,switchReason:km},true;xj(fm.G,pm);fm.b[gm].qa(pm,im,jm,km);return true;}}return false;}function ol(fm,gm){for(var hm=0;2>=hm;++hm)for(var im=0;im<gm.length;++im){var jm=gm[im];if(zb(hm,fm.B,jm.lang)){gm.splice(im,1);gm.splice(0,0,jm);return;}}for(im=0;im<gm.length;++im)if(jm=gm[im],jm.b){gm.splice(im,1);gm.splice(0,0,jm);break;}}j=cl.prototype;j.vb=function(){this.j.ra(this.h,"sourceopen");this.cb.resolve();};function pl(fm){for(var gm=[],hm=["audio","video","text"],im=0;im<hm.length;++im){var jm=hm[im];fm.c.a.hasOwnProperty(jm)&&gm.push(fm.c.get(jm)[0]);}for(var km=ql(fm,gm),im=0;im<hm.length;++im)if(jm=hm[im],fm.c.a.hasOwnProperty(jm)&&!km[jm])return fm=Error("Unable to select an initial "+jm+" stream: all "+jm+" streams have been restricted (by the application or by the key system)."),fm.type="stream",Promise.reject(fm);gm=ec(km).map(function(lm){return lm.J.create();});return Promise.all(gm).then(dd(fm,function(lm){if(!lm.every(function(mm){return mm.length();}))return lm=Error("Some streams are not available."),lm.type="stream",Promise.reject(lm);lm=bm(this,lm);if(!lm)return lm=Error("Some streams are not available."),lm.type="stream",Promise.reject(lm);if(!rl(this,km))return lm=Error("Failed to create Stream objects."),lm.type="stream",Promise.reject(lm);this.l.start();tl(this,km,lm);return Promise.resolve();})).catch(dd(fm,function(lm){if("aborted"!=lm.type)return Object.keys(this.b),this.a.b?(eb()<this.a.h?(lm=Math.max(this.a.h-Date.now()/1000,this.oa),this.I=i.setTimeout(this.gb.bind(this,true),1000*lm)):gl(this,0),Promise.resolve()):Promise.reject(lm);}));}function ql(fm,gm){for(var hm={},im=0;im<gm.length;++im){var jm=gm[im],km=null;if("video"==jm.contentType){var lm=fm.l.getInitialVideoTrackId();if(null==lm)continue;km=jm.o.filter(function(mm){return mm.C==lm;});if(0==km.length)continue;km=km[0];}else if("audio"==jm.contentType){if(lm=fm.l.getInitialAudioTrackId(),km=jm.o.filter(function(mm){return mm.C==lm;}),0==km.length){km=jm.o.filter(function(mm){return mm.P&&mm.H;});if(0==km.length)continue;km=jm.o[Math.floor(km.length/2)];}else km=km[0];}else 0<jm.o.length&&(km=jm.o[0]);hm[jm.contentType]=km;}return hm;}function rl(fm,gm){var hm={},im;for(im in gm){var jm=gm[im],jm="text"==im?new hj(fm,fm.f):sl(fm,jm);if(!jm)return ec(hm).forEach(function(km){km.destroy();}),false;hm[im]=jm;}fm.b=hm;return true;}function sl(fm,gm){var hm=new xi(fm,fm.f,fm.h,qi(gm),fm.da,fm.bb);hm.D(fm.g);return hm;}function tl(fm,gm,hm){fm.Wa=fm.f.playbackRate;fm.f.playbackRate=0;vl(fm,hm);var im;fm.O&&fm.O<=hm.end&&fm.O>=hm.start?im=fm.O:fm.a.b?(im=hm.end,fm.Sa=true):im=hm.start;pc(fm.j,fm.f,"seeking",fm.Cb.bind(fm));fm.f.currentTime!=im&&(fm.f.currentTime=im,fm.A=im);wl(fm,hm.start,hm.end);var jm=[],km;for(km in fm.b){hm=fm.b[km];dd(fm,function(mm){jm.push(mm.lb(this.U).then(dd(this,function(nm){var om=mm.Aa();om>this.xa&&(this.xa=om);return nm;})));})(hm);pc(fm.j,hm,"ended",fm.Db.bind(fm));im=gm[km];xj(fm.G,im);var lm=fm.l.getInitialSwitchReason()||void 0;hm.qa(im,false,void 0,lm);}Promise.all(jm).then(fm.rb.bind(fm)).catch(dd(fm,function(mm){"destroy"!=mm.type&&(mm=yb(mm),this.dispatchEvent(mm));}));jl(fm,fm.ea);}j.rb=function(fm){n(fm&&fm.length==Object.keys(this.b).length);for(var gm=Number.POSITIVE_INFINITY,hm=Number.NEGATIVE_INFINITY,im=0;im<fm.length;++im)var jm=fm[im],gm=Math.min(gm,jm),hm=Math.max(hm,jm);fm=zl(this);for(im=0;im<fm.length;++im)fm[im].ia(hm);ul(this,fm,hm);im=lc(this.c).map(function(km){return km.o;}).reduce(function(km,lm){return km.concat(lm);},[]).map(function(km){var lm=[km.J.create()];km.K&&lm.push(km.K.create());return Promise.all(lm);});Promise.all(im).then(dd(this,function(km){for(var lm=0;lm<km.length;++lm)km[lm][0].ia(hm);this.Oa=true;for(var mm in this.m)km=this.m[mm],lm=this.b[mm],xj(this.G,km.Ka),lm.qa(km.Ka,km.Ta,km.Ua,km.switchReason);this.m={};})).catch(dd(this,function(km){"aborted"!=km.type&&(km=yb(km),this.dispatchEvent(km));}));};function ul(fm,gm,hm){if(gm=bm(fm,gm))vl(fm,gm),wl(fm,gm.start,gm.end);0!=hm&&(hm=fm.f.currentTime+hm,fm.f.currentTime=hm,fm.A=hm);fm.Sa&&gm&&(fm.f.currentTime=gm.end);fm.f.playbackRate=fm.Wa;fm.a.b&&null!=fm.a.f&&gl(fm,0);cm(fm);fm.U.resolve();}function vl(fm,gm){if(fm.a.b){isNaN(fm.h.duration)&&(fm.h.duration=gm.end+2592000);}else if(isNaN(fm.h.duration)||gm.end>fm.h.duration){fm.h.duration=gm.end;for(var hm=0;hm<fm.h.sourceBuffers.length;++hm)fm.h.sourceBuffers[hm].appendWindowEnd=gm.end;}}j.Eb=function(){this.M=null;cm(this);var fm=bm(this,zl(this));fm&&(this.a.b&&this.la!=fm.w&&(this.la=fm.w,null!=this.s&&(i.clearTimeout(this.s),this.s=null)),wl(this,fm.start,fm.end),this.f.paused||xl(this,this.f.currentTime,fm.start,fm.end));};function wl(fm,gm,hm){gm=xb({type:"seekrangechanged",bubbles:true,start:gm,end:hm});fm.dispatchEvent(gm);}j.Cb=function(){var fm=this.f.currentTime;if(null!=this.A){if(fm>=this.A-.01&&fm<=this.A+.01){this.A=null;return;}this.A=null;}var gm=bm(this,zl(this));if(gm){var hm=gm.end;(gm=xl(this,fm,gm.start,hm))||(fm<=hm+.01?gm=false:(this.f.currentTime=hm,gm=true));if(!gm)for(var im in this.b)this.b[im].ib();}};function xl(fm,gm,hm,im){if(gm>=hm-.01)return false;gm=0;if(fm.a.b){gm=.5;for(var jm in fm.b)if(!fm.b[jm].jb(hm+gm)){gm=fm.a.c;break;}}fm.f.currentTime=Math.min(hm+gm,im);return true;}j.Db=function(){if(!this.a.b){for(var fm in this.b)if(!this.b[fm].Ea())return;this.sa();}};function yl(fm){return fm.a.i&&fm.f.currentTime+.5>fm.la?true:false;}j.tb=function(){this.ca=true;if(yl(this))return this.sa();ec(this.b).every(function(fm){return fm.Ea();})&&(this.s=i.setTimeout(this.sa.bind(this),1000*this.Va));};j.sb=function(){this.ca=false;null!=this.s&&(i.clearTimeout(this.s),this.s=null);};j.Ob=function(){var fm=this.G,gm=this.da.getBandwidth();fm.estimatedBandwidth=gm;fm.bandwidthHistory.push(new zj(gm));};j.sa=function(){this.ca=false;this.s=null;this.h.endOfStream();};function zl(fm){return ec(fm.b).map(function(gm){return gm.Ca();}).filter(function(gm){return null!=gm;});}function am(fm){return Math.max(fm.a?fm.a.c:1,fm.Qa?fm.g.streamBufferSize||0:0);}function bm(fm,gm){for(var hm=0,im=Number.POSITIVE_INFINITY,jm=Number.POSITIVE_INFINITY,km=0;km<gm.length;++km){var lm=gm[km].Ba(),hm=Math.max(hm,lm.start);null!=lm.end&&(im=Math.min(im,lm.end));gm[km].length()&&(jm=Math.min(jm,gm[km].w().a));}if(im==Number.POSITIVE_INFINITY)if(im=fm.a.a[0],im.b){im=(im.start||0)+im.b;}else return null;fm.a.b&&(km=am(fm),im=Math.max(im-km,hm));if(hm>im)return null;im=Math.floor(100000*im)/100000;return {start:hm,end:im,w:jm};}function cm(fm){fm.a.b&&(fm.M=i.setTimeout(fm.Eb.bind(fm),1000));}function dm(fm){for(var gm in fm.b)fm.b[gm].D(fm.g);}j.Aa=function(){return this.xa;};cl.prototype.getLongestInitResponseTime=cl.prototype.Aa;function em(fm,gm,hm,im){hm||(hm=new uc());im||(im=new al());cl.call(this,null,hm,im);"string"===typeof fm?this.mb=fm:this.Ya=fm;this.T=null;this.aa=gm;this.ka=[];this.Pa=[];this.Na=[];this.F=null;}m(em,cl);l("shaka.player.DashVideoSource",em);em.prototype.pb=function(fm,gm,hm){this.ka.push(fm);this.Pa.push(gm||"");this.Na.push(hm||"");};em.prototype.addExternalCaptions=em.prototype.pb;em.prototype.qb=function(fm){this.F=fm;};em.prototype.setNetworkCallback=em.prototype.qb;em.prototype.destroy=function(){this.T=this.F=this.aa=null;cl.prototype.destroy.call(this);};em.prototype.Ja=function(){var fm=dd(this,function(im){this.T=im;for(var jm=0;jm<this.ka.length;jm++){var km=im,lm=this.ka[jm],mm=this.Pa[jm],nm=this.Na[jm];if(0!==km.a.length){var om=new rf();om.contentType="text";om.lang=mm||"en";om.c=true;mm=new uf();mm.bandwidth=0;mm.f=nm||"text/vtt";mm.u=[new ze(lm)];om.a.push(mm);km.a[0].b.push(om);ig(km.a[0]);}}this.a=lj(new kj(this.aa),im,this.F);return cl.prototype.Ja.call(this);});if(this.Ya)return fm(this.Ya);var gm=[new ze(this.mb)],hm;this.na&&(hm=Math.floor(am(this))+1,hm=Math.min(hm,this.ma),hm=new oh(hm),hm.a=Math.floor(am(this)+1));gm=new jh(this.F,gm);return qh(new ph(gm,this.wa,hm)).then(fm);};em.prototype.fb=function(fm,gm,hm){var im;gm&&void 0!=hm&&(im=new oh(gm),im.b=hm);return qh(new ph(fm,this.wa,im)).then(dd(this,function(jm){this.T=jm;jm=lj(new kj(this.aa),jm,this.F);return Promise.resolve(jm);}));};em.prototype.eb=function(){var fm=lj(new kj(this.aa),this.T,this.F);return Promise.resolve(fm);};}.bind(h,b))();f.exports=h.shaka;},null);
__d('CustomAbrManager',['EventListener','SubscriptionsHandler','Shaka','VideoPlayerStreamSwitchReasons','VideoQualityClasses','VideoPlayerShakaExperiments'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('Shaka').player.VideoTrack;function i(j){'use strict';this.$CustomAbrManager1=null;this.$CustomAbrManager2=null;this.$CustomAbrManager3=new (c('SubscriptionsHandler'))();this.$CustomAbrManager4=Number.POSITIVE_INFINITY;this.$CustomAbrManager5=true;this.$CustomAbrManager6=false;this.$CustomAbrManager7=j.maxWidth;this.$CustomAbrManager8=j.maxHeight;this.$CustomAbrManager9=j.minPlayQuality;this.$CustomAbrManager10=j.maxPlayQuality;this.$CustomAbrManager11=j.initiallyForcedRepresentations;this.$CustomAbrManager12=null;this.$CustomAbrManager13=null;this.$CustomAbrManager14=null;}i.prototype.destroy=function(){'use strict';this.$CustomAbrManager3.release();this.$CustomAbrManager3.engage();this.$CustomAbrManager1=null;this.$CustomAbrManager2=null;this.$CustomAbrManager5=false;};i.prototype.setResolutionConstraint=function(j,k){'use strict';this.$CustomAbrManager7=j;this.$CustomAbrManager8=k;this.$CustomAbrManager15();};i.prototype.initialize=function(j,k){'use strict';if(this.$CustomAbrManager1||this.$CustomAbrManager2)return;this.$CustomAbrManager1=j;this.$CustomAbrManager2=k;};i.prototype.start=function(){'use strict';if(!this.$CustomAbrManager1||!this.$CustomAbrManager2||this.$CustomAbrManager6)return;this.$CustomAbrManager4=Date.now()+i.FIRST_SWITCH_INTERVAL;this.$CustomAbrManager3.addSubscriptions(c('EventListener').listen(this.$CustomAbrManager1,'bandwidth',this.$CustomAbrManager16.bind(this)),c('EventListener').listen(this.$CustomAbrManager2,'adaptation',this.$CustomAbrManager17.bind(this)),c('EventListener').listen(this.$CustomAbrManager2,'trackschanged',this.$CustomAbrManager18.bind(this)));this.$CustomAbrManager6=true;};i.prototype.$CustomAbrManager18=function(){'use strict';this.$CustomAbrManager15();};i.prototype.setPreferredVideoTrack=function(j){'use strict';var k=i.$CustomAbrManager19(this.$CustomAbrManager2.getVideoTracks()),l=k?h.compare(k,j)<0:false;this.$CustomAbrManager12=j;this.$CustomAbrManager15(null,l);};i.prototype.unsetPreferredVideoTrack=function(){'use strict';this.$CustomAbrManager12=null;this.$CustomAbrManager15(null,false);};i.prototype.enable=function(j){'use strict';this.$CustomAbrManager5=j;};i.prototype.getInitialVideoTrackId=function(){'use strict';if(!this.$CustomAbrManager1||!this.$CustomAbrManager2)return null;var j=this.$CustomAbrManager20();return j?j.id:null;};i.prototype.getInitialSwitchReason=function(){'use strict';return this.$CustomAbrManager14;};i.prototype.getInitialAudioTrackId=function(){'use strict';if(!this.$CustomAbrManager1||!this.$CustomAbrManager2)return null;var j=this.$CustomAbrManager21();return j?j.id:null;};i.prototype.selectVideoTrack=function(j,k,l,m){'use strict';if(!this.$CustomAbrManager6)return;this.$CustomAbrManager2.selectVideoTrack(j.id,k,l,m);};i.$CustomAbrManager19=function(j){'use strict';for(var k=0;k<j.length;++k)if(j[k].active)return j[k];return null;};i.prototype.$CustomAbrManager16=function(event){'use strict';if(Date.now()<this.$CustomAbrManager4)return;this.$CustomAbrManager15(event);};i.prototype.$CustomAbrManager15=function(event,j){'use strict';if(!this.$CustomAbrManager5)return;var k=this.$CustomAbrManager20();if(k){if(k.active){this.$CustomAbrManager4=Date.now()+i.MIN_EVAL_INTERVAL;return;}this.selectVideoTrack(k,!!j,0,this.$CustomAbrManager13);}this.$CustomAbrManager4=Number.POSITIVE_INFINITY;};i.prototype.$CustomAbrManager17=function(event){'use strict';if(this.$CustomAbrManager4==Number.POSITIVE_INFINITY)this.$CustomAbrManager4=Date.now()+i.MIN_SWITCH_INTERVAL;};i.prototype.$CustomAbrManager20=function(){var j,k=this;'use strict';var l=this.$CustomAbrManager2.getVideoTracks();if(l.length==0)return null;if(!this.$CustomAbrManager6)for(var m=0;m<l.length;m++)if(this.$CustomAbrManager11&&this.$CustomAbrManager11.includes(l[m].streamInfoID)){this.$CustomAbrManager13=c('VideoPlayerStreamSwitchReasons').FORCED;this.$CustomAbrManager14=c('VideoPlayerStreamSwitchReasons').FORCED;return l[m];}if(this.$CustomAbrManager12){var n=l.find(function(y){return y.id===this.$CustomAbrManager12.id;}.bind(this));if(n){this.$CustomAbrManager13=c('VideoPlayerStreamSwitchReasons').USER;return n;}}l.sort(h.compare);if(this.$CustomAbrManager9!==null||this.$CustomAbrManager10!==null){var j=function(){var y=k.$CustomAbrManager9!==null?c('VideoQualityClasses').indexOf(k.$CustomAbrManager9):0,z=k.$CustomAbrManager10!==null?c('VideoQualityClasses').indexOf(k.$CustomAbrManager10):c('VideoQualityClasses').length-1;if(y<=z){var aa=l.filter(function(ca){return c('VideoQualityClasses').indexOf(ca.fbQualityClass)>=y&&c('VideoQualityClasses').indexOf(ca.fbQualityClass)<=z;});k.$CustomAbrManager13=c('VideoPlayerStreamSwitchReasons').PREFER_QUALITY_CLASS;if(!aa.length)return {v:l[l.length-1]};var ba=c('VideoQualityClasses').indexOf('sd');if(l.length==2&&aa.length==2&&z<=ba)return {v:l[0]};l=aa;}}();if(typeof j==="object")return j.v;}var o=l[0],p=this.$CustomAbrManager8,q=this.$CustomAbrManager7;l=l.filter(function(y){return y.width<=q||y.height<=p;});var r=i.$CustomAbrManager19(this.$CustomAbrManager2.getAudioTracks()),s=r?r.bandwidth:0,t=this.$CustomAbrManager1.getBandwidth();for(var m=0;m<l.length;m++){var u=l[m],v=m+1<l.length?l[m+1]:{bandwidth:Number.POSITIVE_INFINITY};if(!u.bandwidth)continue;var w=(u.bandwidth+s)/i.BANDWIDTH_DOWNGRADE_TARGET,x=(v.bandwidth+s)/i.BANDWIDTH_UPGRADE_TARGET;if(t>=w&&t<=x){o=u;if(o.active)break;}}this.$CustomAbrManager13=c('VideoPlayerStreamSwitchReasons').BANDWIDTH;return o;};i.prototype.$CustomAbrManager21=function(){'use strict';var j=this.$CustomAbrManager2.getAudioTracks();if(j.length==0)return null;if(!this.$CustomAbrManager6)for(var k=0;k<j.length;k++)if(this.$CustomAbrManager11&&this.$CustomAbrManager11.includes(j[k].streamInfoID))return j[k];return null;};i.FIRST_SWITCH_INTERVAL=c('VideoPlayerShakaExperiments').firstSwitchInterval;i.MIN_SWITCH_INTERVAL=c('VideoPlayerShakaExperiments').minSwitchInterval;i.MIN_EVAL_INTERVAL=c('VideoPlayerShakaExperiments').minEvalInterval;i.BANDWIDTH_UPGRADE_TARGET=c('VideoPlayerShakaExperiments').bandwidthUpgradeTarget||.85;i.BANDWIDTH_DOWNGRADE_TARGET=c('VideoPlayerShakaExperiments').bandwidthDowngradeTarget||.95;f.exports=i;},null);
__d('VideoPlayerLiveStreamState',['RTISubscriptionManager','EventEmitter'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('EventEmitter'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$VideoPlayerLiveStreamState1=c('RTISubscriptionManager').subscribe('video_broadcast/interrupt_'+k,this.$VideoPlayerLiveStreamState3.bind(this));this.$VideoPlayerLiveStreamState2=c('RTISubscriptionManager').subscribe('video_broadcast/ended_'+k,this.$VideoPlayerLiveStreamState4.bind(this));}j.prototype.unsubscribe=function(){'use strict';this.$VideoPlayerLiveStreamState2.unsubscribe();this.$VideoPlayerLiveStreamState1.unsubscribe();};j.prototype.$VideoPlayerLiveStreamState3=function(k){'use strict';var l=JSON.parse(k.payload||'{}')||{},m=l.time_position;if(m)m/=1000;this.emit('streamInterruptAt',m);};j.prototype.$VideoPlayerLiveStreamState4=function(k){'use strict';var l=JSON.parse(k.payload||'{}')||{},m=l.time_position;if(m)m/=1000;this.emit('streamEndedAt',m);};f.exports=j;},null);
__d('VideoPlayerHTML5Shaka',['invariant','Promise','BlobFactory','CacheStorage','CustomAbrManager','EventEmitter','EventListener','Event','Run','TaggedTimeRanges','VideoDashPrefetchCache','VideoPlayerLiveStreamState','VideoPlayerShakaExperiments','VideoQualityClasses','dispatchEvent','Shaka'],function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('Shaka').player,l=k.Player,m=k.DashVideoSource,n=k.VideoTrack,o=c('Shaka').dash.mpd.parseMpd,p=c('Shaka').util,q=p.EWMACacheBandwidthEstimator,r=p.EWMASignedURLBandwidthEstimator,s=p.FailoverUri,t=window.devicePixelRatio||1,u=new (c('CacheStorage'))('localstorage','_video_'),v=c('VideoPlayerShakaExperiments').enableAdaptation?new q(c('VideoPlayerShakaExperiments').cacheDelay,c('VideoPlayerShakaExperiments').cacheBandwidth,c('VideoPlayerShakaExperiments').useStoredBandwidthEstimate?u.get('bandwidthEstimate'):undefined):new r();s.setPrefetchCacheValueGetter(c('VideoDashPrefetchCache').getCacheValue);c('Run').onUnload(function(){return u.set('bandwidthEstimate',v.getBandwidth());});c('Shaka').polyfill.Fullscreen.install();function w(ca){var da=ca.getVideoTracks();da.sort(n.compare);var ea=da.reduce(function(fa,ga){return ga.fbQualityLabel=='hd'?ga:fa;});if(!ea)return da.pop().id;return ea.id;}function x(ca){var da=ca.getVideoTracks();da.sort(n.compare);return da.shift().id;}function y(ca){var da=c('BlobFactory').getBlob([ca]);return URL.createObjectURL(da);}function z(ca,event){var da=c('EventListener').capture(ca.parentNode,event,function(ea){if(ea.target!=ca)return;da.remove();c('Event').kill(ea);});}function aa(ca,da){'use strict';this.$DisabledAbrManager1=ca;this.$DisabledAbrManager2=da;}aa.prototype.initialize=function(ca,da){'use strict';this.$DisabledAbrManager3=da;};aa.prototype.start=function(){'use strict';if(this.$DisabledAbrManager4)return;this.$DisabledAbrManager4=true;if(this.$DisabledAbrManager2&&this.$DisabledAbrManager1)this.$DisabledAbrManager3.selectVideoTrack(w(this.$DisabledAbrManager3),false);};aa.prototype.enable=function(){'use strict';};aa.prototype.getInitialVideoTrackId=function(){'use strict';if(this.$DisabledAbrManager2)return x(this.$DisabledAbrManager3);var ca=this.$DisabledAbrManager1?w(this.$DisabledAbrManager3):x(this.$DisabledAbrManager3);return ca;};aa.prototype.setPreferredVideoTrack=function(ca){'use strict';if(this.$DisabledAbrManager4)this.$DisabledAbrManager3.selectVideoTrack(ca.id,true);};aa.prototype.unsetPreferredVideoTrack=function(){'use strict';};aa.prototype.destroy=function(){'use strict';this.$DisabledAbrManager3=null;};i=babelHelpers.inherits(ba,c('EventEmitter'));j=i&&i.prototype;function ba(ca,da,ea){var fa,ga=this,ha=ea.videoID,ia=ea.width,ja=ea.height,ka=ea.manifest,la=ea.manifestUrl,ma=ea.isLive,na=ea.minPlayQuality,oa=ea.maxPlayQuality;'use strict';j.constructor.call(this);this.$VideoPlayerHTML5Shaka1=na;this.$VideoPlayerHTML5Shaka2=oa;this.$VideoPlayerHTML5Shaka3=false;this.$VideoPlayerHTML5Shaka4=false;this.$VideoPlayerHTML5Shaka5=null;this.$VideoPlayerHTML5Shaka6=1;this.$VideoPlayerHTML5Shaka7=false;this.$VideoPlayerHTML5Shaka8=ia;this.$VideoPlayerHTML5Shaka9=ja;if(!c('VideoPlayerShakaExperiments').improveRebufferLogging)(function(){ga.$VideoPlayerHTML5Shaka10=true;var qa=c('EventListener').listen(ca,'playing',function(){this.$VideoPlayerHTML5Shaka10=false;qa.remove();}.bind(ga));})();c('EventListener').listen(ca,'timeupdate',function(qa){this.$VideoPlayerHTML5Shaka11(qa.target.currentTime);}.bind(this));this.$VideoPlayerHTML5Shaka12=null;this.$VideoPlayerHTML5Shaka13=null;this.$VideoPlayerHTML5Shaka14=null;this.$VideoPlayerHTML5Shaka15=new l(ca);this.$VideoPlayerHTML5Shaka15.addEventListener('bufferingStart',function(){return this.$VideoPlayerHTML5Shaka16();}.bind(this));this.$VideoPlayerHTML5Shaka15.addEventListener('bufferingEnd',function(){return this.$VideoPlayerHTML5Shaka17();}.bind(this));this.$VideoPlayerHTML5Shaka15.addEventListener('error',function(qa){return this.$VideoPlayerHTML5Shaka18(qa);}.bind(this));this.$VideoPlayerHTML5Shaka15.addEventListener('adaptation',this.$VideoPlayerHTML5Shaka19.bind(this));this.$VideoPlayerHTML5Shaka15.addEventListener('trackschanged',this.$VideoPlayerHTML5Shaka20.bind(this));this.$VideoPlayerHTML5Shaka15.addEventListener('manifestwrapped',this.$VideoPlayerHTML5Shaka21.bind(this));if(c('VideoPlayerShakaExperiments').enableLiveInterruptionDetection)this.$VideoPlayerHTML5Shaka15.addEventListener('manifestIsUpdating',this.$VideoPlayerHTML5Shaka22.bind(this));this.$VideoPlayerHTML5Shaka23=da;this.$VideoPlayerHTML5Shaka24=null;var pa=false;if(ka){this.$VideoPlayerHTML5Shaka25=o(ka);}else{this.$VideoPlayerHTML5Shaka25=la;pa=la.indexOf('/dash-abr/')!==-1;}this.$VideoPlayerHTML5Shaka26=this.$VideoPlayerHTML5Shaka27();this.$VideoPlayerHTML5Shaka28=this.$VideoPlayerHTML5Shaka29();this.$VideoPlayerHTML5Shaka30=new (c('TaggedTimeRanges'))(function(qa,ra){return (qa.id===ra.id&&qa.reason===ra.reason);});this.$VideoPlayerHTML5Shaka28.setTaggedTimeRangesEntryAdder(function(qa,ra,sa){this.$VideoPlayerHTML5Shaka30.add(qa,ra,sa);}.bind(this));this.$VideoPlayerHTML5Shaka31=ca;this.$VideoPlayerHTML5Shaka15.configure({enableAdaptation:c('VideoPlayerShakaExperiments').enableAdaptation,appendPlayingQueryParam:c('VideoPlayerShakaExperiments').addCdnDebugQueryParameters,endBufferingOnPlaying:c('VideoPlayerShakaExperiments').endBufferingOnPlaying,usePlaybackRateForBuffering:c('VideoPlayerShakaExperiments').improveRebufferLogging,streamBufferSize:ma?c('VideoPlayerShakaExperiments').liveStreamBufferSize:c('VideoPlayerShakaExperiments').streamBufferSize,initialStreamBufferSize:ma?c('VideoPlayerShakaExperiments').liveInitialStreamBufferSize:c('VideoPlayerShakaExperiments').initialStreamBufferSize,includeStreamBufferSizeInStartOffset:c('VideoPlayerShakaExperiments').includeStreamBufferSizeInStartOffset,minMpdRefreshInterval:c('VideoPlayerShakaExperiments').minMpdRefreshInterval,disableCacheBustingEvenThoughItMayAffectBandwidthEstimation:true,liveStreamEndTimeout:c('VideoPlayerShakaExperiments').liveStreamEndTimeout/1000,enableLiveInterruptionDetection:c('VideoPlayerShakaExperiments').enableLiveInterruptionDetection,liveInterruptionConsecutiveUpdatesWithoutChange:c('VideoPlayerShakaExperiments').liveInterruptionConsecutiveUpdatesWithoutChange,liveInterruptionConsecutiveUpdatesWithChange:c('VideoPlayerShakaExperiments').liveInterruptionConsecutiveUpdatesWithChange,liveMaxSegmentsToPush:c('VideoPlayerShakaExperiments').liveMaxSegmentsToPush,liveSendPushHeaders:c('VideoPlayerShakaExperiments').liveSendPushHeaders&&!pa,resolveVideoTimeUpdateOnFragmentedTimeRanges:c('VideoPlayerShakaExperiments').resolveVideoTimeUpdateOnFragmentedTimeRanges});if(ma&&c('VideoPlayerShakaExperiments').enableLiveInterruptionDetection){this.$VideoPlayerHTML5Shaka32=new (c('VideoPlayerLiveStreamState'))(ha);this.$VideoPlayerHTML5Shaka32.addListener('streamInterruptAt',this.$VideoPlayerHTML5Shaka33.bind(this));}this.$VideoPlayerHTML5Shaka15.load(this.$VideoPlayerHTML5Shaka28);}ba.prototype.getEstimatedBandwidth=function(){'use strict';return v.getBandwidth();};ba.prototype.$VideoPlayerHTML5Shaka11=function(ca){'use strict';var da=this.$VideoPlayerHTML5Shaka30.get(ca);if(!da)return;var ea=da.id,fa=da.reason;if(this.$VideoPlayerHTML5Shaka24!==ea){var ga=this.$VideoPlayerHTML5Shaka24;this.$VideoPlayerHTML5Shaka24=ea;this.emit('representation_ended',{representationID:ga,nextRepresentationID:ea,streamSwitchReason:fa});}};ba.prototype.getStreamInfoIDForTimePosition=function(ca){'use strict';var da=this.$VideoPlayerHTML5Shaka30.get(ca),ea=null;if(da)ea=da.id;return ea;};ba.prototype.$VideoPlayerHTML5Shaka34=function(ca,da){'use strict';if(ca.fbQualityLabel){return ca.fbQualityLabel;}else if(n.compare(ca,da[0])==0){return 'SD';}else if(n.compare(ca,da[da.length-1])==0){return 'HD';}else return null;};ba.prototype.getAvailableVideoQualities=function(){'use strict';if(this.$VideoPlayerHTML5Shaka3)return this.$VideoPlayerHTML5Shaka12;var ca=this.$VideoPlayerHTML5Shaka28.getVideoTracks();ca.sort(n.compare);return ca.every(function(da){return da.fbQualityLabel!==null;})?ca.map(function(da){return da.fbQualityLabel;}):ca.length>1?['SD','HD']:['SD'];};ba.prototype.getSelectedVideoQuality=function(){'use strict';if(this.$VideoPlayerHTML5Shaka3)return this.$VideoPlayerHTML5Shaka13;var ca=this.$VideoPlayerHTML5Shaka28.getVideoTracks();ca.sort(n.compare);var da=ca.find(function(ea){return ea.active;});return da?this.$VideoPlayerHTML5Shaka34(da,ca):null;};ba.prototype.canAutoSelectVideoQuality=function(){'use strict';return c('VideoPlayerShakaExperiments').enableAdaptation;};ba.prototype.setPreferredVideoQuality=function(ca){'use strict';var da=this.$VideoPlayerHTML5Shaka28.getVideoTracks();da.sort(n.compare);var ea=da.find(function(fa){return ca==this.$VideoPlayerHTML5Shaka34(fa,da);}.bind(this));if(ea){this.$VideoPlayerHTML5Shaka14=ca;this.$VideoPlayerHTML5Shaka26.setPreferredVideoTrack(ea);}};ba.prototype.unsetPreferredVideoQuality=function(){'use strict';this.$VideoPlayerHTML5Shaka14=null;this.$VideoPlayerHTML5Shaka26.unsetPreferredVideoTrack();};ba.prototype.pause=function(){'use strict';if(this.$VideoPlayerHTML5Shaka35&&!c('VideoPlayerShakaExperiments').improveRebufferLogging){this.$VideoPlayerHTML5Shaka36=true;this.$VideoPlayerHTML5Shaka37=true;c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'pause');this.$VideoPlayerHTML5Shaka15.setResumeAfterBuffering(false);}else this.$VideoPlayerHTML5Shaka31.pause();};ba.prototype.play=function(){'use strict';if(this.$VideoPlayerHTML5Shaka35&&!c('VideoPlayerShakaExperiments').improveRebufferLogging){this.$VideoPlayerHTML5Shaka36=false;this.$VideoPlayerHTML5Shaka37=true;c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'play');c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'waiting');this.$VideoPlayerHTML5Shaka15.setResumeAfterBuffering(true);return c('Promise').resolve();}else return this.$VideoPlayerHTML5Shaka31.play();};ba.prototype.$VideoPlayerHTML5Shaka38=function(){'use strict';var ca=this.$VideoPlayerHTML5Shaka5;if(ca){var da=this.$VideoPlayerHTML5Shaka31.currentTime,ea=4,fa=da>ca-ea,ga=da>ca;if(ga){this.$VideoPlayerHTML5Shaka5=null;}else if(this.$VideoPlayerHTML5Shaka35)this.$VideoPlayerHTML5Shaka7=fa;}return this.$VideoPlayerHTML5Shaka7;};ba.prototype.$VideoPlayerHTML5Shaka16=function(){'use strict';if(!c('VideoPlayerShakaExperiments').improveRebufferLogging){z(this.$VideoPlayerHTML5Shaka31,'pause');this.$VideoPlayerHTML5Shaka36=false;this.$VideoPlayerHTML5Shaka37=false;}this.$VideoPlayerHTML5Shaka35=true;if(this.$VideoPlayerHTML5Shaka38()){this.emit('streamInterrupted');}else{this.$VideoPlayerHTML5Shaka15.setResumeAfterBuffering(true);this.emit('bufferingStart');}};ba.prototype.$VideoPlayerHTML5Shaka17=function(){var ca,da=this;'use strict';if(!c('VideoPlayerShakaExperiments').improveRebufferLogging){if(!this.$VideoPlayerHTML5Shaka36)z(this.$VideoPlayerHTML5Shaka31,'play');if(!this.$VideoPlayerHTML5Shaka37)(function(){var ea=c('EventListener').capture(da.$VideoPlayerHTML5Shaka31.parentNode,'playing',function(fa){if(fa.target!=this.$VideoPlayerHTML5Shaka31)return;ea.remove();if(this.$VideoPlayerHTML5Shaka10){this.$VideoPlayerHTML5Shaka10=false;return;}c('Event').kill(fa);}.bind(da));})();}this.$VideoPlayerHTML5Shaka35=false;this.$VideoPlayerHTML5Shaka28.setIsLiveInterrupted(false);if(this.$VideoPlayerHTML5Shaka7){this.$VideoPlayerHTML5Shaka39();}else this.emit('bufferingEnd');};ba.prototype.$VideoPlayerHTML5Shaka18=function(ca){'use strict';var da=ca.detail||{},ea=da.type||'undefined';if(this.$VideoPlayerHTML5Shaka4&&this.$VideoPlayerHTML5Shaka3&&ea=='net')return;this.emit('error',{error:'SHAKA_'+ea.toUpperCase(),message:da.message,httpStatus:da.status||null,url:da.url||null});};ba.prototype.hasSelectableVideoTracks=function(){'use strict';var ca=this.$VideoPlayerHTML5Shaka15.getVideoTracks();return ca.length>1;};ba.prototype.unload=function(){'use strict';this.$VideoPlayerHTML5Shaka13=this.getSelectedVideoQuality();this.$VideoPlayerHTML5Shaka12=this.getAvailableVideoQualities();this.$VideoPlayerHTML5Shaka4=this.$VideoPlayerHTML5Shaka28&&this.$VideoPlayerHTML5Shaka28.isLive();this.$VideoPlayerHTML5Shaka15.unload();this.$VideoPlayerHTML5Shaka3=true;};ba.prototype.$VideoPlayerHTML5Shaka27=function(){'use strict';var ca={minPlayQuality:this.$VideoPlayerHTML5Shaka1,maxPlayQuality:this.$VideoPlayerHTML5Shaka2,maxWidth:this.$VideoPlayerHTML5Shaka40(),maxHeight:this.$VideoPlayerHTML5Shaka41(),initiallyForcedRepresentations:this.$VideoPlayerHTML5Shaka23},da=c('VideoQualityClasses').indexOf('hd'),ea=this.$VideoPlayerHTML5Shaka1!=null&&c('VideoQualityClasses').indexOf(this.$VideoPlayerHTML5Shaka1)>=da;return c('VideoPlayerShakaExperiments').enableAdaptation?new (c('CustomAbrManager'))(ca):new aa(ea,c('VideoPlayerShakaExperiments').switchFromLowQuality);};ba.prototype.$VideoPlayerHTML5Shaka29=function(){'use strict';!this.$VideoPlayerHTML5Shaka26?h(0):void 0;!this.$VideoPlayerHTML5Shaka25?h(0):void 0;var ca=new m(this.$VideoPlayerHTML5Shaka25,null,v,this.$VideoPlayerHTML5Shaka26);return ca;};ba.prototype.reload=function(ca){'use strict';if(!this.$VideoPlayerHTML5Shaka3)return;this.$VideoPlayerHTML5Shaka26=this.$VideoPlayerHTML5Shaka27();this.$VideoPlayerHTML5Shaka28=this.$VideoPlayerHTML5Shaka29();if(this.$VideoPlayerHTML5Shaka38()){this.$VideoPlayerHTML5Shaka31.playbackRate=0;this.emit('streamInterrupted');}this.$VideoPlayerHTML5Shaka15.setPlaybackStartTime(ca);return this.$VideoPlayerHTML5Shaka15.loadWithSilencedErrors(this.$VideoPlayerHTML5Shaka28).then(function(){if(this.$VideoPlayerHTML5Shaka4!=this.$VideoPlayerHTML5Shaka28.isLive())return this.$VideoPlayerHTML5Shaka42();if(this.$VideoPlayerHTML5Shaka14)this.setPreferredVideoQuality(this.$VideoPlayerHTML5Shaka14);this.$VideoPlayerHTML5Shaka13=null;this.$VideoPlayerHTML5Shaka43=null;this.$VideoPlayerHTML5Shaka3=false;}.bind(this))['catch'](function(da){if(this.$VideoPlayerHTML5Shaka4)return this.$VideoPlayerHTML5Shaka42();da.detail=da.detail||{};da.detail.type=da.detail.type||'LOAD_FAILURE';this.$VideoPlayerHTML5Shaka18(da);}.bind(this));};ba.prototype.$VideoPlayerHTML5Shaka42=function(){'use strict';c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'seeked');c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'playing');c('dispatchEvent')(this.$VideoPlayerHTML5Shaka31,'ended');this.emit('streamResumed');this.$VideoPlayerHTML5Shaka32.unsubscribe();this.unload();};ba.prototype.getLongestInitResponseTime=function(){'use strict';return this.$VideoPlayerHTML5Shaka28.getLongestInitResponseTime();};ba.$VideoPlayerHTML5Shaka44=function(){'use strict';return (c('VideoPlayerShakaExperiments').resolutionConstraintFactor*t);};ba.prototype.$VideoPlayerHTML5Shaka40=function(){'use strict';if(!c('VideoPlayerShakaExperiments').useResolutionConstraints)return Infinity;return this.$VideoPlayerHTML5Shaka8*ba.$VideoPlayerHTML5Shaka44();};ba.prototype.$VideoPlayerHTML5Shaka41=function(){'use strict';if(!c('VideoPlayerShakaExperiments').useResolutionConstraints)return Infinity;return this.$VideoPlayerHTML5Shaka9*ba.$VideoPlayerHTML5Shaka44();};ba.prototype.setDimensions=function(ca,da){'use strict';this.$VideoPlayerHTML5Shaka8=ca;this.$VideoPlayerHTML5Shaka9=da;this.$VideoPlayerHTML5Shaka26.setResolutionConstraint(this.$VideoPlayerHTML5Shaka40(),this.$VideoPlayerHTML5Shaka41());};ba.isSupported=function(){'use strict';return l.isBrowserSupported();};ba.prototype.$VideoPlayerHTML5Shaka20=function(){'use strict';this.emit('tracksChanged');};ba.prototype.$VideoPlayerHTML5Shaka19=function(event){'use strict';if(event.contentType==='video')this.emit('adaptation',{reason:event.reason});};ba.prototype.$VideoPlayerHTML5Shaka33=function(ca){'use strict';this.$VideoPlayerHTML5Shaka28.setIsLiveInterrupted(true);this.$VideoPlayerHTML5Shaka5=ca;};ba.prototype.$VideoPlayerHTML5Shaka22=function(){'use strict';if(this.$VideoPlayerHTML5Shaka38())this.$VideoPlayerHTML5Shaka39();};ba.prototype.$VideoPlayerHTML5Shaka39=function(){'use strict';this.$VideoPlayerHTML5Shaka5=null;this.$VideoPlayerHTML5Shaka7=false;this.emit('streamResumed');};ba.prototype.$VideoPlayerHTML5Shaka21=function(){'use strict';var ca=!this.$VideoPlayerHTML5Shaka31.paused;this.unload();this.reload().then(function(){if(this.$VideoPlayerHTML5Shaka7)this.$VideoPlayerHTML5Shaka39();if(ca)this.play();}.bind(this))['catch'](function(da){});};f.exports=ba;},null);