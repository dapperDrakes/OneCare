if (self.CavalryLogger) { CavalryLogger.start_js(["oOyW0"]); }

__d('UFIReactionsDialogLayerImpl.react',['cx','BrowserSupport','CSS','DataStore','DOM','Layer','Locale','Parent','React','ReactDOM','ReactTransitionEvents','RTLKeys','Style','SubscriptionsHandler','TabbableElements','Vector','ViewportBounds','ge','getElementPosition','getOverlayZIndex','memoize','renderSubtreeIntoContainer','requestAnimationFrame'],function a(b,c,d,e,f,g,h){var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n="_1oxh",o="_2r6k",p="_2r6j",q=c('BrowserSupport').hasCSSAnimations(),r="_10ir",s={};i=babelHelpers.inherits(t,c('Layer'));j=i&&i.prototype;t.prototype.updatePosition=function(){'use strict';var v=this.getInsertParent(),w=this.getCausalElement(),x=c('Vector').getElementPosition(w),y=c('Vector').getElementPosition(v),z=x.sub(y),aa=c('Vector').getElementDimensions(v).x;if(c('Locale').isRTL())z.x=aa-z.x;z.x=Math.min(z.x,c('Vector').getViewportDimensions().x-c('Vector').getElementDimensions(this.getContentRoot()).x);if(c('Locale').isRTL()){s.right=z.x+'px';}else s.left=z.x+'px';s.top=z.y+'px';s.zIndex=c('getOverlayZIndex')(w,v);c('Style').apply(this.getRoot(),s);return true;};t.prototype.getContentRoot=function(){'use strict';return this.contentRoot;};t.prototype._buildWrapper=function(v,w){'use strict';c('CSS').addClass(w,"_49v-");this.contentRoot=w;var x=document.createElement('div');c('CSS').addClass(x,"_1oxj");x.appendChild(w);return x;};function t(){'use strict';i.apply(this,arguments);}k=babelHelpers.inherits(u,c('React').Component);l=k&&k.prototype;function u(v,w){'use strict';l.constructor.call(this,v,w);this.getGlobalContainer=c('memoize')(function(){return c('ge')('globalContainer');});this.onKeyDown=this.onKeyDown.bind(this);this.onParentLayerHide=this.finishHide.bind(this);this.onTransitionHide=this.onTransitionHide.bind(this);this.onTransitionShow=this.onTransitionShow.bind(this);}u.prototype.componentDidMount=function(){'use strict';var v=c('ReactDOM').findDOMNode(this.refs.root);this.layer=new t({causalElement:v,insertParent:v},document.createElement('div'));c('DOM').appendContent(v,this.layer.getRoot());this.handler=new (c('SubscriptionsHandler'))();if(this.props.onLayerBlur)this.handler.addSubscriptions(this.layer.subscribe('blur',this.props.onLayerBlur));this.handler.addSubscriptions(this.layer.subscribe('beforeshow',this.beforeShow.bind(this)),this.layer.subscribe('aftershow',this.afterShow.bind(this)),this.layer.subscribe('starthide',this.startHide.bind(this)));if(this.isInDocument())this.renderLayer();};u.prototype.componentDidUpdate=function(v){'use strict';this.renderLayer();};u.prototype.componentWillUnmount=function(){'use strict';if(this.layer){var v=this.layer.getContentRoot();c('ReactDOM').unmountComponentAtNode(this.layer.getContentRoot());c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionHide);c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionShow);this.handler.release();this.handler=null;this.layer.destroy();this.layer=null;}};u.prototype.isInDocument=function(){'use strict';var v=c('ReactDOM').findDOMNode(this.refs.root);return v&&document.body.contains(v);};u.prototype.afterShow=function(){'use strict';var v=c('TabbableElements').find(this.layer.getContentRoot())[0];v&&v.focus();c('CSS').removeClass(this.refs.root,'accessible_elem');var w=this.layer.getContentRoot(),x=c('getElementPosition')(w).y,y=c('ViewportBounds').getTop();c('CSS').conditionClass(w,n,x&&x<y);if(q){c('ReactTransitionEvents').addEndEventListener(w,this.onTransitionShow);c('CSS').addClass(w,r);c('CSS').addClass(w,p);}};u.prototype.beforeShow=function(){'use strict';var v=this.getContextualLayerParent();if(this.props.isScreenReader){this.layer.setInsertParent(this.layer.getCausalElement());}else if(v!==this.layer.getInsertParent()){this.layer.setInsertParent(v);this.setParentLayerSubscription(v);}};u.prototype.setParentLayerSubscription=function(v){'use strict';if(v!==this.getGlobalContainer()){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayer=null;return;}var w=v,x=null;while(w!==null){x=c('DataStore').get(w,'layer');if(x)break;w=w.parentNode;}if(x&&x!==this.parentLayer){this.parentLayerSubscription&&this.parentLayerSubscription.unsubscribe();this.parentLayerSubscription=x.subscribe('hide',this.onParentLayerHide);this.parentLayer=x;}};u.prototype.startHide=function(){'use strict';if(q&&this.isInDocument()){var v=this.layer.getContentRoot();c('ReactTransitionEvents').addEndEventListener(v,this.onTransitionHide);c('CSS').addClass(v,o);}else this.finishHide();return false;};u.prototype.onTransitionHide=function(){'use strict';c('ReactTransitionEvents').removeEndEventListener(this.layer.getContentRoot(),this.onTransitionHide);this.finishHide();};u.prototype.onTransitionShow=function(){'use strict';var v=this.layer.getContentRoot();c('ReactTransitionEvents').removeEndEventListener(v,this.onTransitionShow);c('requestAnimationFrame')(function(){c('CSS').removeClass(v,p);});};u.prototype.finishHide=function(){'use strict';c('CSS').addClass(this.refs.root,'accessible_elem');var v=this.layer.getContentRoot();if(q){c('CSS').removeClass(v,n);c('CSS').removeClass(v,o);c('CSS').removeClass(v,r);}this.layer.setInsertParent(this.layer.getCausalElement());this.layer.finishHide();};u.prototype.onKeyDown=function(event){'use strict';var v=event.keyCode;if(this.props.isScreenReader)return;if(v===c('RTLKeys').ESC||v===c('RTLKeys').RETURN||v===c('RTLKeys').TAB){this.props.onLayerBlur&&this.props.onLayerBlur(event);var w=c('ReactDOM').findDOMNode(this.refs.root),x=c('TabbableElements').find(this.getContextualLayerParent()),y=null,z=[],aa=v===c('RTLKeys').TAB&&event.shiftKey;for(var ba=0;ba<x.length;ba++)if(x[ba].tabIndex>-1){if(w.compareDocumentPosition(x[ba])&4){y=x[ba];break;}if(aa)z.push(x[ba]);}if(z.length)y=z[z.length-1];if(y){y.focus();event.preventDefault();}}};u.prototype.getContextualLayerParent=function(){'use strict';return c('Parent').byClass(c('ReactDOM').findDOMNode(this.refs.root),'uiContextualLayerParent')||document.body;};u.prototype.renderLayer=function(){'use strict';c('renderSubtreeIntoContainer')(this,c('React').createElement('div',babelHelpers['extends']({},this.props,{className:"_1oxk",onKeyDown:this.onKeyDown}),this.props.children,c('React').createElement('div',{className:"_41nt"+(this.props.isDarkBackground?' '+"_3_jc":'')+(this.props.hasSquareCorner?' '+"_2lqi":''),style:{height:this.props.height}})),this.layer.getContentRoot());this.layer.conditionShow(this.props.shown);};u.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_2r6l accessible_elem",ref:'root'}));};u.propTypes={shown:m.bool,isScreenReader:m.bool};f.exports=u;},null);
__d('UFIReactionsMenuImpl.react',['cx','fbt','Event','Locale','RTLKeys','React','ReactDOM','SubscriptionsHandler','UFIConfig','UFIReactionsTheme','UFIReactionIconImpl.react','UFIReactionTypes','UFIReactionsDialogLayerImpl.react','UFIReactionsThemeStoreButton.react','addFocusEvents','getVendorPrefixedName','joinClasses','shallowCompare'],function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l=8,m=96,n=48,o=44,p=c('UFIReactionTypes').reactions,q=c('getVendorPrefixedName')('transform'),r=i._("Reactions"),s=c('addFocusEvents')('span');j=babelHelpers.inherits(t,c('React').Component);k=j&&j.prototype;function t(u,v){'use strict';k.constructor.call(this);var w=u.supportedReactions.filter(function(y){return p[y];}),x=u.allowKeyboardFocus?Math.max(0,w.indexOf(u.initialReaction)):-1;this.state={persistLayer:false,hasKeyboardFocus:u.allowKeyboardFocus,selectedIndex:x,supportedReactions:w,theme:c('UFIReactionsTheme').getThemeClassName()};c('UFIReactionsTheme').subscribe('change',function(){this.setState({theme:c('UFIReactionsTheme').getThemeClassName()});}.bind(this));this.focusSelected=this.focusSelected.bind(this);this.onDragStart=this.onDragStart.bind(this);this.onKeyDown=this.onKeyDown.bind(this);this.onThemeStoreShow=this.onThemeStoreShow.bind(this);this.onThemeStoreHide=this.onThemeStoreHide.bind(this);this.hasStaticSVGDock=c('UFIConfig').reactionsHasStaticFileVectorDock;this.hasAnimatedIconsOnHover=c('UFIConfig').reactionsHasAnimatedIconsOnHover;}t.prototype.componentWillReceiveProps=function(u){'use strict';if(!u.shown&&this.props.shown)this.setState({hasKeyboardFocus:u.allowKeyboardFocus,selectedIndex:-1});this.setState({supportedReactions:u.supportedReactions.filter(function(v){return p[v];})});};t.prototype.componentDidMount=function(){'use strict';if(this.props.allowKeyboardFocus)this.focusSelected();};t.prototype.componentDidUpdate=function(u,v){'use strict';if(this.props.allowKeyboardFocus&&!u.allowKeyboardFocus)this.focusSelected();if(this.props.isLongPressing&&!u.isLongPressing){var w,x=new (c('SubscriptionsHandler'))();x.addSubscriptions(c('Event').listen(document.documentElement,'touchmove',function(event){event.preventDefault();var y=event.touches[0],z=document.elementFromPoint(y.clientX,y.clientY);if(!z.getAttribute('data-reaction')&&z.parentElement)z=z.parentElement;var aa=parseInt(z.getAttribute('data-reaction'),10)||null;if(aa!==w){if(w)this.onReactionMouseLeave(w,event);if(aa)this.onReactionMouseEnter(aa,event);w=aa;}}.bind(this)),c('Event').listen(document.documentElement,'touchend',function(event){if(w)this.onReactionClick(w,event);if(x){x.release();x=null;}}.bind(this)));}};t.prototype.focusSelected=function(){'use strict';var u=c('ReactDOM').findDOMNode(this.refs[this.state.selectedIndex]);if(u)u.focus();};t.prototype.shouldComponentUpdate=function(u,v){'use strict';return c('shallowCompare')(this,u,v);};t.prototype.onDragStart=function(event){'use strict';event.preventDefault();};t.prototype.onKeyboardFocus=function(u,event){'use strict';this.setState({hasKeyboardFocus:true,selectedIndex:u});this.props.onFocus&&this.props.onFocus(event);};t.prototype.onKeyDown=function(event){'use strict';switch(event.keyCode){case c('RTLKeys').RETURN:event.preventDefault();var u=this.state.supportedReactions[this.state.selectedIndex];if(this.props.initialReaction===u)u=c('UFIReactionTypes').NONE;if(u!==null&&u!==undefined&&this.props.onReactionClick)this.props.onReactionClick(u,event);break;case c('RTLKeys').getLeft():case c('RTLKeys').getRight():event.preventDefault();this.setState({selectedIndex:Math.max(0,Math.min(this.state.selectedIndex+(event.keyCode===c('RTLKeys').getLeft()?-1:1),this.state.supportedReactions.length-1))},this.focusSelected);break;}};t.prototype.onReactionClick=function(u,event){'use strict';event.preventDefault();this.props.onReactionClick&&this.props.onReactionClick(u,event);};t.prototype.onReactionMouseEnter=function(u,event){'use strict';this.setState({selectedIndex:this.props.supportedReactions.indexOf(u)});this.props.onReactionMouseEnter&&this.props.onReactionMouseEnter(u);};t.prototype.onReactionMouseLeave=function(u,event){'use strict';this.setState({selectedIndex:-1});this.props.onReactionMouseLeave&&this.props.onReactionMouseLeave(u);};t.prototype.onThemeStoreShow=function(){'use strict';this.setState({persistLayer:true});};t.prototype.onThemeStoreHide=function(){'use strict';this.setState({persistLayer:false});};t.prototype.renderThemesButton=function(){'use strict';if(!c('UFIConfig').reactionsHasThemes)return null;return (c('React').createElement(c('UFIReactionsThemeStoreButton.react'),{onShow:this.onThemeStoreShow,onHide:this.onThemeStoreHide}));};t.prototype.render=function(){'use strict';var u=this.state.supportedReactions.length,v=c('UFIConfig').reactionsHasMegaDock&&!this.props.noMegaDock&&u>2,w=(u*n-m)/(u-1),x=this.state.selectedIndex,y=this.state.supportedReactions.map(function(z,aa){var ba=p[z].display_name,ca=this.onReactionClick.bind(this,z),da=Math.max(0,this.state.supportedReactions.indexOf(this.props.initialReaction))===aa,ea=null;if(v&&x!==-1){var fa,ga=(x===aa?m:w)/m,ha=0;if(aa<x){ha=-(n-n*ga+(n-m*ga)*aa);}else if(aa>x){ha=(n-w)*(u/2-aa);}else ha=-(n*aa-w*aa);if(c('Locale').isRTL())ha=-ha;ea=(fa={},fa[q]='translateX('+Math.floor(ha)+'px) scale('+ga+')',fa);}var ia,ja=this.props.icon;if(ja&&x===aa&&this.hasAnimatedIconsOnHover){ia=c('React').createElement(ja,{animate:this.props.shown,selectedIndex:this.state.selectedIndex,maxSize:v?m:n,reaction:p[z].name,vectors:this.props.vectors});}else ia=c('React').createElement(c('UFIReactionIconImpl.react'),{className:c('joinClasses')(this.state.theme,"_2jry"+(this.props.suggestedReaction&&c('UFIConfig').reactionsHasDockSuggestions&&z===this.props.suggestedReaction&&z!==c('UFIReactionTypes').LIKE?' '+"_4g49":'')),reaction:z,size:v?'96':'48',hasStaticSVGDock:this.hasStaticSVGDock});return (c('React').createElement(s,{'aria-pressed':this.props.initialReaction===z,'aria-label':ba,className:"_iuw"+(x===aa?' '+"_iuy":''),href:'#',key:'reaction_'+z,onClick:ca,onDragStart:this.onDragStart,onKeyboardFocus:this.onKeyboardFocus.bind(this,aa),onMouseUp:this.props.onReactionMouseUp,onMouseDown:this.props.onReactionMouseDown,onMouseEnter:this.onReactionMouseEnter.bind(this,z),onMouseLeave:this.onReactionMouseLeave.bind(this,z),onTouchStart:this.onDragStart,onTouchEnd:ca,ref:aa,role:'button',tabIndex:da&&(!this.props.shown||x===aa)?0:-1},c('React').createElement('div',{className:"_39m",'data-reaction':z},c('React').createElement('div',{className:"_39n",style:ea},ia,c('React').createElement('div',{className:"_d6l"},c('React').createElement('div',{className:"_4sm1"},ba))))));}.bind(this));return (c('React').createElement(c('UFIReactionsDialogLayerImpl.react'),{hasSquareCorner:c('UFIConfig').reactionsHasThemes,height:(v?x!==-1?w:n:o)+l,isDarkBackground:this.props.isDarkBackground,isScreenReader:this.props.isScreenReader,onLayerBlur:!this.state.persistLayer&&this.props.onBlur,onMouseEnter:this.props.onMouseEnter,onMouseLeave:!this.state.persistLayer&&this.props.onMouseLeave,shown:this.props.shown},c('React').createElement('div',{className:"_iu-"+(this.state.hasKeyboardFocus?' '+"_5wkt":'')+(v?' '+"_17hc":''),onKeyDown:this.onKeyDown,'aria-label':r,ref:'root',role:'toolbar'},y),this.renderThemesButton()));};f.exports=t;},null);