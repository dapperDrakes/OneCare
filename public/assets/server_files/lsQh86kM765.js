if (self.CavalryLogger) { CavalryLogger.start_js(["Xdw2r"]); }

__d('UFIOrderingModeStore',['invariant','FluxReduceStore','immutable','UFIActionTypes','UFISharedDispatcher'],function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('FluxReduceStore'));j=i&&i.prototype;k.prototype.getOrderingMode=function(l,m,n){return l.get(m)||this.$UFIOrderingModeStore1(n);};k.prototype.$UFIOrderingModeStore1=function(l){!l.length?h(0):void 0;return l.filter(function(m){return m.selected;}).map(function(m){return m.value;}).pop()||l[0].value;};k.prototype.getInitialState=function(){return new (c('immutable').Map)();};k.prototype.areEqual=function(l,m){return c('immutable').is(l,m);};k.prototype.reduce=function(l,m){switch(m.type){case c('UFIActionTypes').INSTANCE.CHANGE_ORDER_MODE:return l.set(m.instanceID,m.mode);}return l;};function k(){i.apply(this,arguments);}f.exports=new k(c('UFISharedDispatcher'));},null);
__d('UFIOrderingModeSelector.react',['cx','invariant','ix','Image.react','InlineBlock.react','Link.react','PopoverMenu.react','React','ReactXUIMenu'],function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n=c('ReactXUIMenu').SelectableMenu,o=c('ReactXUIMenu').SelectableItem;k=babelHelpers.inherits(p,c('React').Component);l=k&&k.prototype;function p(){var q,r;'use strict';for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return q=(r=l.constructor).call.apply(r,[this].concat(t)),this.onMenuItemClick=function(v,w){this.props.onOrderChanged(w.item.getValue());}.bind(this),q;}p.prototype.render=function(){'use strict';if(this.props.orderingModes.length===0)return null;var q=this.props.orderingModes.filter(function(s){return s.value==this.props.selectedMode;}.bind(this)).map(function(s){return s.name;}).pop();!q?i(0):void 0;var r=c('React').createElement(n,{className:"_4tju",onItemClick:this.onMenuItemClick},this.props.orderingModes.map(function(s){return (c('React').createElement(o,{key:s.value,value:s.value,label:s.name,selected:s.value===this.props.selectedMode},c('React').createElement('div',{className:"_3scm"},c('React').createElement('div',{className:"_3scn"},s.name),c('React').createElement('div',{className:"_3sco"},s.description))));}.bind(this)));return (c('React').createElement('div',{className:"_3scp"},c('React').createElement(c('InlineBlock.react'),null,c('React').createElement(c('PopoverMenu.react'),{className:"_3scs",menu:r,alignh:'right'},c('React').createElement(c('Link.react'),null,q,c('React').createElement(c('Image.react'),{className:"_3sct",src:j('/images/ui/xhp/link/more/down_caret.gif')}))))));};p.propTypes={onOrderChanged:m.func.isRequired,orderingModes:m.arrayOf(m.shape({name:m.string.isRequired,description:m.string,value:m.string.isRequired})).isRequired,selectedMode:m.string.isRequired};f.exports=p;},null);
__d('UFIOrderingModeSelectorContainer.react',['BanzaiLogger','Random','React','SubscriptionsHandler','UFIConfig','UFIInstanceAction','UFIOrderingModeSelector.react','UFIOrderingModeStore','UFISharedDispatcher'],function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;'use strict';for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=i.constructor).call.apply(m,[this].concat(o)),this.state={selectedMode:c('UFIOrderingModeStore').getOrderingMode(c('UFIOrderingModeStore').getState(),this.props.ufiInstanceID,this.props.feedback.orderingmodes)},this.$UFIOrderingModeSelectorContainer1=null,this.onOrderChanged=function(q){var r=this.props.feedback;if(r.orderingmodes&&c('UFIConfig').logChangeOrderingModeUsageSampleRate>c('Random').random())c('BanzaiLogger').log('CommentsOrderingModeSelectorUsageLoggerConfig',{start_order:this.props.selectedMode,end_order:q,post_fbid:r.commentstargetfbid,post_owner_fbid:r.ownerid,available_orders:r.orderingmodes.map(function(s){return s.value;})});c('UFISharedDispatcher').dispatch(c('UFIInstanceAction').changeOrderingMode(this.props.ufiInstanceID,q));}.bind(this),l;}k.prototype.componentDidMount=function(){'use strict';this.$UFIOrderingModeSelectorContainer1=new (c('SubscriptionsHandler'))();this.$UFIOrderingModeSelectorContainer1.addSubscriptions(c('UFIOrderingModeStore').addListener(function(){if(!this.$UFIOrderingModeSelectorContainer1)return;this.setState({selectedMode:c('UFIOrderingModeStore').getOrderingMode(c('UFIOrderingModeStore').getState(),this.props.ufiInstanceID,this.props.feedback.orderingmodes)});}.bind(this)));};k.prototype.componentWillUnmount=function(){'use strict';if(this.$UFIOrderingModeSelectorContainer1){this.$UFIOrderingModeSelectorContainer1.release();this.$UFIOrderingModeSelectorContainer1=null;}};k.prototype.shouldComponentUpdate=function(l,m){'use strict';return this.state.selectedMode!==m.selectedMode;};k.prototype.render=function(){'use strict';return (c('React').createElement(c('UFIOrderingModeSelector.react'),{onOrderChanged:this.onOrderChanged,orderingModes:this.props.feedback.orderingmodes,selectedMode:this.state.selectedMode}));};k.propTypes={feedback:j.shape({orderingmodes:j.arrayOf(j.shape({name:j.string.isRequired,description:j.string.isRequired,selected:j.bool.isRequired,value:j.string.isRequired})).isRequired,commentstargetfbid:j.string.isRequired,ownerid:j.string.isRequired}).isRequired,ufiInstanceID:j.string.isRequired};f.exports=k;},null);
__d("XPubcontentInlinePhotoPivotsEventsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pubcontent\/inline_photo_pivots_chaining\/events\/",{});},null);
__d('EntstreamAttachmentRelatedShare',['csx','cx','Arbiter','AsyncRequest','AttachmentRelatedShareConstants','CSS','DOM','Event','XPubcontentInlinePhotoPivotsEventsController','ge','getOrCreateDOMID','tidyEvent'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=2,k=3,l={loadRelatedAttachment:function(m,n,o){var p=null;if(typeof m==="string"){p=c('ge')(m);}else p=m;if(!p)return;var q=c('Event').listen(p,'click',function(){q.remove();c('Arbiter').inform(c('AttachmentRelatedShareConstants').ARTICLE_CLICK,{attachment:p,global_share_id:n,is_right_click:false,share_id:o});}),r=c('Event').listen(p,'mousedown',function(event){if(event.which===k||event.button===j){r.remove();c('Arbiter').inform(c('AttachmentRelatedShareConstants').ARTICLE_CLICK,{attachment:p,global_share_id:n,is_right_click:true});}});},loadInlineStoryPivotAttachment:function(m,n){var o=c('ge')(m);if(!o)return;var p=c('Event').listen(o,'click',function(){p.remove();c('Arbiter').inform(c('AttachmentRelatedShareConstants').PHOTO_CLICK,{attachment:o,storyid:n});});},loadRelatedGameAttachment:function(m,n){var o=null;if(typeof m==="string"){o=c('ge')(m);}else o=m;if(!o)return;c('tidyEvent')(c('Event').listen(o,'click',function(){c('Arbiter').inform(c('AttachmentRelatedShareConstants').GAME_CLICK,{attachment:o,global_share_id:n});}));c('tidyEvent')(c('Event').listen(o,'mousedown',function(event){if(event.which===k||event.button===j)c('Arbiter').inform(c('AttachmentRelatedShareConstants').GAME_CLICK,{attachment:o,global_share_id:n});}));},loadRelatedLSCVideoAttachment:function(m,n){var o=null;if(typeof m==='string'){o=c('ge')(m);}else o=m;if(!o)return;var p="^div._4-u2",q=c('DOM').scry(o,p),r=c('Event').listen(o,'click',function(){r.remove();c('Arbiter').inform(c('AttachmentRelatedShareConstants').VIDEO_CLICK,{attachment:o,global_share_id:n});});},loadRelatedLSCInlineVideoAttachment:function(m,n){var o=null;if(typeof m==='string'){o=c('ge')(m);}else o=m;if(!o)return;c('Event').listen(o,'click',function(){var p="^div._4-u2",q="_1d8v",r=c('DOM').scry(o,p),s=r.length===1?r[0]:null,t=s.parentNode,u=t.previousSibling;while(!u){t=t.parentNode;u=t.previousSibling;}if(!c('CSS').hasClass(u,q)){var v=c('DOM').create('div',{className:q}),w=c('DOM').insertBefore(s.parentNode,v),x=w.length>=1?w[0]:null;}else x=u;var y=c('getOrCreateDOMID')(x);new (c('AsyncRequest'))().setURI('/ajax/flash/expand_inline.php').setData({share_id:n,target_div:y,max_width:470,max_height:264,replace_target_div:true}).setMethod('GET').setReadOnly(true).setRelativeTo(o.parentNode).send();});},loadRelatedEventsPivotAttachment:function(m,n){var o=null;if(typeof m==="string"){o=c('ge')(m);}else o=m;if(!o)return;c('tidyEvent')(c('Event').listen(o,'click',function(){c('Arbiter').inform(c('AttachmentRelatedShareConstants').EVENT_JOIN,{attachment:o,event_id:n});}));},loadRelatedProductAttachment:function(m,n){var o=null;if(typeof m==='string'){o=c('ge')(m);}else o=m;if(!o)return;c('tidyEvent')(c('Event').listen(o,'click',function(){c('Arbiter').inform(c('AttachmentRelatedShareConstants').PRODUCT_CLICK,{attachment:o,product_id:n});}));},closeButton:function(m,n){c('Event').listen(m,'click',function(){c('DOM').remove(n);});},closeButtonPhotoPivots:function(m,n,o,p){c('Event').listen(m,'click',function(){var q=c('XPubcontentInlinePhotoPivotsEventsController').getURIBuilder(),r={story_id:o,search_query_type:p,event:'hide'};new (c('AsyncRequest'))().setMethod('POST').setURI(q.getURI()).setData(r).send();c('DOM').remove(n);});},seeAllLinkPhotoPivots:function(m,n,o){c('Event').listen(m,'click',function(){var p=c('XPubcontentInlinePhotoPivotsEventsController').getURIBuilder(),q={story_id:n,search_query_type:o,event:'see_all'};new (c('AsyncRequest'))().setMethod('POST').setURI(p.getURI()).setData(q).send();});},removeOldSuggestions:function(m){var n=c('ge')(m);if(!n)return;var o=c('DOM').scry(n.parentNode,"._5d73");for(var p=1;p<o.length;p++)c('DOM').remove(o[p]);setTimeout(function(){c('CSS').show(o[0]);},1000);},showHiddenSuggestions:function(m){var n=c('Event').listen(m,'click',function(){n.remove();var o="^._1ui8",p=c('DOM').scry(m,o);if(!p)return;c('CSS').hide(p[0]);var q=p[0].previousSibling;while(q){c('CSS').show(q);q=q.previousSibling;}});}};f.exports=l;},null);